{"version":"NotebookV1","origId":2709619314154986,"name":"STD Master Notebook OTL","language":"python","commands":[{"version":"CommandV1","origId":2709619314154987,"guid":"13a9e3ae-4d9c-4afe-a7ba-bfa2a442552a","subtype":"command","commandType":"auto","position":2.0,"command":"# SET LOAD TYPE (FULL LOAD = Yes/No)\ndbutils.widgets.text(\"FULL_LOAD\", \"No\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")\n\n# SET ENVIRONMENT FOR DATA LAKE (02 OR 10 OR etc)\ndbutils.widgets.text(\"env\", \"10\", \"ADLS ENVIRONMENT\")\nenv = dbutils.widgets.get(\"env\")\n\n#SET TABLE LIST (nonpii OR pii) \ndbutils.widgets.text(\"pii_or_nonpii\", \"nonpii\", \"TABLE PREFERENCE( NONPII/PII)\")\npii_or_nonpii = dbutils.widgets.get(\"pii_or_nonpii\")\n\n# SET MANUAL LIST OF TABLES (for example = table1 table2 table3 etc)\ndbutils.widgets.text(\"manual_list_str\", \"\", \"MANUAL TABLE LIST\")\nmanual_list_str = dbutils.widgets.get(\"manual_list_str\")\nmanual_list  =  (list(manual_list_str.split()))\n\n# SET DATABASE NAME\ndbutils.widgets.text(\"db_name\", \"cods_nonprod_historical\", \"DATABASE NAME\")\ndb_name = dbutils.widgets.get(\"db_name\")\n\n#SET BASEPATH\nbasepath = 'abfss://dev@dtecuprodedaadl' + env + '.dfs.core.windows.net/'\n\n#SET SEGREGATED LOCATION PATH \ndbutils.widgets.text(\"segregated_loc\", \"raw/ISU_archive/segregated\", \"SEGREGATED LOC\")\nsegregated_loc = basepath + dbutils.widgets.get(\"segregated_loc\")\n\n#SET STAGING LOCATION PATH\nstaging_location = segregated_loc\n\n#SET CURATED LOCATION PATH \ndbutils.widgets.text(\"curated_location\", \"curated/ISU_archive/archive/FINAL\", \"CURATED LOC\")\ncurated_location = basepath + dbutils.widgets.get(\"curated_location\")\n\n#SET CURATED ERROR LOCATION PATH \ndbutils.widgets.text(\"curated_location_err\", \"curated/ISU_archive/archive/ERROR\", \"CURATED LOC ERROR\")\ncurated_location_err = basepath + dbutils.widgets.get(\"curated_location_err\")\n\n#SET SILVER LOCATION ( final table destination here )\ndbutils.widgets.text(\"silver_location\", \"curated/ISU_archive/silver_testcopy\", \"SILVER LOCATION\")\nsilver_location = basepath + dbutils.widgets.get(\"silver_location\")\n\n#SET EXECUTION LOGS LOCATION PATH \ndbutils.widgets.text(\"execution_logs_loc\", \"ISU_archive_support/execution_logs/batch_logs\", \"EXECUTION LOGS LOC\")\nexecution_logs_loc = basepath + dbutils.widgets.get(\"execution_logs_loc\")\n\n# SET METADATA FILEPATH FROM ADLS (For example  = ISU_archive_support/metadata/Final_metadata.csv)\ndbutils.widgets.text(\"metaadlspath\", \"ISU_archive_support/metadata/Final_metadata.csv\", \"METADATA FILE LOC\")\nmetaadlspath = dbutils.widgets.get(\"metaadlspath\")\n\n# SET METADATA FILE FULL PATH TO ADLS\nmetafilepath = basepath + metaadlspath\n\n#SET TABLE CREATION NOTEBOOK PATH\ndbutils.widgets.text(\"tablecreationnbpath\", \"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable\", \"TABLE CREATION NOTEBOOK PATH\")\ntablecreationnbpath = dbutils.widgets.get(\"tablecreationnbpath\")\n\n#SET DATA PEP NOTEBOOK PATH\ndbutils.widgets.text(\"dataprepnbpath\", \"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion\", \"DATA PREP NOTEBOOK PATH\")\ndataprepnbpath = dbutils.widgets.get(\"dataprepnbpath\")","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{"curated_location":"curated/ISU_archive/archive/FINAL","dataprepnbpath":"/Shared/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","execution_logs_loc":"ISU_archive_support/execution_logs/batch_logs","tablecreationnbpath":"/Shared/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","db_name":"cods_nonprod_historical","pii_or_nonpii":"pii","manual_list_str":"FKKMAKT","curated_location_err":"curated/ISU_archive/archive/ERROR","silver_location":"curated/ISU_archive/silver_testcopy","metaadlspath":"ISU_archive_support/metadata/Final_metadata.csv","FULL_LOAD":"No","segregated_loc":"raw/ISU_archive/segregated","env":"10"},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"curated/ISU_archive/archive/FINAL","label":"CURATED LOC","options":{"widgetType":"text","validationRegex":null}},"dataprepnbpath":{"widgetType":"text","name":"dataprepnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","label":"DATA PREP NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}},"execution_logs_loc":{"widgetType":"text","name":"execution_logs_loc","defaultValue":"ISU_archive_support/execution_logs/batch_logs","label":"EXECUTION LOGS LOC","options":{"widgetType":"text","validationRegex":null}},"tablecreationnbpath":{"widgetType":"text","name":"tablecreationnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","label":"TABLE CREATION NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}},"db_name":{"widgetType":"text","name":"db_name","defaultValue":"cods_nonprod_historical","label":"DATABASE NAME","options":{"widgetType":"text","validationRegex":null}},"pii_or_nonpii":{"widgetType":"text","name":"pii_or_nonpii","defaultValue":"nonpii","label":"TABLE PREFERENCE( NONPII/PII)","options":{"widgetType":"text","validationRegex":null}},"manual_list_str":{"widgetType":"text","name":"manual_list_str","defaultValue":"","label":"MANUAL TABLE LIST","options":{"widgetType":"text","validationRegex":null}},"curated_location_err":{"widgetType":"text","name":"curated_location_err","defaultValue":"curated/ISU_archive/archive/ERROR","label":"CURATED LOC ERROR","options":{"widgetType":"text","validationRegex":null}},"silver_location":{"widgetType":"text","name":"silver_location","defaultValue":"curated/ISU_archive/silver_testcopy","label":"SILVER LOCATION","options":{"widgetType":"text","validationRegex":null}},"metaadlspath":{"widgetType":"text","name":"metaadlspath","defaultValue":"ISU_archive_support/metadata/Final_metadata.csv","label":"METADATA FILE LOC","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}},"segregated_loc":{"widgetType":"text","name":"segregated_loc","defaultValue":"raw/ISU_archive/segregated","label":"SEGREGATED LOC","options":{"widgetType":"text","validationRegex":null}},"env":{"widgetType":"text","name":"env","defaultValue":"10","label":"ADLS ENVIRONMENT","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663758815632,"submitTime":1663758815394,"finishTime":1663758815666,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ee0a2b4f-8c2c-4180-9ac0-e204d4ea5a5f"},{"version":"CommandV1","origId":2709619314154988,"guid":"9d5cfc00-633a-4ada-bad1-436f399c5a44","subtype":"command","commandType":"auto","position":3.0,"command":"print(\"basepath : \" + basepath)\nprint(\"FULL_LOAD : \" + FULL_LOAD)\nprint(\"pii_or_nonpii : \" + pii_or_nonpii)\nprint(\"manual_list : \" + manual_list_str)\nprint(\"db_name : \" + db_name)\nprint(\"segregated_loc : \" + segregated_loc)\nprint(\"staging_location : \" + staging_location)\nprint(\"curated_location : \" + curated_location)\nprint(\"curated_location_err : \" + curated_location_err)\nprint(\"silver_location : \" + silver_location)\nprint(\"execution_logs_loc : \" + execution_logs_loc)\nprint(\"metafilepath : \" + metafilepath)\nprint(\"tablecreationnbpath : \" + tablecreationnbpath)\nprint(\"dataprepnbpath : \" + dataprepnbpath)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">basepath : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/\nFULL_LOAD : No\npii_or_nonpii : pii\nmanual_list : FKKMAKT\ndb_name : cods_nonprod_historical\nsegregated_loc : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/raw/ISU_archive/segregated\nstaging_location : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/raw/ISU_archive/segregated\ncurated_location : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/curated/ISU_archive/archive/FINAL\ncurated_location_err : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/curated/ISU_archive/archive/ERROR\nsilver_location : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/curated/ISU_archive/silver_testcopy\nexecution_logs_loc : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/ISU_archive_support/execution_logs/batch_logs\nmetafilepath : abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv\ntablecreationnbpath : /Shared/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable\ndataprepnbpath : /Shared/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663758815669,"submitTime":1663758815425,"finishTime":1663758815689,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",1096]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a27fc16a-b599-498e-b0e7-06915c05542a"},{"version":"CommandV1","origId":2709619314154989,"guid":"bc7e4641-5b7e-46da-b8b1-ba45b706a2fd","subtype":"command","commandType":"auto","position":4.0,"command":"#START LOGGING\n\nimport logging\nimport datetime\n\nexecution_logs_loc2 = execution_logs_loc + \"/\"\n\n#ADD FOLDER IF NOT EXIST\ndbutils.fs.mkdirs(execution_logs_loc)\n\ncurrentutctime = datetime.datetime.now().strftime('%Y%m%d_%H%M%S')\nfilenamewithtime = \"EDA_\" + currentutctime +\".log\"\npartitions = datetime.datetime.now().strftime('%Y-%m-%d/')\n\ndbfslogbasepath = \"/tmp\" + \"/\" + filenamewithtime\n\n#TAG LOGGING INFO TO NOTEBOOK\nlogger = logging.getLogger('MasterNotebookOTL')\n\n#SETTING THRESHOLD OF LOGGER TO INFO\nlogger.setLevel(logging.INFO)\n\nFilehandler = logging.FileHandler(dbfslogbasepath,mode = 'a')\n\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\n\nlogger.addHandler(Filehandler)\n\n#LOG INFO\nlogger.info(\"Master NoteBook for History run started \")\nlogger.info(\"Input Parameters >>\")\nlogger.info(\"basepath : \" + basepath + \",\" + \"FULL_LOAD : \" + FULL_LOAD + \",\" + \"pii_or_nonpii : \" + pii_or_nonpii + \",\" + \"manual_list : \" + manual_list_str + \",\" + \"db_name : \" + db_name + \",\" + \"segregated_loc : \" + segregated_loc + \",\" + \"staging_location : \" + staging_location + \",\" + \"curated_location : \" + curated_location + \",\" + \"curated_location_err : \" + curated_location_err + \",\" + \"metafilepath : \" + metafilepath + \",\" + \"tablecreationnbpath : \" + tablecreationnbpath + \",\" + \"dataprepnbpath : \" + dataprepnbpath)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663758815692,"submitTime":1663758815453,"finishTime":1663758815827,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"87a4c707-bd4b-4217-827b-533b624b3d1b"},{"version":"CommandV1","origId":2709619314154990,"guid":"a8ca7ea2-0679-4fe1-9a84-1975ed0be02e","subtype":"command","commandType":"auto","position":5.0,"command":"print(segregated_loc)\nfileloc = dbutils.fs.ls(segregated_loc)\n\n# LIST OF TABLES FROM DIRECTORY \ntablelist1 = list(map(lambda p: p.name[:-1].upper(), fileloc))\n\n# LIST OF ALL NONPII TABLES\nnonpiitablelist = ['CDHDR','CDPOS','DBERCHV','DBERCHZ1','DBERCHZ2','DBERCHZ3','DBERDL','DBERDLB','DFKKKO','DFKKOPK','DFKKOPKC','DFKKOPKX','DFKKZK','DFKKZPE','DFKKZPT','DFKKZS','EABL','EABLG','EMDUSDRQHEAD','EMDUSDRQINPUT','EMDUSDRQITEM','EMDUSDRQRESULT','ERCHC','ERCHO','ERDB','ERDO','ETTIFB','ETTIFN']\n\n# LIST OF ALL PII TABLES\npiitablelist = ['BCONT','DFKKCOLL','DFKKCOLLH','DFKKLOCKS','DFKKLOCKSH','DFKKOP','DFKKOPCOLL','DFKKOPW','DFKKZP','DFKKZV','ERCH','ERDK','FKKMACTIVITIES','FKKMAKO','FKKMAKT','FKKMAZE']\nprint(pii_or_nonpii)\nif(pii_or_nonpii == 'nonpii'):\n    tablelist2 = nonpiitablelist\n    print(tablelist2)\nelif(pii_or_nonpii == 'pii'):\n    tablelist2 = piitablelist\n    print(tablelist2)\n\n# EFFECTIVE TABLE LIST\ntablelist = [value for value in tablelist1 if value in tablelist2]\n","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/raw/ISU_archive/segregated\npii\n[&#39;BCONT&#39;, &#39;DFKKCOLL&#39;, &#39;DFKKCOLLH&#39;, &#39;DFKKLOCKS&#39;, &#39;DFKKLOCKSH&#39;, &#39;DFKKOP&#39;, &#39;DFKKOPCOLL&#39;, &#39;DFKKOPW&#39;, &#39;DFKKZP&#39;, &#39;DFKKZV&#39;, &#39;ERCH&#39;, &#39;ERDK&#39;, &#39;FKKMACTIVITIES&#39;, &#39;FKKMAKO&#39;, &#39;FKKMAKT&#39;, &#39;FKKMAZE&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663758815829,"submitTime":1663758815481,"finishTime":1663758815878,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",421]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f1156013-453e-4241-9219-1a398233acf1"},{"version":"CommandV1","origId":2709619314154991,"guid":"97b8a04f-40db-4f78-bf65-4a6cf722c56e","subtype":"command","commandType":"auto","position":6.0,"command":"# IF TABLE LIST IS ENTERED MANUALLY FROM WIDGET THEN USE MANUAL TABLE LIST ELSE USE AVAILABLE TABLES LIST \n\nif(manual_list):\n    tablelist = manual_list\n    print(tablelist) \n    #LOG INFO\n    logger.info(\"Tablelist for current execution : \" + str(tablelist))    \nelse:\n    tablelist\n    print(tablelist)\n    #LOG INFO\n    logger.info(\"Tablelist for current execution : \" + str(tablelist))    \n","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">[&#39;FKKMAKT&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663758815881,"submitTime":1663758815510,"finishTime":1663758815897,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",47]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1d7b65b8-6329-4a94-aea2-e5d3e87552c5"},{"version":"CommandV1","origId":2709619314154992,"guid":"67868b96-bc4a-4a8e-ae9d-d1757ecaae18","subtype":"command","commandType":"auto","position":7.0,"command":"# FOR ALL THE TABLES IN A LIST EXECUTE DATA PREPERATION FOLLOWED BY TABLE CREATION IN A LOOP\nlogger.info(\"----------------------------------------------------------------\")\n\ntry:  \n  for tablename in tablelist:\n    logger.info(\"Data Preperation Started for table : \" + tablename)\n    try:\n      dbutils.notebook.run(dataprepnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD , \"table_name\" : tablename , \"staging_location\" : staging_location , \"curated_location\" : curated_location , \"curated_location_err\" : curated_location_err , \"metafilepath\" : metafilepath , \"dbfslogbasepath\" : dbfslogbasepath , \"silver_location\" : silver_location })\n      logger.info(\"Data Preperation Completed for table : \" + tablename)\n    except Exception as e:\n      logger.error(\"Error occurred while Executing Data Preparation : \" + str(e))\n      logger.critical(\"Master NoteBook for History run Failed!\")\n      #dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n    \n    logger.info(\"Table Creation Started for table : \" + tablename)  \n    try:\n      dbutils.notebook.run(tablecreationnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD , \"table_name\" : tablename , \"db_name\" : db_name , \"curated_location\" : curated_location , \"curated_location_err\" : curated_location_err , \"metafilepath\" : metafilepath , \"dbfslogbasepath\" : dbfslogbasepath })\n      logger.info(\"Table Creation Completed for table : \" + tablename)\n      logger.info(\"----------------------------------------------------------------\")\n    except Exception as e:\n      logger.error(\"Error occurred while Executing Table Creation : \" + str(e))\n      logger.critical(\"Master NoteBook for History run Failed!\")\n      #dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n    print(\"DONE WITH TABLE : \" + tablename)\nexcept:\n  dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">DONE WITH TABLE : FKKMAKT\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[{"jobId":1023408375111337},{"jobId":75119841365506}],"startTime":1663758815900,"submitTime":1663758815538,"finishTime":1663758857327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",53]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c8a74bd7-5245-4c44-bb7b-d8e936af82ba"},{"version":"CommandV1","origId":2709619314154993,"guid":"fac675fc-b31e-43c1-bc9f-3cc77088d2ce","subtype":"command","commandType":"auto","position":8.0,"command":"#LOG INFO\nlogger.info(\"Master NoteBook for History run Completed Successfully!\")\n\n#MOVE LOG FILE TO ADLS LOCATION\ndbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[202]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663758857330,"submitTime":1663758815569,"finishTime":1663758857478,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",41]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c6b365ce-ddf9-4233-897f-51ad504fc00d"}],"dashboards":[],"guid":"59a030ee-ca47-45f5-9c71-b310c5622aaa","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location":{"nuid":"7cf78637-dac8-4aa8-a030-7857d8fffd37","currentValue":"curated/ISU_archive/archive/FINAL","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"curated/ISU_archive/archive/FINAL","label":"CURATED LOC","options":{"widgetType":"text","validationRegex":null}}},"dataprepnbpath":{"nuid":"f0096efe-5cec-4cd8-a51d-24340d96951c","currentValue":"/Shared/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","widgetInfo":{"widgetType":"text","name":"dataprepnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","label":"DATA PREP NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}}},"execution_logs_loc":{"nuid":"45334b48-ecce-4ae2-a3fe-d7fc6b5feb68","currentValue":"ISU_archive_support/execution_logs/batch_logs","widgetInfo":{"widgetType":"text","name":"execution_logs_loc","defaultValue":"ISU_archive_support/execution_logs/batch_logs","label":"EXECUTION LOGS LOC","options":{"widgetType":"text","validationRegex":null}}},"tablecreationnbpath":{"nuid":"0d88e339-b467-454e-96b7-02414d32dc72","currentValue":"/Shared/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","widgetInfo":{"widgetType":"text","name":"tablecreationnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","label":"TABLE CREATION NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}}},"db_name":{"nuid":"c1d0128d-d0c3-4017-9f57-67f321650a48","currentValue":"cods_nonprod_historical","widgetInfo":{"widgetType":"text","name":"db_name","defaultValue":"cods_nonprod_historical","label":"DATABASE NAME","options":{"widgetType":"text","validationRegex":null}}},"pii_or_nonpii":{"nuid":"f663e12e-0ac5-4242-bca7-ccdd7d990d78","currentValue":"pii","widgetInfo":{"widgetType":"text","name":"pii_or_nonpii","defaultValue":"nonpii","label":"TABLE PREFERENCE( NONPII/PII)","options":{"widgetType":"text","validationRegex":null}}},"manual_list_str":{"nuid":"6b6dce91-62d3-4cd6-a6a3-590673aecbf6","currentValue":"FKKMAKT","widgetInfo":{"widgetType":"text","name":"manual_list_str","defaultValue":"","label":"MANUAL TABLE LIST","options":{"widgetType":"text","validationRegex":null}}},"curated_location_err":{"nuid":"c87bbd84-e958-47b2-91a3-478bc33f8942","currentValue":"curated/ISU_archive/archive/ERROR","widgetInfo":{"widgetType":"text","name":"curated_location_err","defaultValue":"curated/ISU_archive/archive/ERROR","label":"CURATED LOC ERROR","options":{"widgetType":"text","validationRegex":null}}},"silver_location":{"nuid":"38614f8d-9c54-4e55-8cff-bed28596c591","currentValue":"curated/ISU_archive/silver_testcopy","widgetInfo":{"widgetType":"text","name":"silver_location","defaultValue":"curated/ISU_archive/silver_testcopy","label":"SILVER LOCATION","options":{"widgetType":"text","validationRegex":null}}},"metaadlspath":{"nuid":"8ec99e2f-481d-44d1-93d5-cc32bf51614a","currentValue":"ISU_archive_support/metadata/Final_metadata.csv","widgetInfo":{"widgetType":"text","name":"metaadlspath","defaultValue":"ISU_archive_support/metadata/Final_metadata.csv","label":"METADATA FILE LOC","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"f8efe557-b23c-4e14-a838-0cce7ab17aff","currentValue":"No","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"segregated_loc":{"nuid":"84d38ec2-b3d6-49ce-bc3d-a797da1df042","currentValue":"raw/ISU_archive/segregated","widgetInfo":{"widgetType":"text","name":"segregated_loc","defaultValue":"raw/ISU_archive/segregated","label":"SEGREGATED LOC","options":{"widgetType":"text","validationRegex":null}}},"env":{"nuid":"3c5e0738-8637-4132-9748-e5db2b382ae9","currentValue":"10","widgetInfo":{"widgetType":"text","name":"env","defaultValue":"10","label":"ADLS ENVIRONMENT","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}