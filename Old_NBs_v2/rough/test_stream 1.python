{"version":"NotebookV1","origId":2709619314154916,"name":"test_stream 1","language":"python","commands":[{"version":"CommandV1","origId":2709619314154917,"guid":"26b094bd-3006-455f-ad01-1b4ad024c8bd","subtype":"command","commandType":"auto","position":1.0,"command":"spark.conf.set(\"fs.azure.account.auth.type.dtecuprodedaadl05.dfs.core.windows.net\", \"OAuth\")\nspark.conf.set(\"fs.azure.account.oauth.provider.type.dtecuprodedaadl05.dfs.core.windows.net\", \"org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider\")\nspark.conf.set(\"fs.azure.account.oauth2.client.id.dtecuprodedaadl05.dfs.core.windows.net\", \"ea7dd103-75c8-40b7-af7d-0eb52c60889b\")\nspark.conf.set(\"fs.azure.account.oauth2.client.secret.dtecuprodedaadl05.dfs.core.windows.net\", \"A4rVH~xHrbDv69NgKC7hPvtc.8_x_iMq9p\")\nspark.conf.set(\"fs.azure.account.oauth2.client.endpoint.dtecuprodedaadl05.dfs.core.windows.net\", \"https://login.microsoftonline.com/8e61d5fe-7749-4e76-88ee-6d8799ae8143/oauth2/token\")","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"51e9eddb-cd1f-4aea-8d50-2717eb30b89a"},{"version":"CommandV1","origId":2709619314154918,"guid":"bbdf5532-e84b-4b0e-8279-ccaaa7810a09","subtype":"command","commandType":"auto","position":2.0,"command":"dberchz1_df = spark.readStream.format(\"delta\").option(\"ignoreDeletes\", \"true\").load(\"abfss://anp@rlspocgen2.dfs.core.windows.net/stream_delta_tables/adl07/\")","commandVersion":32,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"22f770d3-7ae0-465d-88e0-918e0d532e9b"},{"version":"CommandV1","origId":2709619314154919,"guid":"f8040434-77bc-46e9-8bc9-9b4f2c9ccdd7","subtype":"command","commandType":"auto","position":3.0,"command":"from pyspark.sql.functions import *\ndberchz1_df = dberchz1_df.withColumn(\"insertedTS\",current_timestamp())","commandVersion":6,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a36a2bba-dbac-4a63-be22-fa2682a3deaf"},{"version":"CommandV1","origId":2709619314154920,"guid":"82cc1cbd-e0bf-412d-8d7e-71fe7c410a62","subtype":"command","commandType":"auto","position":4.0,"command":"saveloc = \"abfss://anp@rlspocgen2.dfs.core.windows.net/stream_delta_tables/adl02\"\nstreamQuery = dberchz1_df.writeStream.format(\"delta\").option(\"checkpointLocation\",f\"{saveloc}_checkpoint\").start(saveloc)","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b20c7dea-cfda-4efe-8316-4d35997cb269"},{"version":"CommandV1","origId":2709619314154921,"guid":"f07d0b94-ab9b-48f4-97a5-0da243755a4f","subtype":"command","commandType":"auto","position":5.0,"command":"loadloc = \"abfss://raw@dtecuprodedaadl05.dfs.core.windows.net/cods/\"\nsaveloc = \"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/Replicate/Stream_data/\"\ndbname = \"cods\"\n\ntbl_list = ['qi6_dberchz1','qi6_dberchz2','qi6_dberchz3']","commandVersion":55,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1654517319345,"submitTime":1654517319213,"finishTime":1654517319372,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dc62fb75-a03c-4fc5-9cb0-dac2aed8dfd6"},{"version":"CommandV1","origId":2709619314154922,"guid":"8bc0db91-412d-46d5-aa82-7d853d14b41e","subtype":"command","commandType":"auto","position":6.0,"command":"from pyspark.sql.functions import *\n\nfor i in tbl_list:\n    loadloc1 = loadloc + i\n    saveloc1 = saveloc + i\n    tbl1 = (dbname + '.' + i)\n    df = spark.readStream.format(\"delta\").option(\"ignoreDeletes\", \"true\").load(loadloc1)\n    df = df.withColumn(\"insertedTS\",current_timestamp())\n    streamQuery = df.writeStream.format(\"delta\").option(\"checkpointLocation\",f\"{saveloc1}_checkpoint\").start(saveloc1)\n    #print(loadloc + i)\n    #print(saveloc + i)\n    #print(dbname + '.' + i)\n    ","commandVersion":80,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"HIVE_TYPE_STRING":"varchar(3)"},"name":"MANDT","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(12)"},"name":"BELNR","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(6)"},"name":"BELZEILE","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(2)"},"name":"MWSKZ","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(2)"},"name":"ERMWSKZ","nullable":false,"type":"string"},{"metadata":{},"name":"NETTOBTR","nullable":false,"type":"decimal(13,2)"},{"metadata":{"HIVE_TYPE_STRING":"varchar(5)"},"name":"TWAERS","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"PREISTUF","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(1)"},"name":"PREISTYP","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"PREIS","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(4)"},"name":"PREISZUS","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"VONZONE","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"BISZONE","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(3)"},"name":"ZONENNR","nullable":false,"type":"string"},{"metadata":{},"name":"PREISBTR","nullable":false,"type":"decimal(17,8)"},{"metadata":{},"name":"MNGBASIS","nullable":false,"type":"decimal(9,2)"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"PREIGKL","nullable":false,"type":"string"},{"metadata":{},"name":"URPREIS","nullable":false,"type":"decimal(17,8)"},{"metadata":{},"name":"PREIADD","nullable":false,"type":"decimal(17,8)"},{"metadata":{},"name":"PREIFAKT","nullable":false,"type":"decimal(12,7)"},{"metadata":{"HIVE_TYPE_STRING":"varchar(1)"},"name":"OPMULT","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(8)"},"name":"TXDAT_KK","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"PRCTR","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"KOSTL","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(8)"},"name":"PS_PSP_PNR","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(12)"},"name":"AUFNR","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"PAOBJNR","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"PAOBJNR_S","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(4)"},"name":"GSBER","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(1)"},"name":"APERIODIC","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(4)"},"name":"GROSSGROUP","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(1)"},"name":"BRUTTOZEILE","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(4)"},"name":"BUPLA","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(4)"},"name":"LINE_CLASS","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(1)"},"name":"PREISART","nullable":false,"type":"string"},{"metadata":{},"name":"V_NETTOBTR_L","nullable":false,"type":"decimal(17,0)"},{"metadata":{},"name":"N_NETTOBTR_L","nullable":false,"type":"decimal(14,14)"},{"metadata":{"HIVE_TYPE_STRING":"varchar(10)"},"name":"SEGMENT","nullable":false,"type":"string"},{"metadata":{"HIVE_TYPE_STRING":"varchar(1)"},"name":"op_indicator","nullable":true,"type":"string"},{"metadata":{},"name":"op_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"insertedTS","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1654517320576,"submitTime":1654517320576,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{"5f8cff92-acb2-4827-bdec-a647fc0a2158":[{"name":"5f8cff92-acb2-4827-bdec-a647fc0a2158","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"5f8cff92-acb2-4827-bdec-a647fc0a2158","isActive":false,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null}],"9da7d710-6d9d-427c-9c03-c49ee5febcc8":[{"name":"9da7d710-6d9d-427c-9c03-c49ee5febcc8","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"9da7d710-6d9d-427c-9c03-c49ee5febcc8","isActive":false,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null}],"fd8bf3dd-ccf8-4065-9c53-f13d3a8019ce":[{"name":"fd8bf3dd-ccf8-4065-9c53-f13d3a8019ce","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"fd8bf3dd-ccf8-4065-9c53-f13d3a8019ce","isActive":false,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null}]},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"25b31b3b-7dc3-4390-b415-36f89778a4b1"},{"version":"CommandV1","origId":2709619314154923,"guid":"720953d7-4096-492b-b93d-5ad881112232","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"71735cd9-ac16-4cbb-82e9-7739157b7ea5"}],"dashboards":[],"guid":"e8efaddb-31b0-449a-a3c8-ff0df9ccc26e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}