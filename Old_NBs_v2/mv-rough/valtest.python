{"version":"NotebookV1","origId":1426576384874227,"name":"valtest","language":"python","commands":[{"version":"CommandV1","origId":1426576384874228,"guid":"4a7e595c-fcd4-44ed-b77e-4a2f7f7e3443","subtype":"command","commandType":"auto","position":1.0,"command":"segregatedloc = 'abfss://dev@dtecuprodedaadl10.dfs.core.windows.net/raw/ISU_archive/segregated/FKKMACTIVITIES'\nnewdf = spark.read.format(\"csv\").option(\"delimiter\", \"|\").option(\"header\",\"true\").option(\"inferSchema\",\"true\").load(segregatedloc)\ntable_name = 'FKKMACTIVITIES'","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"newdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"FKKMACTIVITIES-MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-LAUFD","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-LAUFI","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-GPART","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-VKONT","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-MAZAE","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-AKZAE","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-ACKEY","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-CENTER","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-UNIT","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-AGENT","nullable":true,"type":"string"},{"metadata":{},"name":"FKKMACTIVITIES-STATUS","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1664777222388,"submitTime":1664777222340,"finishTime":1664777230420,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ca5ae205-12fa-452e-a0bd-f577ff8079f3"},{"version":"CommandV1","origId":1426576384874229,"guid":"be4335f6-4f39-4321-9f30-8448ed6eaf3e","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.window import Window\nimport fnmatch\ndef revisit_header(df=newdf,table_n=table_name):\n    if fnmatch.fnmatch(df.columns[0],table_n + \"*\") == True:\n        for i in df.columns:\n            df = df.withColumnRenamed(i, i[len(table_n)+1:])\n        print(df.columns)\n        return df\n    else:\n        return df","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1664777244579,"submitTime":1664777244529,"finishTime":1664777244612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e89bb9b2-2d8d-496a-8556-c62c8b99382e"},{"version":"CommandV1","origId":1426576384874230,"guid":"b216cf5d-9eb9-4726-8f80-d8b004f80497","subtype":"command","commandType":"auto","position":3.0,"command":"newdf = revisit_header()\nnewdf.createOrReplaceTempView(\"tempviewfkkmactivities\")","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">[&#39;MANDT&#39;, &#39;LAUFD&#39;, &#39;LAUFI&#39;, &#39;GPART&#39;, &#39;VKONT&#39;, &#39;MAZAE&#39;, &#39;AKZAE&#39;, &#39;ACKEY&#39;, &#39;CENTER&#39;, &#39;UNIT&#39;, &#39;AGENT&#39;, &#39;STATUS&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"newdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"LAUFD","nullable":true,"type":"string"},{"metadata":{},"name":"LAUFI","nullable":true,"type":"string"},{"metadata":{},"name":"GPART","nullable":true,"type":"string"},{"metadata":{},"name":"VKONT","nullable":true,"type":"string"},{"metadata":{},"name":"MAZAE","nullable":true,"type":"string"},{"metadata":{},"name":"AKZAE","nullable":true,"type":"string"},{"metadata":{},"name":"ACKEY","nullable":true,"type":"string"},{"metadata":{},"name":"CENTER","nullable":true,"type":"string"},{"metadata":{},"name":"UNIT","nullable":true,"type":"string"},{"metadata":{},"name":"AGENT","nullable":true,"type":"string"},{"metadata":{},"name":"STATUS","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1664777276016,"submitTime":1664777275984,"finishTime":1664777276114,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",233]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"592e5f04-4e8d-435a-b1e1-1e607a981697"},{"version":"CommandV1","origId":1426576384874231,"guid":"3cd27f3d-4df1-44f8-a284-7302b23a9fc0","subtype":"command","commandType":"auto","position":4.0,"command":"%sql\nSELECT * FROM tempviewfkkmactivities\nWHERE LAUFD = 20180321 AND LAUFI = 'DUNP' AND GPART = 1100017547 AND VKONT = 910000271452 AND MAZAE = 1 AND AKZAE = 7","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["300300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null],["300","20180321","DUNP","1100017547","910000271452","000001","000007","R061","50000329","50000333","E62018",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"MANDT","type":"\"string\"","metadata":"{}"},{"name":"LAUFD","type":"\"string\"","metadata":"{}"},{"name":"LAUFI","type":"\"string\"","metadata":"{}"},{"name":"GPART","type":"\"string\"","metadata":"{}"},{"name":"VKONT","type":"\"string\"","metadata":"{}"},{"name":"MAZAE","type":"\"string\"","metadata":"{}"},{"name":"AKZAE","type":"\"string\"","metadata":"{}"},{"name":"ACKEY","type":"\"string\"","metadata":"{}"},{"name":"CENTER","type":"\"string\"","metadata":"{}"},{"name":"UNIT","type":"\"string\"","metadata":"{}"},{"name":"AGENT","type":"\"string\"","metadata":"{}"},{"name":"STATUS","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"LAUFD","nullable":true,"type":"string"},{"metadata":{},"name":"LAUFI","nullable":true,"type":"string"},{"metadata":{},"name":"GPART","nullable":true,"type":"string"},{"metadata":{},"name":"VKONT","nullable":true,"type":"string"},{"metadata":{},"name":"MAZAE","nullable":true,"type":"string"},{"metadata":{},"name":"AKZAE","nullable":true,"type":"string"},{"metadata":{},"name":"ACKEY","nullable":true,"type":"string"},{"metadata":{},"name":"CENTER","nullable":true,"type":"string"},{"metadata":{},"name":"UNIT","nullable":true,"type":"string"},{"metadata":{},"name":"AGENT","nullable":true,"type":"string"},{"metadata":{},"name":"STATUS","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1664777298588,"submitTime":1664777298559,"finishTime":1664777303223,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",9]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a99d99cc-6bd5-4398-a845-9c810464e75c"}],"dashboards":[],"guid":"1cbf3828-ed61-4a1e-bbc4-6d48d3ec8793","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":1426576384874231,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}