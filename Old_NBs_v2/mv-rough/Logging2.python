{"version":"NotebookV1","origId":2709619314155289,"name":"Logging2","language":"python","commands":[{"version":"CommandV1","origId":2709619314155290,"guid":"e32e6ef9-0c52-4de9-88ec-3337d39902bd","subtype":"command","commandType":"auto","position":3.0,"command":"import logging\nimport datetime\n\nbasepath = \"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/raw/ISU_archive/execution_logs/\"\n\nct = datetime.datetime.now().strftime('%Y%m%d_%H%M%S')\nfilenamewithtime = \"EDA_\" + ct +\".log\"\npartitions = datetime.datetime.now().strftime('%Y-%m-%d/')\n\n# add folder if not existent\ndbutils.fs.mkdirs(basepath)\n\ndbfsbasepath = \"/tmp\" + \"/\" + filenamewithtime\n","commandVersion":212,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662128267856,"submitTime":1662128267577,"finishTime":1662128268205,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1f01e888-f651-4109-8cd3-ab07f49f9680"},{"version":"CommandV1","origId":2709619314155291,"guid":"9ca91482-588a-4859-a922-92f8475d5f51","subtype":"command","commandType":"auto","position":3.25,"command":"print(dbfsbasepath)\nprint(partitions)","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/tmp/EDA_20220902_141747.log\n2022-09-02/\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662128268210,"submitTime":1662128267606,"finishTime":1662128268264,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",68]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"98bb638e-8ab0-4d26-8ac8-5b07c91a436e"},{"version":"CommandV1","origId":2709619314155292,"guid":"968203ce-8b72-4ced-ab2e-4bafd9d636aa","subtype":"command","commandType":"auto","position":4.0,"command":"# Creating an object\nlogger = logging.getLogger('demologger')\n\n# Setting the threshold of logger to INFO\nlogger.setLevel(logging.INFO)\n\nFilehandler = logging.FileHandler(dbfsbasepath,mode = 'a')\n\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\n\n\nlogger.addHandler(Filehandler)\n\n# Test messages\nlogger.debug(\"Harmless debug Message\")\nlogger.info(\"Just an information\")\nlogger.warning(\"Its a Warning\")\nlogger.error(\"Did you try to divide by zero\")\nlogger.critical(\"Internet is down\")\nlogger.info(\"parameters : \" + \"parameters : \" + \"param2 :\" + \"param2 :\" + \"param3 : \" + \"param3 : \")\n","commandVersion":129,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">--- Logging error ---\nTraceback (most recent call last):\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1029, in emit\n    self.flush()\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1009, in flush\n    self.stream.flush()\nOSError: [Errno 95] Operation not supported\nCall stack:\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1739, in &lt;module&gt;\n    launch_process()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1734, in launch_process\n    shell.executor.run()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 336, in run\n    self.shell.shell.run_cell(command_id, cmd, store_history=True)\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1128, in run_cell\n    super(IPythonShell, self).run_cell(raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2858, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2886, in _run_cell\n    return runner(coro)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/async_helpers.py&#34;, line 68, in _pseudo_sync_runner\n    coro.send(None)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3063, in run_cell_async\n    interactivity=interactivity, compiler=compiler, result=result)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3254, in run_ast_nodes\n    if (await self.run_code(code, result,  async_=asy)):\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3331, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File &#34;&lt;command-2478586345287328&gt;&#34;, line 17, in &lt;module&gt;\n    logger.info(&#34;Just an information&#34;)\nMessage: &#39;Just an information&#39;\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1029, in emit\n    self.flush()\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1009, in flush\n    self.stream.flush()\nOSError: [Errno 95] Operation not supported\nCall stack:\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1739, in &lt;module&gt;\n    launch_process()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1734, in launch_process\n    shell.executor.run()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 336, in run\n    self.shell.shell.run_cell(command_id, cmd, store_history=True)\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1128, in run_cell\n    super(IPythonShell, self).run_cell(raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2858, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2886, in _run_cell\n    return runner(coro)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/async_helpers.py&#34;, line 68, in _pseudo_sync_runner\n    coro.send(None)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3063, in run_cell_async\n    interactivity=interactivity, compiler=compiler, result=result)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3254, in run_ast_nodes\n    if (await self.run_code(code, result,  async_=asy)):\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3331, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File &#34;&lt;command-2478586345287328&gt;&#34;, line 18, in &lt;module&gt;\n    logger.warning(&#34;Its a Warning&#34;)\nMessage: &#39;Its a Warning&#39;\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1029, in emit\n    self.flush()\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1009, in flush\n    self.stream.flush()\nOSError: [Errno 95] Operation not supported\nCall stack:\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1739, in &lt;module&gt;\n    launch_process()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1734, in launch_process\n    shell.executor.run()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 336, in run\n    self.shell.shell.run_cell(command_id, cmd, store_history=True)\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1128, in run_cell\n    super(IPythonShell, self).run_cell(raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2858, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2886, in _run_cell\n    return runner(coro)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/async_helpers.py&#34;, line 68, in _pseudo_sync_runner\n    coro.send(None)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3063, in run_cell_async\n    interactivity=interactivity, compiler=compiler, result=result)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3254, in run_ast_nodes\n    if (await self.run_code(code, result,  async_=asy)):\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3331, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File &#34;&lt;command-2478586345287328&gt;&#34;, line 19, in &lt;module&gt;\n    logger.error(&#34;Did you try to divide by zero&#34;)\nMessage: &#39;Did you try to divide by zero&#39;\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1029, in emit\n    self.flush()\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1009, in flush\n    self.stream.flush()\nOSError: [Errno 95] Operation not supported\nCall stack:\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1739, in &lt;module&gt;\n    launch_process()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1734, in launch_process\n    shell.executor.run()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 336, in run\n    self.shell.shell.run_cell(command_id, cmd, store_history=True)\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1128, in run_cell\n    super(IPythonShell, self).run_cell(raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2858, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2886, in _run_cell\n    return runner(coro)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/async_helpers.py&#34;, line 68, in _pseudo_sync_runner\n    coro.send(None)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3063, in run_cell_async\n    interactivity=interactivity, compiler=compiler, result=result)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3254, in run_ast_nodes\n    if (await self.run_code(code, result,  async_=asy)):\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3331, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File &#34;&lt;command-2478586345287328&gt;&#34;, line 20, in &lt;module&gt;\n    logger.critical(&#34;Internet is down&#34;)\nMessage: &#39;Internet is down&#39;\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1029, in emit\n    self.flush()\n  File &#34;/usr/lib/python3.7/logging/__init__.py&#34;, line 1009, in flush\n    self.stream.flush()\nOSError: [Errno 95] Operation not supported\nCall stack:\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1739, in &lt;module&gt;\n    launch_process()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1734, in launch_process\n    shell.executor.run()\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 336, in run\n    self.shell.shell.run_cell(command_id, cmd, store_history=True)\n  File &#34;/local_disk0/tmp/1662111899899-0/PythonShell.py&#34;, line 1128, in run_cell\n    super(IPythonShell, self).run_cell(raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2858, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 2886, in _run_cell\n    return runner(coro)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/async_helpers.py&#34;, line 68, in _pseudo_sync_runner\n    coro.send(None)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3063, in run_cell_async\n    interactivity=interactivity, compiler=compiler, result=result)\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3254, in run_ast_nodes\n    if (await self.run_code(code, result,  async_=asy)):\n  File &#34;/databricks/python/lib/python3.7/site-packages/IPython/core/interactiveshell.py&#34;, line 3331, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File &#34;&lt;command-2478586345287328&gt;&#34;, line 21, in &lt;module&gt;\n    logger.info(&#34;parameters : &#34; + &#34;parameters : &#34; + &#34;param2 :&#34; + &#34;param2 :&#34; + &#34;param3 : &#34; + &#34;param3 : &#34;)\nMessage: &#39;parameters : parameters : param2 :param2 :param3 : param3 : &#39;\nArguments: ()\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662128268268,"submitTime":1662128267636,"finishTime":1662128268330,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",10509]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"25af6210-1ee7-45e1-8e55-9f27ad811732"},{"version":"CommandV1","origId":2709619314155293,"guid":"0574c19d-dca1-474a-a0c0-db28c81d9bbf","subtype":"command","commandType":"auto","position":5.5,"command":"dbutils.fs.cp(\"file:\" + dbfsbasepath,basepath + partitions + filenamewithtime)","commandVersion":25,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[62]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662128268334,"submitTime":1662128267712,"finishTime":1662128268501,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",40]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"49a216e0-17ff-435e-82cc-099114892dd0"}],"dashboards":[],"guid":"f1e097bc-980c-49ee-960b-25bbd1a2544f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}