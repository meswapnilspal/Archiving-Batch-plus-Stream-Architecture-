{"version":"NotebookV1","origId":2709619314154925,"name":"STD STREAM_DATA_PREPARATION_testcopy","language":"python","commands":[{"version":"CommandV1","origId":2709619314154926,"guid":"a2f2c7be-6280-4e44-a5bf-eaea1a10dd10","subtype":"command","commandType":"auto","position":2.0,"command":"#%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ae070075-a4ee-4ead-920c-4ea4d257ffb6"},{"version":"CommandV1","origId":2709619314154927,"guid":"ac575861-724a-4cef-976b-772a18db8dc0","subtype":"command","commandType":"auto","position":3.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.window import Window\nimport fnmatch","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"04bcbbb4-8940-4551-a763-fb644437abd9"},{"version":"CommandV1","origId":2709619314154928,"guid":"f0e47bfc-3277-4820-a001-4c67b839eb9a","subtype":"command","commandType":"auto","position":4.0,"command":"# SET TABLE NAME\ndbutils.widgets.text(\"table_name\", \"\", \"table name\")\ntable_name = dbutils.widgets.get(\"table_name\")\n\n#SET METADATA FILEPATH in ADLS (For Example = abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv)\ndbutils.widgets.text(\"metafilepath\", \"\", \"METADATA FILEPATH\")\nmetafilepath = dbutils.widgets.get(\"metafilepath\")\n\n# SET STAGING LOCATION ( source here )\ndbutils.widgets.text(\"staging_location\", \"\", \"staging location\")\nstaging_location = dbutils.widgets.get(\"staging_location\") + \"/\" + table_name.lower()\n\n# SET CURATED LOCATION ( destination here )\ndbutils.widgets.text(\"curated_location\", \"\", \"curated location\")\ncurated_location = dbutils.widgets.get(\"curated_location\") + \"/\" + table_name\n\n# SET SILVER LOACATION\ndbutils.widgets.text(\"silver_location\", \"\", \"silver zone\")\nsilver_location = dbutils.widgets.get(\"silver_location\") + \"/\" + table_name\n\n# SET FULL LOAD = Yes/No\ndbutils.widgets.text(\"FULL_LOAD\", \"No\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")\n\n# Set DBFS log file path\ndbutils.widgets.text(\"dbfslogbasepath\", \"\", \"DBFS LOG FILE PATH\")\ndbfslogbasepath = dbutils.widgets.get(\"dbfslogbasepath\")\n\n# Set DBFS log second file path\ndbutils.widgets.text(\"n_dbfslogbasepath\", \"\", \"DBFS STATUS LOG FILE PATH\")\nn_dbfslogbasepath = dbutils.widgets.get(\"n_dbfslogbasepath\")\n\n# # SET RUN FOR N PREVIOUS DAYS (0 BYDEFAULT, EXAMPLES : 1,2,3,4,5,6..)\n# dbutils.widgets.text(\"runfornpreviousdays\", \"\", \"RUN FOR N PREVIOUS DAYS\")\n# runfornpreviousdays = dbutils.widgets.get(\"runfornpreviousdays\")\n\n# SET RUN FOR N PREVIOUS DAYS (0 BYDEFAULT, EXAMPLES : 1,2,3,4,5,6..)\ndbutils.widgets.text(\"runsincedate\", \"\", \"RUN SINCE DATE\")\nrunsincedate = dbutils.widgets.get(\"runsincedate\")","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{"curated_location":"","table_name":"","metafilepath":"","dbfslogbasepath":"","staging_location":"","n_dbfslogbasepath":"","runsincedate":"","silver_location":"","FULL_LOAD":"No"},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}},"table_name":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}},"metafilepath":{"widgetType":"text","name":"metafilepath","defaultValue":"","label":"METADATA FILEPATH","options":{"widgetType":"text","validationRegex":null}},"dbfslogbasepath":{"widgetType":"text","name":"dbfslogbasepath","defaultValue":"","label":"DBFS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}},"staging_location":{"widgetType":"text","name":"staging_location","defaultValue":"","label":"staging location","options":{"widgetType":"text","validationRegex":null}},"n_dbfslogbasepath":{"widgetType":"text","name":"n_dbfslogbasepath","defaultValue":"","label":"DBFS STATUS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}},"runsincedate":{"widgetType":"text","name":"runsincedate","defaultValue":"","label":"RUN SINCE DATE","options":{"widgetType":"text","validationRegex":null}},"silver_location":{"widgetType":"text","name":"silver_location","defaultValue":"","label":"silver zone","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1663681251992,"submitTime":1663681251068,"finishTime":1663681252022,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1401b238-cd38-4faa-9cee-c27f3ecd6393"},{"version":"CommandV1","origId":2709619314154929,"guid":"d19dd61c-24bc-4b52-989e-34d077143630","subtype":"command","commandType":"auto","position":5.0,"command":"print(table_name)\nprint(metafilepath)\nprint(staging_location)\nprint(curated_location)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c02abc82-2794-4d77-9d2d-4c16797b5c68"},{"version":"CommandV1","origId":2709619314154930,"guid":"7e862255-48d9-4032-af07-03a02334d6d6","subtype":"command","commandType":"auto","position":6.0,"command":"#START LOGGING #1\n\nimport logging\nimport datetime\n\n#TAG LOGGING INFO TO NOTEBOOK\nlogger = logging.getLogger('DataPreparationNotebook')\n#SETTING THRESHOLD OF LOGGER TO INFO\nlogger.setLevel(logging.INFO)\nFilehandler = logging.FileHandler(dbfslogbasepath,mode = 'a')\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\nlogger.addHandler(Filehandler)\n#LOG INFO\nlogger.info(\"DataPreparation is Running... \")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d999ad02-d896-43a3-b305-fbc9a70c3724"},{"version":"CommandV1","origId":2709619314154931,"guid":"82f1444a-0ffd-4603-8f19-ec798e03af86","subtype":"command","commandType":"auto","position":7.0,"command":"# #START LOGGING #2\n\nimport logging\nimport datetime\n#TAG LOGGING INFO TO NOTEBOOK\nn_logger = logging.getLogger('DataPreperationNotebook')\n#SETTING THRESHOLD OF LOGGER TO INFO\nn_logger.setLevel(logging.INFO)\nn_Filehandler = logging.FileHandler(n_dbfslogbasepath,mode = 'a')\nn_formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nn_Filehandler.setFormatter(n_formatter)\nn_logger.addHandler(n_Filehandler)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bccc5f11-0ebe-44d6-b709-6cb779684090"},{"version":"CommandV1","origId":2709619314154932,"guid":"8c1b4655-698a-4d0e-adcf-bcfd6d6ae657","subtype":"command","commandType":"auto","position":8.0,"command":"if (str(FULL_LOAD) == 'Yes'):\n  bronze_loc_cp = curated_location + \"_checkpoint\"\n  bronze_loc = curated_location\n  silver_loc = silver_location\n  print(bronze_loc,bronze_loc_cp,silver_loc, sep='\\n')\n  dbutils.fs.rm(bronze_loc_cp, True)\n  logger.info(\"removed bronze checkpoint directory : refer cmd 6\")\n  dbutils.fs.rm(bronze_loc, True)\n  logger.info(\"removed bronze directory : refer cmd 6\")\n  dbutils.fs.rm(silver_loc, True)\n  logger.info(\"removed silver directory : refer cmd 6\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"30fa5d86-a27a-4e78-a693-498e5f9d94a2"},{"version":"CommandV1","origId":2709619314154933,"guid":"2b76db4f-d460-4fe4-8797-ccf005bf60ef","subtype":"command","commandType":"auto","position":9.0,"command":"try:\n  s = \"originaldf = spark.readStream.option('ignoreChanges', 'true').format('delta').load(\" + \"'\" + staging_location + \"'\" + \")\"\n  print(s)\n  exec(s)\n  logger.info(\"Reading datafiles from replicate location succeeded : refer cmd 7\")\nexcept Exception as e:\n  logger.error(\"Reading datafiles from replicate location FAILED : refer cmd 7 : \" + str(e))\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8e603765-087b-48f4-addf-76902dc8711b"},{"version":"CommandV1","origId":2709619314154934,"guid":"6b96287b-6294-4dbd-9f76-8eb516e90332","subtype":"command","commandType":"auto","position":10.0,"command":"%run \"../Metadata/Load_Metadata\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ef717523-a4ca-48ec-a381-9aa031d30862"},{"version":"CommandV1","origId":2709619314154935,"guid":"cb2fcdf0-84d1-4324-8e54-415a3dfe6ac1","subtype":"command","commandType":"auto","position":11.0,"command":"metadf = load_metadata_df(metafilepath)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4fa44ef0-b726-4432-a826-0cc44138d4fe"},{"version":"CommandV1","origId":2709619314154936,"guid":"832ba625-881f-45d8-ae78-c89b746e0abc","subtype":"command","commandType":"auto","position":12.0,"command":"keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\nnewdf = originaldf.dropDuplicates(keyfields)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"81ce9287-f448-4ae1-ae7f-c73fc12296fb"},{"version":"CommandV1","origId":2709619314154937,"guid":"5688e71f-6972-41af-9f2e-3382b635c648","subtype":"command","commandType":"auto","position":13.0,"command":"def generate_code_for_casting_columns_based_on_metadata(metadf,table_name,dfname,newdfname):\n  z = str(\"\")\n  cols = metadf.select(\"Field_Name\",\"delta_types\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[0]).collect()\n  col_types = metadf.select(\"Field_Name\",\"delta_types\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[1]).collect()\n  for i,j in zip(cols,col_types):\n    i = '\"' + i + '\"'\n    j = '\"' + j + '\"'\n    z = z + ('.withColumn(' + i + ',col(' + i + ').cast(' + j + '))')\n  return(newdfname + ' = ' + dfname + z)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"aaeb2403-522c-480c-bbc4-05ac967b073e"},{"version":"CommandV1","origId":2709619314154938,"guid":"ee0d606a-8b87-4897-9769-be3b77669ab6","subtype":"command","commandType":"auto","position":14.0,"command":"try:\n  get_code = generate_code_for_casting_columns_based_on_metadata(metadf,table_name,'newdf','casted_df')\n  exec(get_code)\n  print(get_code)\n  logger.info(\"generate_code_for_casting_columns_based_on_metadata function succeeded : refer cmd 11\")\nexcept Exception as e:\n  logger.error(\"generate_code_for_casting_columns_based_on_metadata function FAILED : refer cmd 11 : \" + str(e))\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7e5529e3-ad6c-496e-bd88-7a8aa6396493"},{"version":"CommandV1","origId":2709619314154939,"guid":"addb411f-5d03-4d82-9b0d-892e68acbeae","subtype":"command","commandType":"auto","position":15.0,"command":"def generate_code_for_creating_partition_column_based_on_type(metadf,table_name,dfname,newdfname):  \n  # get partition column from metatable\n  col1 = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n  #print(col1)\n  #print(col1[0])\n  col2 = metadf.select('Partition_Key_Encoding').where(col('Table_Name')==table_name).where(col('Partition_Key') == 'Y').rdd.map(lambda x : x[0]).collect()\n  #print(col2[0])\n  if col1:\n    column_for_partition_logic = col1[0]\n    partition_logic_encoding = int(col2[0])\n  else:\n    column_for_partition_logic = None\n    partition_logic_encoding = None\n  \n  # decide partitioning logic based on encoding, and create partition column \n\n  if partition_logic_encoding == 1:\n    Logic_1 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',expr('substring(\" + column_for_partition_logic + \",length(\" + column_for_partition_logic +\") - 2,length(\" + column_for_partition_logic + \"))'))\"\n    return(Logic_1)\n  elif partition_logic_encoding == 2:\n    Logic_2 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',substring('\" + column_for_partition_logic + \"',1,6))\"\n    return(Logic_2)\n  elif partition_logic_encoding == 3:\n    Logic_3 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',substring('\" + column_for_partition_logic + \"',1,4))\"\n    return(Logic_3)\n  else:\n    Logic_4 = newdfname + \" = \" + dfname\n    return(Logic_4)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8b8ecf9b-97cb-4716-ab5a-ff80f99e8881"},{"version":"CommandV1","origId":2709619314154940,"guid":"f7817545-c7cb-49ab-9b53-2d9b65ecc916","subtype":"command","commandType":"auto","position":16.0,"command":"try:\n  get_code = generate_code_for_creating_partition_column_based_on_type(metadf,table_name,'casted_df','replicate_df')\n  print(get_code)\n  exec(get_code)\n  logger.info(\"generate_code_for_creating_partition_column_based_on_type function succeeded : refer cmd 13\")\nexcept Exception as e:\n  logger.error(\"generate_code_for_creating_partition_column_based_on_type function FAILED : refer cmd 13  : \" + str(e))\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cbae17c0-e2b4-457c-a472-e558c1cdbba5"},{"version":"CommandV1","origId":2709619314154941,"guid":"898cc5c9-edf1-4c87-ab37-9949ef8b44d0","subtype":"command","commandType":"auto","position":17.0,"command":"replicate_flags_added = replicate_df.withColumn('EPOCH_FLAG',lit('CURRENT')).withColumn(\"EDA_Creation_date\",current_timestamp()).withColumn(\"BATCH_date\",current_date())","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8dc53d7f-63df-422a-8f43-de99c1270536"},{"version":"CommandV1","origId":2709619314154942,"guid":"fec5c2b9-f5b5-43d3-82c9-8b3c0a3aba78","subtype":"command","commandType":"auto","position":18.0,"command":"write_df = replicate_flags_added.drop('hdr__created_batch','hdr__modified_batch','hdr__oper','hdr__ts')","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"33d4a8d5-ef1a-44c5-b5fb-cabea0b65fdd"},{"version":"CommandV1","origId":2709619314154943,"guid":"999aa107-48b8-4462-a407-093da38122cc","subtype":"command","commandType":"auto","position":19.0,"command":"#Mrunal Comment\n# try:\n#   print(curated_location)\n\n#   saveloc = f\"{curated_location}\"\n\n#   streamQuery = write_df.writeStream.trigger(once=True).format(\"delta\").partitionBy(\"BATCH_date\").option(\"checkpointLocation\",f\"{saveloc}_checkpoint\").start(saveloc)\n#   streamQuery.awaitTermination()\n#   n_logger.info(table_name + \" : Writing data to BRONZE Succeeded\")\n# except Exception as e:\n#   logger.error(\"writeStream FAILED : refer cmd 16 : \" + str(e))\n#   n_logger.error(table_name + \" : Writing data to BRONZE FAILED : \" + str(e))","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bdebea50-8d00-4e21-b61e-f75278b26fc6"},{"version":"CommandV1","origId":2709619314154944,"guid":"12c17e29-272e-4180-8770-255c9d5adc3a","subtype":"command","commandType":"auto","position":20.0,"command":"#Mrunal alt\ntry:\n  print(curated_location)\n\n  saveloc = f\"{curated_location}\"\n\n  streamQuery = write_df.writeStream.trigger(once=True).format(\"delta\").option(\"checkpointLocation\",f\"{saveloc}_checkpoint\").start(saveloc)\n  streamQuery.awaitTermination()\n  n_logger.info(table_name + \" : Writing data to BRONZE Succeeded\")\nexcept Exception as e:\n  logger.error(\"writeStream FAILED : refer cmd 16 : \" + str(e))\n  n_logger.error(table_name + \" : Writing data to BRONZE FAILED : \" + str(e))","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6c54c549-14b7-4b20-9259-7334e69b8e1d"},{"version":"CommandV1","origId":2709619314154945,"guid":"2f8ebd83-2886-4fd7-b407-fabc7e209d59","subtype":"command","commandType":"auto","position":21.0,"command":"try:\n  s = \"bronzedf_entire = spark.read.format('delta').load(\" + \"'\" + curated_location + \"'\" + \")\"\n  exec(s)\n  logger.info(\"Reading all data from Bronze location succeeded : refer cmd 17\")\nexcept Exception as e:\n  logger.error(\"Reading all data from Bronze location FAILED : refer cmd 17 : \" + str(e))\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8c83c132-0538-4387-9825-1f90fc6317ae"},{"version":"CommandV1","origId":2709619314154946,"guid":"d8361348-8566-4dcd-aefc-046c55a19588","subtype":"command","commandType":"auto","position":22.0,"command":"\n# if (str(FULL_LOAD) == 'Yes'):\n#   bronzedf = bronzedf_entire\n#   logger.info(\"Reading from Bronze location for entire data FULL LOAD = Yes, succeeded : refer cmd 18\")\n# else:\n#   bronzedf = bronzedf_entire.where(col(\"BATCH_date\") == current_date())\n#   logger.info(\"Reading from Bronze location for current date or the date set succeeded : refer cmd 18\")\n  ","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6fb92159-fd22-43e9-b446-4e5baeb8071e"},{"version":"CommandV1","origId":2709619314154947,"guid":"a98c0e28-85a8-40f5-9ee7-0b027b818aec","subtype":"command","commandType":"auto","position":23.0,"command":"# #import pyspark.sql.functions as F \n# if (str(FULL_LOAD) == 'Yes'):\n#   bronzedf = bronzedf_entire\n# else:\n#   if runfornpreviousdays:\n#     bronzedf = bronzedf_entire.where(col(\"BATCH_date\") >=(current_date() - int(runfornpreviousdays)))\n#     #print(bronzedf)\n#   else:\n#     bronzedf = bronzedf_entire.where(col(\"BATCH_date\") == current_date())","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fdfbff2c-e7e9-4135-8eb3-1a6c584e662f"},{"version":"CommandV1","origId":2709619314154948,"guid":"de3dd484-a3eb-430f-a578-862cd22ab113","subtype":"command","commandType":"auto","position":24.0,"command":"from datetime import datetime\nif (str(FULL_LOAD) == 'Yes'):\n  bronzedf = bronzedf_entire\n  logger.info(\"Reading from Bronze location for entire data FULL LOAD = Yes, succeeded : refer cmd 20\")\nelse:\n  if runsincedate:\n    bronzedf = bronzedf_entire.where(col(\"BATCH_date\") >=(datetime.strptime(runsincedate,\"%Y-%m-%d\")))\n    logger.info(\"Reading from Bronze location for date set succeeded : refer cmd 20\")\n    #print(bronzedf)\n  else:\n    bronzedf = bronzedf_entire.where(col(\"BATCH_date\") == current_date())\n    logger.info(\"Reading from Bronze location for current date succeeded : refer cmd 20\")","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8eab8e43-e743-4e0f-ad2a-7c5f89f1b03c"},{"version":"CommandV1","origId":2709619314154949,"guid":"b7412d7e-1759-44f3-aa55-95d593364ccf","subtype":"command","commandType":"auto","position":25.0,"command":"print(bronzedf.count())","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"46b3a319-83cd-4208-a2a3-3245ea91bb36"},{"version":"CommandV1","origId":2709619314154950,"guid":"a3ada93f-528e-4d52-8422-e1820266f522","subtype":"command","commandType":"auto","position":26.0,"command":"# # FUNCTION TO REMOVE DUPLICATES\n\n# def duplicates_removal(dups_df):\n#   df = dups_df.drop_duplicates()\n#   keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n#   print(keyfields)\n#   orderbycol = 'EDA_Creation_date'\n\n#   windowspec = Window.partitionBy(keyfields).orderBy(orderbycol)\n#   table_archive = df.withColumn(\"row_number\",row_number().over(windowspec)).select(\"*\").where(col(\"row_number\")==1)\n#   return (table_archive)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c4f8890a-64f2-4cb7-afb7-c0ad43d4964f"},{"version":"CommandV1","origId":2709619314154951,"guid":"a2f11c54-7df5-4f1d-88f5-df9e47999fc5","subtype":"command","commandType":"auto","position":27.0,"command":"#keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\nbronze_with_BATCH_date = bronzedf    #.drop_duplicates()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"958e1242-7675-4296-a7e4-e45427aeea9d"},{"version":"CommandV1","origId":2709619314154952,"guid":"37995b66-9722-475f-af4c-76f7beccd66b","subtype":"command","commandType":"auto","position":28.0,"command":"# bronze_with_BATCH_date = duplicates_removal(bronzedf)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6ee2de18-f3a5-4aae-b81a-548e506dd932"},{"version":"CommandV1","origId":2709619314154953,"guid":"a42dffc5-40f3-484c-b394-9fcb668960df","subtype":"command","commandType":"auto","position":29.0,"command":"# print(bronze_with_BATCH_date.count())","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f26f8bf5-e9bf-4957-a29c-8139c78c8e31"},{"version":"CommandV1","origId":2709619314154954,"guid":"bf1f3bfe-e9af-4da9-9838-ea8502e8ad37","subtype":"command","commandType":"auto","position":30.0,"command":"# display(bronze_with_BATCH_date.select(\"*\").where(col(\"row_number\")>1)","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b7c698cd-bcbd-454e-98f4-3ae89fbdd6c9"},{"version":"CommandV1","origId":2709619314154955,"guid":"b3e963ac-da27-4be8-af0d-d48b1b17fe0a","subtype":"command","commandType":"auto","position":31.0,"command":"# bronze_write_DF = bronze_with_BATCH_date.drop('BATCH_date','row_number')","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2f0f256d-f8a3-4796-a11d-5696c1acc28d"},{"version":"CommandV1","origId":2709619314154956,"guid":"277d86ce-0701-4f3b-add9-13d8d7bce176","subtype":"command","commandType":"auto","position":32.0,"command":"bronze_write_DF = bronze_with_BATCH_date.drop('BATCH_date')","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8450ad57-89b1-4248-b297-1b8906eca529"},{"version":"CommandV1","origId":2709619314154957,"guid":"bfd28f20-07ab-4bf9-8412-0d0aaa43b1ec","subtype":"command","commandType":"auto","position":33.0,"command":"# try:\n#   from delta.tables import *\n#   from pyspark.sql.functions import *\n#   spark.conf.set(\"spark.databricks.io.cache.enabled\", \"true\")\n  \n#   if_partitioned_table = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n  \n#   if (str(FULL_LOAD) == 'Yes'):\n      \n#     if if_partitioned_table:\n#       s = 'bronze_write_DF.limit(1).write.format(\"delta\").mode(\"overwrite\").partitionBy(\"partitioncol\").save(' + \"'\" + silver_location + \"'\" + ')'\n#       exec(s)\n#       logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n#       n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n#     else:\n#       s = 'bronze_write_DF.limit(1).write.format(\"delta\").mode(\"overwrite\").save(' + \"'\" + silver_location + \"'\" + ')'\n#       exec(s)\n#       logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n#       n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n      \n  \n#   keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n#   cond = ''\n#   exitindex = len(keyfields)-1\n#   for i in keyfields:\n#       if keyfields.index(i) == exitindex:\n#           cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i\n#       else:\n#           cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i + ' AND '\n\n#   #cond = cond + ' AND logs.EDA_Creation_date < newDedupedLogs.EDA_Creation_date'\n#   print(cond)\n\n#   s = \"deltaTable = DeltaTable.forPath(spark, \" + \"'\" + silver_location + \"'\" + \")\"\n#   exec(s)\n#   print(type(deltaTable))\n\n#   logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n#   n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n\n#   newDedupedLogs = bronze_write_DF\n\n#   deltaTable.alias(\"logs\").merge(\n#       newDedupedLogs.alias(\"newDedupedLogs\"),\n#       cond) \\\n#     .whenMatchedUpdateAll() \\\n#     .whenNotMatchedInsertAll() \\\n#     .execute()\n# except Exception as e:\n#   logger.error(\"MERGE FAILED FOR SILVER LOCATION : refer cmd 25 : \" + str(e))\n#   n_logger.info(table_name + \" : Writing data to SILVER FAILED : \" + str(e))\n  ","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a4c27b62-04fb-4939-b5a3-84bf248c39ed"},{"version":"CommandV1","origId":2709619314154958,"guid":"498a4490-38bd-4b4d-9fe1-33b080998472","subtype":"command","commandType":"auto","position":34.0,"command":"try:\n  from delta.tables import *\n  from pyspark.sql.functions import *\n  spark.conf.set(\"spark.databricks.io.cache.enabled\", \"true\")\n  \n  if_partitioned_table = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n  \n  if (str(FULL_LOAD) == 'Yes'):\n      \n    if if_partitioned_table:\n      s = 'bronze_write_DF.limit(1).write.format(\"delta\").mode(\"overwrite\").partitionBy(\"partitioncol\").save(' + \"'\" + silver_location + \"'\" + ')'\n      exec(s)\n      logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n      n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n    else:\n      s = 'bronze_write_DF.limit(1).write.format(\"delta\").mode(\"overwrite\").save(' + \"'\" + silver_location + \"'\" + ')'\n      exec(s)\n      logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n      n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n      \n  \n  keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n  cond = ''\n  exitindex = len(keyfields)-1\n  for i in keyfields:\n      if keyfields.index(i) == exitindex:\n          cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i\n      else:\n          cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i + ' AND '\n\n  #cond = cond + ' AND logs.EDA_Creation_date < newDedupedLogs.EDA_Creation_date'\n  print(cond)\n\n  s = \"deltaTable = DeltaTable.forPath(spark, \" + \"'\" + silver_location + \"'\" + \")\"\n  exec(s)\n  print(type(deltaTable))\n\n  logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n  n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n\n  newDedupedLogs = bronze_write_DF\n\n  deltaTable.alias(\"logs\").merge(\n      newDedupedLogs.alias(\"newDedupedLogs\"),\n      cond) \\\n    .whenMatchedUpdateAll() \\\n    .whenNotMatchedInsertAll() \\\n    .execute()\n   \nexcept Exception as e:\n  logger.error(\"MERGE FAILED FOR SILVER LOCATION : refer cmd 25 : \" + str(e))\n  n_logger.info(table_name + \" : Writing data to SILVER FAILED : \" + str(e))\n  ","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7bf312aa-6328-463c-8eb0-141ede8cdbdd"},{"version":"CommandV1","origId":2709619314154959,"guid":"4f322a81-f150-4754-bbd8-ac5a7649dc22","subtype":"command","commandType":"auto","position":35.0,"command":"# %sql\n# #stream\n#     MERGE deltaTable AS TARGET\n# \tUSING newDedupedLogs AS SOURCE\n#     ON cond\n# \tWHEN MATCHED\n# \tTHEN UPDATE ALL\n# \tWHEN NOT MATCHED BY TARGET\n# \tTHEN INSERT ALL\n\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5e946c4a-6e71-4058-a106-3e5d21f4ca94"},{"version":"CommandV1","origId":2709619314154960,"guid":"d7936811-1f6c-439b-a635-1451232a613c","subtype":"command","commandType":"auto","position":36.0,"command":"# %sql\n\n# #history\n#     MERGE deltaTable AS TARGET\n# \tUSING newDedupedLogs AS SOURCE\n#     ON cond\n# \tWHEN MATCHED AND TARGET.EPOCH_Flag = 'Archive'\n# \tTHEN UPDATE ALL\n# \tWHEN NOT MATCHED BY TARGET\n# \tTHEN INSERT ALL","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b401109b-6df4-4783-a571-4d959a45d45d"},{"version":"CommandV1","origId":2709619314154961,"guid":"ddf3bf13-81ce-49cd-87eb-1dd8e4c97a58","subtype":"command","commandType":"auto","position":37.0,"command":"# try:\n#   from delta.tables import *\n#   from pyspark.sql.functions import *\n#   spark.conf.set(\"spark.databricks.io.cache.enabled\", \"true\")\n  \n#   if_partitioned_table = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n  \n#   if (str(FULL_LOAD) == 'Yes'):\n      \n#     if if_partitioned_table:\n#       s = 'bronze_write_DF.limit(1).write.format(\"delta\").mode(\"overwrite\").partitionBy(\"partitioncol\").save(' + \"'\" + silver_location + \"'\" + ')'\n#       exec(s)\n#       logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n#       n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n#     else:\n#       s = 'bronze_write_DF.limit(1).write.format(\"delta\").mode(\"overwrite\").save(' + \"'\" + silver_location + \"'\" + ')'\n#       exec(s)\n#       logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n#       n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n      \n  \n#   keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n#   cond = ''\n#   exitindex = len(keyfields)-1\n#   for i in keyfields:\n#       if keyfields.index(i) == exitindex:\n#           cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i\n#       else:\n#           cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i + ' AND '\n\n#   #cond = cond + ' AND logs.EDA_Creation_date < newDedupedLogs.EDA_Creation_date'\n#   print(cond)\n\n#   s = \"deltaTable = DeltaTable.forPath(spark, \" + \"'\" + silver_location + \"'\" + \")\"\n#   exec(s)\n#   print(type(deltaTable))\n\n#   logger.info(\"Writing to Silver location succeeded : refer cmd 25\")\n#   n_logger.info(table_name + \" : Writing data to SILVER Succeeded\")\n\n#   newDedupedLogs = bronze_write_DF\n\n#   deltaTable.alias(\"logs\").merge(\n#       newDedupedLogs.alias(\"newDedupedLogs\"),\n#       cond) \\\n#     .whenMatchedUpdateAll() \\\n#     .whenNotMatchedInsertAll() \\\n#     .execute()\n# except Exception as e:\n#   logger.error(\"MERGE FAILED FOR SILVER LOCATION : refer cmd 25 : \" + str(e))\n#   n_logger.info(table_name + \" : Writing data to SILVER FAILED : \" + str(e))\n  ","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"41258f85-7165-4cc8-9ee2-1ef93a049aae"}],"dashboards":[],"guid":"96eaec95-b0b2-4337-9cfb-3e7820abf0a0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location":{"nuid":"89c73780-9b8a-4ae7-98c2-ed567971bf2d","currentValue":"","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}}},"table_name":{"nuid":"5dbf02a3-670e-463c-a837-e4587658ef66","currentValue":"","widgetInfo":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}},"metafilepath":{"nuid":"6dafb6f1-dd9e-42ea-a1c8-c3edbfa3d242","currentValue":"","widgetInfo":{"widgetType":"text","name":"metafilepath","defaultValue":"","label":"METADATA FILEPATH","options":{"widgetType":"text","validationRegex":null}}},"dbfslogbasepath":{"nuid":"a6328946-48c7-4842-a195-0ac864275bd3","currentValue":"","widgetInfo":{"widgetType":"text","name":"dbfslogbasepath","defaultValue":"","label":"DBFS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}}},"staging_location":{"nuid":"66560d43-1084-4e93-8356-fbe28d74c89b","currentValue":"","widgetInfo":{"widgetType":"text","name":"staging_location","defaultValue":"","label":"staging location","options":{"widgetType":"text","validationRegex":null}}},"n_dbfslogbasepath":{"nuid":"4f1998d2-24df-44bb-827d-7b388117d038","currentValue":"","widgetInfo":{"widgetType":"text","name":"n_dbfslogbasepath","defaultValue":"","label":"DBFS STATUS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}}},"runsincedate":{"nuid":"4a089afd-c34f-445b-ac8a-ceacf5030456","currentValue":"","widgetInfo":{"widgetType":"text","name":"runsincedate","defaultValue":"","label":"RUN SINCE DATE","options":{"widgetType":"text","validationRegex":null}}},"silver_location":{"nuid":"054091ba-f4e2-42e9-96e8-12a86fe2ec95","currentValue":"","widgetInfo":{"widgetType":"text","name":"silver_location","defaultValue":"","label":"silver zone","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"07deee8a-8241-4468-b7ca-6c71f94246cb","currentValue":"No","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}