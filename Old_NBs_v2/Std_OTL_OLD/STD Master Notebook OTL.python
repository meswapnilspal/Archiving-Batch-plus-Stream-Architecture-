{"version":"NotebookV1","origId":2709619314155771,"name":"STD Master Notebook OTL","language":"python","commands":[{"version":"CommandV1","origId":2709619314155772,"guid":"f1599599-a82b-4969-b903-f9cfe42ed2f3","subtype":"command","commandType":"auto","position":1.0,"command":"# SET LOAD TYPE (FULL LOAD = Yes/No)\ndbutils.widgets.text(\"FULL_LOAD\", \"No\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")\n\n# SET ENVIRONMENT FOR DATA LAKE (02 OR 10 OR etc)\ndbutils.widgets.text(\"env\", \"02\", \"ADLS ENVIRONMENT\")\nenv = dbutils.widgets.get(\"env\")\n\n#SET TABLE LIST (nonpii OR pii) \ndbutils.widgets.text(\"pii_or_nonpii\", \"nonpii\", \"TABLE PREFERENCE( NONPII/PII)\")\npii_or_nonpii = dbutils.widgets.get(\"pii_or_nonpii\")\n\n# SET MANUAL LIST OF TABLES (for example = table1 table2 table3 etc)\ndbutils.widgets.text(\"manual_list_str\", \"\", \"MANUAL TABLE LIST\")\nmanual_list_str = dbutils.widgets.get(\"manual_list_str\")\nmanual_list  =  (list(manual_list_str.split()))\n\n# SET DATABASE NAME\ndbutils.widgets.text(\"db_name\", \"cods_nonprod_historical\", \"DATABASE NAME\")\ndb_name = dbutils.widgets.get(\"db_name\")\n\n#SET BASEPATH\nbasepath = 'abfss://dev@dtecuprodedaadl' + env + '.dfs.core.windows.net/'\n\n#SET SEGREGATED LOCATION PATH \ndbutils.widgets.text(\"segregated_loc\", \"raw/ISU_archive/segregated\", \"SEGREGATED LOC\")\nsegregated_loc = basepath + dbutils.widgets.get(\"segregated_loc\")\n\n#SET STAGING LOCATION PATH\nstaging_location = segregated_loc\n\n#SET CURATED LOCATION PATH \ndbutils.widgets.text(\"curated_location\", \"curated/ISU_archive/archive/FINAL\", \"CURATED LOC\")\ncurated_location = basepath + dbutils.widgets.get(\"curated_location\")\n\n#SET CURATED ERROR LOCATION PATH \ndbutils.widgets.text(\"curated_location_err\", \"curated/ISU_archive/archive/ERROR\", \"CURATED LOC ERROR\")\ncurated_location_err = basepath + dbutils.widgets.get(\"curated_location_err\")\n\n#SET EXECUTION LOGS LOCATION PATH \ndbutils.widgets.text(\"execution_logs_loc\", \"ISU_archive_support/execution_logs/batch_logs\", \"EXECUTION LOGS LOC\")\nexecution_logs_loc = basepath + dbutils.widgets.get(\"execution_logs_loc\")\n\n# SET METADATA FILEPATH FROM ADLS (For example  = ISU_archive_support/metadata/Final_metadata.csv)\ndbutils.widgets.text(\"metaadlspath\", \"ISU_archive_support/metadata/Final_metadata.csv\", \"METADATA FILE LOC\")\nmetaadlspath = dbutils.widgets.get(\"metaadlspath\")\n\n# SET METADATA FILE FULL PATH TO ADLS\nmetafilepath = basepath + metaadlspath\n\n#SET TABLE CREATION NOTEBOOK PATH\ndbutils.widgets.text(\"tablecreationnbpath\", \"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable\", \"TABLE CREATION NOTEBOOK PATH\")\ntablecreationnbpath = dbutils.widgets.get(\"tablecreationnbpath\")\n\n#SET DATA PEP NOTEBOOK PATH\ndbutils.widgets.text(\"dataprepnbpath\", \"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion\", \"DATA PREP NOTEBOOK PATH\")\ndataprepnbpath = dbutils.widgets.get(\"dataprepnbpath\")","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"curated_location":"curated/ISU_archive/archive/FINAL","dataprepnbpath":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","execution_logs_loc":"ISU_archive_support/execution_logs/batch_logs","tablecreationnbpath":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","db_name":"cods_nonprod_historical","pii_or_nonpii":"nonpii","manual_list_str":"","curated_location_err":"curated/ISU_archive/archive/ERROR","metaadlspath":"ISU_archive_support/metadata/Final_metadata.csv","FULL_LOAD":"No","segregated_loc":"raw/ISU_archive/segregated","env":"02"},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"curated/ISU_archive/archive/FINAL","label":"CURATED LOC","options":{"widgetType":"text","validationRegex":null}},"dataprepnbpath":{"widgetType":"text","name":"dataprepnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","label":"DATA PREP NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}},"execution_logs_loc":{"widgetType":"text","name":"execution_logs_loc","defaultValue":"ISU_archive_support/execution_logs/batch_logs","label":"EXECUTION LOGS LOC","options":{"widgetType":"text","validationRegex":null}},"tablecreationnbpath":{"widgetType":"text","name":"tablecreationnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","label":"TABLE CREATION NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}},"db_name":{"widgetType":"text","name":"db_name","defaultValue":"cods_nonprod_historical","label":"DATABASE NAME","options":{"widgetType":"text","validationRegex":null}},"pii_or_nonpii":{"widgetType":"text","name":"pii_or_nonpii","defaultValue":"nonpii","label":"TABLE PREFERENCE( NONPII/PII)","options":{"widgetType":"text","validationRegex":null}},"manual_list_str":{"widgetType":"text","name":"manual_list_str","defaultValue":"","label":"MANUAL TABLE LIST","options":{"widgetType":"text","validationRegex":null}},"curated_location_err":{"widgetType":"text","name":"curated_location_err","defaultValue":"curated/ISU_archive/archive/ERROR","label":"CURATED LOC ERROR","options":{"widgetType":"text","validationRegex":null}},"metaadlspath":{"widgetType":"text","name":"metaadlspath","defaultValue":"ISU_archive_support/metadata/Final_metadata.csv","label":"METADATA FILE LOC","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}},"segregated_loc":{"widgetType":"text","name":"segregated_loc","defaultValue":"raw/ISU_archive/segregated","label":"SEGREGATED LOC","options":{"widgetType":"text","validationRegex":null}},"env":{"widgetType":"text","name":"env","defaultValue":"02","label":"ADLS ENVIRONMENT","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980207224,"submitTime":1662980207174,"finishTime":1662980207258,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c0ebee35-3de8-4d5a-8523-19d41a9eb7b2"},{"version":"CommandV1","origId":2709619314155773,"guid":"560fedd4-46bd-4655-b68a-d01213c5cd3e","subtype":"command","commandType":"auto","position":2.0,"command":"print(\"basepath : \" + basepath)\nprint(\"FULL_LOAD : \" + FULL_LOAD)\nprint(\"pii_or_nonpii : \" + pii_or_nonpii)\nprint(\"manual_list : \" + manual_list_str)\nprint(\"db_name : \" + db_name)\nprint(\"segregated_loc : \" + segregated_loc)\nprint(\"staging_location : \" + staging_location)\nprint(\"curated_location : \" + curated_location)\nprint(\"curated_location_err : \" + curated_location_err)\nprint(\"execution_logs_loc : \" + execution_logs_loc)\nprint(\"metafilepath : \" + metafilepath)\nprint(\"tablecreationnbpath : \" + tablecreationnbpath)\nprint(\"dataprepnbpath : \" + dataprepnbpath)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">basepath : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/\nFULL_LOAD : No\npii_or_nonpii : nonpii\nmanual_list : ETTIFB\ndb_name : cods_nonprod_historical\nsegregated_loc : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/raw/ISU_archive/segregated\nstaging_location : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/raw/ISU_archive/segregated\ncurated_location : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/archive/FINAL\ncurated_location_err : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/archive/ERROR\nexecution_logs_loc : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/execution_logs/batch_logs\nmetafilepath : abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv\ntablecreationnbpath : /EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable\ndataprepnbpath : /EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662976578647,"submitTime":1662976578289,"finishTime":1662976578664,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",1015]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9afe196f-e6c9-45cd-973f-b600381d0d66"},{"version":"CommandV1","origId":2709619314155774,"guid":"4e6ff733-3159-4c62-b3b5-fb985758d812","subtype":"command","commandType":"auto","position":3.0,"command":"#START LOGGING\n\nimport logging\nimport datetime\n\nexecution_logs_loc2 = execution_logs_loc + \"/\"\n\n#ADD FOLDER IF NOT EXIST\ndbutils.fs.mkdirs(execution_logs_loc)\n\ncurrentutctime = datetime.datetime.now().strftime('%Y%m%d_%H%M%S')\nfilenamewithtime = \"EDA_\" + currentutctime +\".log\"\npartitions = datetime.datetime.now().strftime('%Y-%m-%d/')\n\ndbfslogbasepath = \"/tmp\" + \"/\" + filenamewithtime\n\n#TAG LOGGING INFO TO NOTEBOOK\nlogger = logging.getLogger('MasterNotebookOTL')\n\n#SETTING THRESHOLD OF LOGGER TO INFO\nlogger.setLevel(logging.INFO)\n\nFilehandler = logging.FileHandler(dbfslogbasepath,mode = 'a')\n\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\n\nlogger.addHandler(Filehandler)\n\n#LOG INFO\nlogger.info(\"Master NoteBook for History run started \")\nlogger.info(\"Input Parameters >>\")\nlogger.info(\"basepath : \" + basepath + \",\" + \"FULL_LOAD : \" + FULL_LOAD + \",\" + \"pii_or_nonpii : \" + pii_or_nonpii + \",\" + \"manual_list : \" + manual_list_str + \",\" + \"db_name : \" + db_name + \",\" + \"segregated_loc : \" + segregated_loc + \",\" + \"staging_location : \" + staging_location + \",\" + \"curated_location : \" + curated_location + \",\" + \"curated_location_err : \" + curated_location_err + \",\" + \"metafilepath : \" + metafilepath + \",\" + \"tablecreationnbpath : \" + tablecreationnbpath + \",\" + \"dataprepnbpath : \" + dataprepnbpath)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662976578666,"submitTime":1662976578317,"finishTime":1662976578846,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"33c9ad11-e7b3-4deb-8d95-397568ee3a0a"},{"version":"CommandV1","origId":2709619314155775,"guid":"41419013-573b-4422-8d7b-c652cd8fb4f3","subtype":"command","commandType":"auto","position":4.0,"command":"print(segregated_loc)\nfileloc = dbutils.fs.ls(segregated_loc)\n\n# LIST OF TABLES FROM DIRECTORY \ntablelist1 = list(map(lambda p: p.name[:-1].upper(), fileloc))\n\n# LIST OF ALL NONPII TABLES\nnonpiitablelist = ['CDHDR','CDPOS','DBERCHV','DBERCHZ1','DBERCHZ2','DBERCHZ3','DBERDL','DBERDLB','DFKKKO','DFKKOPK','DFKKOPKC','DFKKOPKX','DFKKZK','DFKKZPE','DFKKZPT','DFKKZS','EABL','EABLG','EMDUSDRQHEAD','EMDUSDRQINPUT','EMDUSDRQITEM','EMDUSDRQRESULT','ERCHC','ERCHO','ERDB','ERDO','ETTIFB','ETTIFN']\n\n# LIST OF ALL PII TABLES\npiitablelist = ['BCONT','DFKKCOLL','DFKKCOLLH','DFKKLOCKS','DFKKLOCKSH','DFKKOP','DFKKOPCOLL','DFKKOPW','DFKKZP','DFKKZV','ERCH','ERDK','FKKMACTIVITIES','FKKMAKO','FKKMAKT','FKKMAZE']\n\nif(pii_or_nonpii == 'nonpii'):\n    tablelist2 = nonpiitablelist\n    print(tablelist2)\nelif(pii_or_nonpii == 'pii'):\n    tablelist2 = piitablelist\n    print(tablelist2)\n\n# EFFECTIVE TABLE LIST\ntablelist = [value for value in tablelist1 if value in tablelist2]\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/raw/ISU_archive/segregated\n[&#39;CDHDR&#39;, &#39;CDPOS&#39;, &#39;DBERCHV&#39;, &#39;DBERCHZ1&#39;, &#39;DBERCHZ2&#39;, &#39;DBERCHZ3&#39;, &#39;DBERDL&#39;, &#39;DBERDLB&#39;, &#39;DFKKKO&#39;, &#39;DFKKOPK&#39;, &#39;DFKKOPKC&#39;, &#39;DFKKOPKX&#39;, &#39;DFKKZK&#39;, &#39;DFKKZPE&#39;, &#39;DFKKZPT&#39;, &#39;DFKKZS&#39;, &#39;EABL&#39;, &#39;EABLG&#39;, &#39;EMDUSDRQHEAD&#39;, &#39;EMDUSDRQINPUT&#39;, &#39;EMDUSDRQITEM&#39;, &#39;EMDUSDRQRESULT&#39;, &#39;ERCHC&#39;, &#39;ERCHO&#39;, &#39;ERDB&#39;, &#39;ERDO&#39;, &#39;ETTIFB&#39;, &#39;ETTIFN&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662976578848,"submitTime":1662976578383,"finishTime":1662976578939,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",641]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e81672e8-935b-4db2-9286-6e81e98a1bcb"},{"version":"CommandV1","origId":2709619314155776,"guid":"a24b345d-be1a-45e7-8f77-f5c1401e62f5","subtype":"command","commandType":"auto","position":5.0,"command":"# IF TABLE LIST IS ENTERED MANUALLY FROM WIDGET THEN USE MANUAL TABLE LIST ELSE USE AVAILABLE TABLES LIST \n\nif(manual_list):\n    tablelist = manual_list\n    print(tablelist) \n    #LOG INFO\n    logger.info(\"Tablelist for current execution : \" + str(tablelist))    \nelse:\n    tablelist\n    print(tablelist)\n    #LOG INFO\n    logger.info(\"Tablelist for current execution : \" + str(tablelist))    \n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&#39;ETTIFB&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662976578941,"submitTime":1662976578423,"finishTime":1662976578959,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",46]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5f800b0e-ed86-414e-8aeb-2d6b534a285d"},{"version":"CommandV1","origId":2709619314155777,"guid":"56910d91-1439-4750-962a-7c69db4dfca7","subtype":"command","commandType":"auto","position":6.0,"command":"# FOR ALL THE TABLES IN A LIST EXECUTE DATA PREPERATION FOLLOWED BY TABLE CREATION IN A LOOP\nlogger.info(\"----------------------------------------------------------------\")\n\ntry:  \n  for tablename in tablelist:\n    logger.info(\"Data Preperation Started for table : \" + tablename)\n    try:\n      dbutils.notebook.run(dataprepnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD , \"table_name\" : tablename , \"staging_location\" : staging_location , \"curated_location\" : curated_location , \"curated_location_err\" : curated_location_err , \"metafilepath\" : metafilepath , \"dbfslogbasepath\" : dbfslogbasepath })\n      logger.info(\"Data Preperation Completed for table : \" + tablename)\n    except:\n      logger.error(\"Error occurred while Executing Data Preparation\")\n      logger.critical(\"Master NoteBook for History run Failed!\")\n      #dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n    \n    logger.info(\"Table Creation Started for table : \" + tablename)  \n    try:\n      dbutils.notebook.run(tablecreationnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD , \"table_name\" : tablename , \"db_name\" : db_name , \"curated_location\" : curated_location , \"curated_location_err\" : curated_location_err , \"metafilepath\" : metafilepath , \"dbfslogbasepath\" : dbfslogbasepath })\n      logger.info(\"Table Creation Completed for table : \" + tablename)\n      logger.info(\"----------------------------------------------------------------\")\n    except:\n      logger.error(\"Error occurred while Executing Table Creation\")\n      logger.critical(\"Master NoteBook for History run Failed!\")\n      #dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n    print(\"DONE WITH TABLE : \" + tablename)\nexcept:\n  dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n","commandVersion":13,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DONE WITH TABLE : ETTIFB\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[{"jobId":214518938941232},{"jobId":106672322679022}],"startTime":1662976578961,"submitTime":1662976578454,"finishTime":1662976662100,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",52]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9f194ec4-7914-4b01-bf78-ba56e3f06b68"},{"version":"CommandV1","origId":2709619314155778,"guid":"78e3cbf9-9ef9-4b31-950b-0833df83a1cc","subtype":"command","commandType":"auto","position":7.0,"command":"#LOG INFO\nlogger.info(\"Master NoteBook for History run Completed Successfully!\")\n\n#MOVE LOG FILE TO ADLS LOCATION\ndbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[8]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662976662102,"submitTime":1662976578507,"finishTime":1662976662305,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",39]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"85ca2299-ea0d-4b39-9210-53ba15f3a55a"}],"dashboards":[],"guid":"36ef5e2f-30cf-44ac-ad42-4ccf5c97279e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location":{"nuid":"e21f97a6-da59-425c-82b3-7fd95af804b8","currentValue":"curated/ISU_archive/archive/FINAL","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"curated/ISU_archive/archive/FINAL","label":"CURATED LOC","options":{"widgetType":"text","validationRegex":null}}},"dataprepnbpath":{"nuid":"7e3c6f83-04a2-4118-a583-b741547c0b68","currentValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","widgetInfo":{"widgetType":"text","name":"dataprepnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Data Prepartion","label":"DATA PREP NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}}},"execution_logs_loc":{"nuid":"01c618d2-7294-49e4-aaf5-6d5439607562","currentValue":"ISU_archive_support/execution_logs/batch_logs","widgetInfo":{"widgetType":"text","name":"execution_logs_loc","defaultValue":"ISU_archive_support/execution_logs/batch_logs","label":"EXECUTION LOGS LOC","options":{"widgetType":"text","validationRegex":null}}},"tablecreationnbpath":{"nuid":"e553f92f-de56-4328-b0ef-0290e8f801a0","currentValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","widgetInfo":{"widgetType":"text","name":"tablecreationnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_OTL/STD Dynamic Table Creation Using MetaTable","label":"TABLE CREATION NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}}},"db_name":{"nuid":"3c691d47-4126-4de9-8078-b40e3fa54053","currentValue":"cods_nonprod_historical","widgetInfo":{"widgetType":"text","name":"db_name","defaultValue":"cods_nonprod_historical","label":"DATABASE NAME","options":{"widgetType":"text","validationRegex":null}}},"pii_or_nonpii":{"nuid":"04601312-d0a7-482d-9a1f-e0f194a5801a","currentValue":"nonpii","widgetInfo":{"widgetType":"text","name":"pii_or_nonpii","defaultValue":"nonpii","label":"TABLE PREFERENCE( NONPII/PII)","options":{"widgetType":"text","validationRegex":null}}},"manual_list_str":{"nuid":"920c581b-af40-4cbe-8be2-aaef47563f81","currentValue":"","widgetInfo":{"widgetType":"text","name":"manual_list_str","defaultValue":"","label":"MANUAL TABLE LIST","options":{"widgetType":"text","validationRegex":null}}},"curated_location_err":{"nuid":"64beb1e6-df50-44bd-8fef-f065c192b975","currentValue":"curated/ISU_archive/archive/ERROR","widgetInfo":{"widgetType":"text","name":"curated_location_err","defaultValue":"curated/ISU_archive/archive/ERROR","label":"CURATED LOC ERROR","options":{"widgetType":"text","validationRegex":null}}},"metaadlspath":{"nuid":"3d9c1bd1-624a-4875-8643-3898f7c67daa","currentValue":"ISU_archive_support/metadata/Final_metadata.csv","widgetInfo":{"widgetType":"text","name":"metaadlspath","defaultValue":"ISU_archive_support/metadata/Final_metadata.csv","label":"METADATA FILE LOC","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"fdd77c63-d88a-474f-ad64-df012b7db567","currentValue":"No","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"segregated_loc":{"nuid":"4c7946c2-9529-4da3-8dc7-4e004b3f89a9","currentValue":"raw/ISU_archive/segregated","widgetInfo":{"widgetType":"text","name":"segregated_loc","defaultValue":"raw/ISU_archive/segregated","label":"SEGREGATED LOC","options":{"widgetType":"text","validationRegex":null}}},"env":{"nuid":"24f6eada-e682-4c45-ae5d-052fc107dd26","currentValue":"02","widgetInfo":{"widgetType":"text","name":"env","defaultValue":"02","label":"ADLS ENVIRONMENT","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}