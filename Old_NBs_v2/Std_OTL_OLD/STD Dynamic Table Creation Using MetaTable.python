{"version":"NotebookV1","origId":2709619314155779,"name":"STD Dynamic Table Creation Using MetaTable","language":"python","commands":[{"version":"CommandV1","origId":2709619314155780,"guid":"737878b7-7789-4044-a61c-b6d6d36729e6","subtype":"command","commandType":"auto","position":0.5,"command":"#%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915655015,"submitTime":1660915655015,"finishTime":1660915666581,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a148ab1d-dd46-4b99-8e29-522b88bf62a6"},{"version":"CommandV1","origId":2709619314155781,"guid":"ccca96a4-f506-46ce-b051-41e86fc005ce","subtype":"script","commandType":"auto","position":0.5588235294117647,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c76bc472-f9e1-4d28-8a1e-2907938e7a9d"},{"version":"CommandV1","origId":2709619314155782,"guid":"2260726d-935e-47dd-955e-565407d1a87a","subtype":"script","commandType":"auto","position":0.6176470588235294,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["db_name","curated_location","table_name","curated_location_err"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915655881,"submitTime":0,"finishTime":1660915655907,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"408d3751-a8fe-4d10-863e-a612fd2c25cb"},{"version":"CommandV1","origId":2709619314155783,"guid":"7d67a8ba-ca3b-43ae-b954-fa832a5630c4","subtype":"script","commandType":"auto","position":0.6764705882352942,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915655913,"submitTime":0,"finishTime":1660915655927,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"610f2271-c0b4-478e-9177-81b4fb820cdc"},{"version":"CommandV1","origId":2709619314155784,"guid":"06f135ed-bd4c-4270-87cc-b61295af07ef","subtype":"script","commandType":"auto","position":0.7352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3dec7dcd-02ab-4cf9-8307-98a0804e28cf"},{"version":"CommandV1","origId":2709619314155785,"guid":"1b4c2f30-2c9a-4252-ad3d-046a18f4ed19","subtype":"script","commandType":"auto","position":0.7941176470588236,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915655936,"submitTime":0,"finishTime":1660915656032,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1eb0be3-4eb5-4b26-9e34-3cdd1c9416ae"},{"version":"CommandV1","origId":2709619314155786,"guid":"53a4f4ac-de50-442f-8455-82acc28bb736","subtype":"script","commandType":"auto","position":0.8529411764705883,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915656039,"submitTime":0,"finishTime":1660915656070,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7515cb8a-2390-433d-82f9-f08339428da9"},{"version":"CommandV1","origId":2709619314155787,"guid":"54799cd3-dbad-4cf4-bf52-26219a0a3cfc","subtype":"script","commandType":"auto","position":0.9117647058823529,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915656076,"submitTime":0,"finishTime":1660915663607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7acbc3bf-56f6-453e-87c5-205bd5d7c3a9"},{"version":"CommandV1","origId":2709619314155788,"guid":"c26b584e-6afc-4530-882a-b8406f4ad2a1","subtype":"script","commandType":"auto","position":0.9705882352941176,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915663613,"submitTime":0,"finishTime":1660915663815,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a76313e7-cc6d-4bd4-ab37-d2803b38013a"},{"version":"CommandV1","origId":2709619314155789,"guid":"54c63798-9669-46b0-a182-4c0748da5c23","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.functions import *","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915666307,"submitTime":1660915655132,"finishTime":1660915666328,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7cc538c5-31ff-49f3-bee2-1635baa6633f"},{"version":"CommandV1","origId":2709619314155790,"guid":"267769a2-7768-4aae-85a5-61f89149058f","subtype":"script","commandType":"auto","position":1.0294117647058822,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915663826,"submitTime":0,"finishTime":1660915665358,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9642f7c-8f2f-4c94-ae2a-90b8853a20db"},{"version":"CommandV1","origId":2709619314155791,"guid":"79c72b71-a0f4-4582-ac0e-f7fb4f4e14be","subtype":"script","commandType":"auto","position":1.0882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ab037e98-0a1a-4d5d-9f80-f35377c2d64c"},{"version":"CommandV1","origId":2709619314155792,"guid":"2b4d8f5e-2d09-4cf4-ab85-ac9e3e70c9d8","subtype":"script","commandType":"auto","position":1.1470588235294117,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915665365,"submitTime":0,"finishTime":1660915665711,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a16ee1f2-423d-4b40-b5ec-530a2f1553e1"},{"version":"CommandV1","origId":2709619314155793,"guid":"086b26e5-aa8e-4f14-8142-3550be701acb","subtype":"script","commandType":"auto","position":1.2058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"062a7e7a-4ef8-4240-b425-cb4c4364a870"},{"version":"CommandV1","origId":2709619314155794,"guid":"a0cad817-dbcc-4678-8b17-c075984b8f23","subtype":"script","commandType":"auto","position":1.2647058823529411,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915665721,"submitTime":0,"finishTime":1660915666182,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"022c4015-c3c4-4d32-9615-feb025f59161"},{"version":"CommandV1","origId":2709619314155795,"guid":"33b51e91-55b1-4d7f-99e9-560b9a8db2f0","subtype":"script","commandType":"auto","position":1.3235294117647058,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b34c4ab9-29dc-4f9f-9e05-a13cbf3cd726"},{"version":"CommandV1","origId":2709619314155796,"guid":"2d8fd55c-fd2f-4ee1-a22e-c373db28bfbc","subtype":"script","commandType":"auto","position":1.3823529411764706,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915666188,"submitTime":0,"finishTime":1660915666210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5db8ed30-a618-4226-b742-90c474c075ce"},{"version":"CommandV1","origId":2709619314155797,"guid":"3938184e-f102-4a22-8298-611bbe05a128","subtype":"script","commandType":"auto","position":1.4411764705882353,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660915666219,"submitTime":0,"finishTime":1660915666300,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["737878b7-7789-4044-a61c-b6d6d36729e6"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6f8438f1-e915-463c-8eb3-5ea987856b0b"},{"version":"CommandV1","origId":2709619314155798,"guid":"76a67699-500e-4b5b-a592-1fcfb0ef5aed","subtype":"command","commandType":"auto","position":2.0,"command":"dbutils.widgets.text(\"table_name\", \"\", \"table name\")\ntable_name = dbutils.widgets.get(\"table_name\")\n\ndbutils.widgets.text(\"db_name\", \"\", \"db name\")\ndb_name = dbutils.widgets.get(\"db_name\")\n\n#SET METADATA FILEPATH in ADLS (For Example = abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv)\ndbutils.widgets.text(\"metafilepath\", \"\", \"METADATA FILEPATH\")\nmetafilepath = dbutils.widgets.get(\"metafilepath\")\n\ndbutils.widgets.text(\"curated_location\", \"\", \"curated location\")\ncurated_location = \"'\" + dbutils.widgets.get(\"curated_location\") + \"/\" + table_name + \"/'\"\n\n# Curated location for Error Table\ndbutils.widgets.text(\"curated_location_err\", \"\", \"curated location for error table\")\ncurated_location_err = \"'\" + dbutils.widgets.get(\"curated_location_err\") + \"/\" + table_name + \"/'\"\n\n# Set FULL_LOAD param with Yes/No\ndbutils.widgets.text(\"FULL_LOAD\", \"No\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")\n\n# Set DBFS log file path\ndbutils.widgets.text(\"dbfslogbasepath\", \"\", \"DBFS LOG FILE PATH\")\ndbfslogbasepath = dbutils.widgets.get(\"dbfslogbasepath\")","commandVersion":62,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"curated_location":"","table_name":"","metafilepath":"","dbfslogbasepath":"","db_name":"","curated_location_err":"","FULL_LOAD":"No"},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}},"table_name":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}},"metafilepath":{"widgetType":"text","name":"metafilepath","defaultValue":"","label":"METADATA FILEPATH","options":{"widgetType":"text","validationRegex":null}},"dbfslogbasepath":{"widgetType":"text","name":"dbfslogbasepath","defaultValue":"","label":"DBFS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}},"db_name":{"widgetType":"text","name":"db_name","defaultValue":"","label":"db name","options":{"widgetType":"text","validationRegex":null}},"curated_location_err":{"widgetType":"text","name":"curated_location_err","defaultValue":"","label":"curated location for error table","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662535931720,"submitTime":1662535929154,"finishTime":1662535931747,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"402bee3c-3da1-45e4-9e40-dedeecca86fb"},{"version":"CommandV1","origId":2709619314155799,"guid":"a829f140-12d4-44da-bb75-2ec787d83b9a","subtype":"command","commandType":"auto","position":2.5,"command":"print(table_name)","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DBERCHZ1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661195065192,"submitTime":1661195065148,"finishTime":1661195065210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",36]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2ac39c2e-0623-4860-b6c8-19519a5c7287"},{"version":"CommandV1","origId":2709619314155800,"guid":"747e7c02-953b-4e72-8143-d3fb0837c230","subtype":"command","commandType":"auto","position":2.75,"command":"#START LOGGING\n\nimport logging\nimport datetime\n\n#TAG LOGGING INFO TO NOTEBOOK\nlogger = logging.getLogger('TableCreationNotebook')\n\n#SETTING THRESHOLD OF LOGGER TO INFO\nlogger.setLevel(logging.INFO)\n\nFilehandler = logging.FileHandler(dbfslogbasepath,mode = 'a')\n\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\n\nlogger.addHandler(Filehandler)\n\n#LOG INFO\nlogger.info(\"TableCreation is Running... \")","commandVersion":9,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"82319929-c12a-4ec3-bf6d-0dc442fadb45"},{"version":"CommandV1","origId":2709619314155801,"guid":"c6078c7b-5ce4-46a0-ac9f-be9f89bcbc3d","subtype":"command","commandType":"auto","position":3.0,"command":"%run \"../Metadata/Load_Metadata\"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662028799788,"submitTime":1662028799788,"finishTime":1662028800349,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d00966c3-d2eb-476a-8761-434375a79fe9"},{"version":"CommandV1","origId":2709619314155802,"guid":"9cd9a675-cd3f-46b4-a5aa-30a64f1ea72a","subtype":"script","commandType":"auto","position":3.25,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662028799893,"submitTime":0,"finishTime":1662028799903,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c6078c7b-5ce4-46a0-ac9f-be9f89bcbc3d"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c72dfa99-5a5d-4e02-9824-1b5323724f9e"},{"version":"CommandV1","origId":2709619314155803,"guid":"25e08d0f-8e19-4700-baee-c27c0bce06ae","subtype":"script","commandType":"auto","position":3.5,"command":"","commandVersion":40,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662028799910,"submitTime":0,"finishTime":1662028799926,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c6078c7b-5ce4-46a0-ac9f-be9f89bcbc3d"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b79b8f9b-d062-4fd3-b310-8342a785c7a0"},{"version":"CommandV1","origId":2709619314155804,"guid":"b22b7b13-6234-4c8b-a096-7664d18d59fc","subtype":"script","commandType":"auto","position":3.75,"command":"","commandVersion":104,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Your Metadata dataframe is loaded\nUse following syntax to grab it\n &lt;new dataframe&gt; = load_metadata_df(&lt;path of metadata csv&gt;) \n\n\nNOTE : csv path parameter is optional as Functions uses default path\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662028799929,"submitTime":0,"finishTime":1662028799939,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c6078c7b-5ce4-46a0-ac9f-be9f89bcbc3d"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1beb3524-a0fc-41a8-b8e2-72722bf751f1"},{"version":"CommandV1","origId":2709619314155805,"guid":"64707375-9f4e-4f6d-99f4-3566f7dc6962","subtype":"command","commandType":"auto","position":4.0,"command":"metadf = load_metadata_df(metafilepath)","commandVersion":22,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"metadf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662028888976,"submitTime":1662028888932,"finishTime":1662028889702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1684","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ea9eb12c-c8ce-484e-a6a5-be8d1991963d"},{"version":"CommandV1","origId":2709619314155806,"guid":"2401eb5f-ab2f-4c03-9bd4-3a5b5bd3f7a6","subtype":"command","commandType":"auto","position":5.0,"command":"with_reqd_col_DF = metadf.select(\"*\").where(col(\"Table_Name\") == table_name )","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"with_reqd_col_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661195089209,"submitTime":1661195089165,"finishTime":1661195089247,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d9a45ac4-5aa6-4e3b-bca0-3ed41d5e0fa1"},{"version":"CommandV1","origId":2709619314155807,"guid":"caa7a7fa-4ba6-4ec0-8b6f-02a0ac00b1b9","subtype":"command","commandType":"auto","position":6.5,"command":"# FUNCTION TO GENERATE TABLE SCHEMA DYNAMICALLY BASED ON METADATA CSV\n\ndef generate_schema(column_name,types_name,comment,M_DF):\n    columns_list = M_DF.select(column_name).rdd.map(lambda x : x[0]).collect()\n    types_list = M_DF.select(types_name).rdd.map(lambda x : x[0]).collect()\n    col1 =\"(\"\n    col2 =\"\"\n    for i,j in zip(columns_list,types_list):\n        col1 = col1 + \" \" + i + \" \" + j + \" \" + ', '\n    partition_check = M_DF.select(\"Field_Name\").where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n    if partition_check:\n        return col1 + \"partitioncol STRING, EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \"\n    else:\n        return col1 + \"EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \"","commandVersion":29,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661195097631,"submitTime":1661195097588,"finishTime":1661195097654,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1f964b54-24bf-44f1-ae40-fd3e19b115cb"},{"version":"CommandV1","origId":2709619314155808,"guid":"3259a49f-faab-4abb-95f8-c6a73b4fea5d","subtype":"command","commandType":"auto","position":6.75,"command":"# CALL GENERATE_SCHEMA FUNCTION BY PASSING ARGUMENTS\n\ntry:\n    getschema = generate_schema(\"Field_Name\",\"delta_types\",\"Description\",with_reqd_col_DF)\n    print(getschema)\n    logger.info(\"Generate Table Schema succeeded : refer cmd 10\")\nexcept:\n    logger.error(\"Generate Table Schema FAILED : refer cmd 10\")\n\n","commandVersion":44,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">( MANDT STRING ,  BELNR STRING ,  BELZEILE int ,  CSNO int ,  BELZART STRING ,  ABSLKZ STRING ,  DIFFKZ STRING ,  BUCHREL STRING ,  MENGESTREL STRING ,  BETRSTREL STRING ,  STGRQNT STRING ,  STGRAMT STRING ,  PRINTREL STRING ,  AKLASSE STRING ,  BRANCHE STRING ,  TVORG STRING ,  GEGEN_TVORG STRING ,  TAX_TVORG STRING ,  LINESORT STRING ,  AB STRING ,  BIS STRING ,  TIMTYPZA STRING ,  SCHEMANR STRING ,  SNO int ,  PROGRAMM STRING ,  MASSBILL STRING ,  SAISON STRING ,  TIMBASIS STRING ,  TIMTYP STRING ,  FRAN_TYPE STRING ,  KONZIGR STRING ,  TARIFTYP STRING ,  TARIFNR STRING ,  KONDIGR STRING ,  STTARIF STRING ,  GEWKEY STRING ,  WDHFAKT double ,  TEMP_AREA STRING ,  DRCKSTUF STRING ,  ABGGRND1 STRING ,  ABGGRND2 STRING ,  ABGGRND3 STRING ,  ABGGRND4 STRING ,  ABGGRND5 STRING ,  ABGGRND6 STRING ,  ABGGRND7 STRING ,  ABGGRND8 STRING ,  ABGGRND9 STRING ,  ABGGRND10 STRING ,  EIN01 STRING ,  EIN02 STRING ,  EIN03 STRING ,  EIN04 STRING ,  AUS01 STRING ,  AUS02 STRING ,  MASS1 STRING ,  MASS2 STRING ,  MASS3 STRING ,  MASS4 STRING ,  DATUM1 STRING ,  DATUM2 STRING ,  RABZUS STRING ,  BACKCANC01 STRING ,  BACKCANC02 STRING ,  BACKCANC03 STRING ,  BACKCANC04 STRING ,  BACKCANC05 STRING ,  BACKCANC STRING ,  BACKEXEC STRING ,  BACKDOCNO STRING ,  BACKDOCLINE int ,  DYNCANC01 STRING ,  DYNCANC02 STRING ,  DYNCANC03 STRING ,  DYNCANC04 STRING ,  DYNCANC05 STRING ,  DYNCANC STRING ,  DYNEXEC STRING ,  LRATESTEP int ,  PEB STRING ,  OPLFDNR int ,  STAFO STRING ,  ARTMENGE STRING ,  STATTART STRING ,  TIMECONTRL STRING ,  TCNUMTOR double ,  TCDENOMTOR double ,  TIMTYPQUOT STRING ,  AKTIV STRING ,  KONZVER STRING ,  PERTYP STRING ,  ERCHV_ANCHOR STRING ,  OUCONTRACT STRING ,  V_ABRMENGE double ,  N_ABRMENGE double ,  V_ZAHL1 double ,  N_ZAHL1 double ,  V_ZAHL2 double ,  N_ZAHL2 double ,  V_ZAHL3 double ,  N_ZAHL3 double ,  V_ZAHL4 double ,  N_ZAHL4 double ,  V_ZEITANT double ,  N_ZEITANT double , partitioncol STRING, EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661195112241,"submitTime":1661195112198,"finishTime":1661195112864,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",2013]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bf5d6ade-155e-4b6f-80bf-a0cbf7dec897"},{"version":"CommandV1","origId":2709619314155809,"guid":"506f8793-42fe-4668-a3c9-0f831f8a17c1","subtype":"command","commandType":"auto","position":8.0,"command":"try:\n    main_table = 'ISU_' + table_name + '_archive'\n    erroneous_table = 'ISU_' + table_name + '_arc_err'\n    \n    if(str(FULL_LOAD) == 'Yes'):\n        spark.sql(f\"\"\" DROP TABLE IF EXISTS {db_name}.{main_table} \"\"\")\n        spark.sql(f\"\"\" DROP TABLE IF EXISTS {db_name}.{erroneous_table} \"\"\")\n    \n    spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{main_table} {getschema} USING DELTA LOCATION {curated_location} \"\"\")\n    spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{erroneous_table} {getschema} USING DELTA LOCATION {curated_location_err} \"\"\")\nexcept:\n    logger.error(\"Create/Drop Table FAILED : refer cmd 11\")","commandVersion":95,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[10]: DataFrame[]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661195174465,"submitTime":1661195174420,"finishTime":1661195174667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",47]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0a0a8034-d280-4c4e-8166-3709f883944a"}],"dashboards":[],"guid":"b3b978bb-a445-4100-a914-7fa7d70b1240","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location":{"nuid":"881dd8c8-0568-40b3-992f-4d0bad9e5b7b","currentValue":"","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}}},"table_name":{"nuid":"07d73018-f0d6-4da6-8de2-f7ece67ebbca","currentValue":"","widgetInfo":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}},"metafilepath":{"nuid":"3f236491-2d67-4d5b-9be6-96933c9ea04f","currentValue":"","widgetInfo":{"widgetType":"text","name":"metafilepath","defaultValue":"","label":"METADATA FILEPATH","options":{"widgetType":"text","validationRegex":null}}},"dbfslogbasepath":{"nuid":"08fe365e-e651-46ac-be25-e678a7609203","currentValue":"","widgetInfo":{"widgetType":"text","name":"dbfslogbasepath","defaultValue":"","label":"DBFS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}}},"db_name":{"nuid":"6a72d27d-7f3e-4d1d-a84b-b9f336c60208","currentValue":"","widgetInfo":{"widgetType":"text","name":"db_name","defaultValue":"","label":"db name","options":{"widgetType":"text","validationRegex":null}}},"curated_location_err":{"nuid":"3b3bd77c-9139-4fa0-a958-f6cfe1ab0724","currentValue":"","widgetInfo":{"widgetType":"text","name":"curated_location_err","defaultValue":"","label":"curated location for error table","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"956a636c-cb45-4e7c-98cd-ed302f5566e8","currentValue":"No","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}