{"version":"NotebookV1","origId":2709619314155810,"name":"STD Data Prepartion","language":"python","commands":[{"version":"CommandV1","origId":2709619314155811,"guid":"230ccfbd-7bc2-466b-b599-fb323fc165e8","subtype":"command","commandType":"auto","position":0.5,"command":"#%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"html","error":null,"workflows":[],"startTime":1661190801592,"submitTime":1661190801592,"finishTime":1661190814238,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dd5b5f0e-f28c-482f-bd9c-544c4588b32c"},{"version":"CommandV1","origId":2709619314155812,"guid":"93223747-7ea6-4db6-8007-3e1f8d507be6","subtype":"script","commandType":"auto","position":0.5588235294117647,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c76bc472-f9e1-4d28-8a1e-2907938e7a9d"},{"version":"CommandV1","origId":2709619314155813,"guid":"72ad0be3-e262-4bef-b085-fa151846b3d9","subtype":"script","commandType":"auto","position":0.6176470588235294,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["curated_location","staging_location","FULL_LOAD","table_name","curated_location_err"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190802838,"submitTime":0,"finishTime":1661190802862,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"408d3751-a8fe-4d10-863e-a612fd2c25cb"},{"version":"CommandV1","origId":2709619314155814,"guid":"cfb562e7-eb30-47ca-a009-1ea75b6bf1ac","subtype":"script","commandType":"auto","position":0.6764705882352942,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190802871,"submitTime":0,"finishTime":1661190802892,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"610f2271-c0b4-478e-9177-81b4fb820cdc"},{"version":"CommandV1","origId":2709619314155815,"guid":"e1692c07-e5b9-4b3d-9c14-d451fd324848","subtype":"script","commandType":"auto","position":0.7352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3dec7dcd-02ab-4cf9-8307-98a0804e28cf"},{"version":"CommandV1","origId":2709619314155816,"guid":"05c9a758-6fc0-430c-9f5d-63c2f25a2bf3","subtype":"script","commandType":"auto","position":0.7941176470588236,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190802904,"submitTime":0,"finishTime":1661190803027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1eb0be3-4eb5-4b26-9e34-3cdd1c9416ae"},{"version":"CommandV1","origId":2709619314155817,"guid":"3b22ca89-9d46-4335-b663-4e6585cbef93","subtype":"script","commandType":"auto","position":0.8529411764705883,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190803035,"submitTime":0,"finishTime":1661190803073,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7515cb8a-2390-433d-82f9-f08339428da9"},{"version":"CommandV1","origId":2709619314155818,"guid":"645ea4c9-4b45-4b54-845c-cfe981d54ed4","subtype":"script","commandType":"auto","position":0.9117647058823529,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190803086,"submitTime":0,"finishTime":1661190810638,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7acbc3bf-56f6-453e-87c5-205bd5d7c3a9"},{"version":"CommandV1","origId":2709619314155819,"guid":"30d02e52-4246-4470-982b-65f55263d5e8","subtype":"script","commandType":"auto","position":0.9705882352941176,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190810646,"submitTime":0,"finishTime":1661190811016,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a76313e7-cc6d-4bd4-ab37-d2803b38013a"},{"version":"CommandV1","origId":2709619314155820,"guid":"44a564dc-bd4a-4cdf-888d-9719e258e84f","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.window import Window\nimport fnmatch","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190813964,"submitTime":1661190801661,"finishTime":1661190813982,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"82a2a2df-ebf6-4972-8034-638905709b42"},{"version":"CommandV1","origId":2709619314155821,"guid":"6cbb3b07-ff4b-4be7-a2ea-f72f5bc70c71","subtype":"script","commandType":"auto","position":1.0294117647058822,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190811029,"submitTime":0,"finishTime":1661190811356,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6765","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9642f7c-8f2f-4c94-ae2a-90b8853a20db"},{"version":"CommandV1","origId":2709619314155822,"guid":"be33dc82-87cf-4b65-86f5-765a1e936765","subtype":"script","commandType":"auto","position":1.0882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ab037e98-0a1a-4d5d-9f80-f35377c2d64c"},{"version":"CommandV1","origId":2709619314155823,"guid":"5ee877b8-f145-41b3-8ba8-ccc95d732f6c","subtype":"script","commandType":"auto","position":1.1470588235294117,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190811366,"submitTime":0,"finishTime":1661190811796,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6765","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a16ee1f2-423d-4b40-b5ec-530a2f1553e1"},{"version":"CommandV1","origId":2709619314155824,"guid":"9bc6b8da-dcaa-47d7-ac84-2ef3ddf113c5","subtype":"script","commandType":"auto","position":1.2058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"062a7e7a-4ef8-4240-b425-cb4c4364a870"},{"version":"CommandV1","origId":2709619314155825,"guid":"1162e2c8-1fa8-409e-a048-41b21101d507","subtype":"script","commandType":"auto","position":1.2647058823529411,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190811810,"submitTime":0,"finishTime":1661190813774,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3951","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"022c4015-c3c4-4d32-9615-feb025f59161"},{"version":"CommandV1","origId":2709619314155826,"guid":"89fb935a-a960-4d23-8c07-36b057932fc2","subtype":"script","commandType":"auto","position":1.3235294117647058,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b34c4ab9-29dc-4f9f-9e05-a13cbf3cd726"},{"version":"CommandV1","origId":2709619314155827,"guid":"8fb1a823-59ea-4bec-8fd5-766a8696bec2","subtype":"script","commandType":"auto","position":1.3823529411764706,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190813784,"submitTime":0,"finishTime":1661190813818,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5db8ed30-a618-4226-b742-90c474c075ce"},{"version":"CommandV1","origId":2709619314155828,"guid":"6cfdf478-b679-4adb-aefb-a4681df952c5","subtype":"script","commandType":"auto","position":1.4411764705882353,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190813832,"submitTime":0,"finishTime":1661190813955,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["230ccfbd-7bc2-466b-b599-fb323fc165e8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6f8438f1-e915-463c-8eb3-5ea987856b0b"},{"version":"CommandV1","origId":2709619314155829,"guid":"08c179b5-2c6c-45d7-b1c0-d68e4afd3cba","subtype":"command","commandType":"auto","position":2.0,"command":"# Table Name\ndbutils.widgets.text(\"table_name\", \"\", \"table name\")\ntable_name = dbutils.widgets.get(\"table_name\")\n\n#SET METADATA FILEPATH in ADLS (For Example = abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv)\ndbutils.widgets.text(\"metafilepath\", \"\", \"METADATA FILEPATH\")\nmetafilepath = dbutils.widgets.get(\"metafilepath\")\n\n# Staging location ( source here )\ndbutils.widgets.text(\"staging_location\", \"\", \"staging location\")\nstaging_location = \"'\" + dbutils.widgets.get(\"staging_location\") + \"/\" + table_name + \"/'\"\n\n# Curated location ( destination here )\ndbutils.widgets.text(\"curated_location\", \"\", \"curated location\")\ncurated_location = \"'\" + dbutils.widgets.get(\"curated_location\") + \"/\" + table_name + \"/'\"\n\n# Curated location for Error Table\ndbutils.widgets.text(\"curated_location_err\", \"\", \"curated location for error table\")\ncurated_location_err = \"'\" + dbutils.widgets.get(\"curated_location_err\") + \"/\" + table_name + \"/'\"\n\n# Set FULL_LOAD param with Yes/No\ndbutils.widgets.text(\"FULL_LOAD\", \"No\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")\n\n# Set DBFS log file path\ndbutils.widgets.text(\"dbfslogbasepath\", \"\", \"DBFS LOG FILE PATH\")\ndbfslogbasepath = dbutils.widgets.get(\"dbfslogbasepath\")\n","commandVersion":52,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"curated_location":"","table_name":"","metafilepath":"","dbfslogbasepath":"","staging_location":"","curated_location_err":"","FULL_LOAD":""},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}},"table_name":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}},"metafilepath":{"widgetType":"text","name":"metafilepath","defaultValue":"","label":"METADATA FILEPATH","options":{"widgetType":"text","validationRegex":null}},"dbfslogbasepath":{"widgetType":"text","name":"dbfslogbasepath","defaultValue":"","label":"DBFS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}},"staging_location":{"widgetType":"text","name":"staging_location","defaultValue":"","label":"staging location","options":{"widgetType":"text","validationRegex":null}},"curated_location_err":{"widgetType":"text","name":"curated_location_err","defaultValue":"","label":"curated location for error table","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662534523478,"submitTime":1662534518374,"finishTime":1662534523544,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"accfde7f-5757-4038-8c57-e4121103c58c"},{"version":"CommandV1","origId":2709619314155830,"guid":"812ce936-c859-4378-add1-203d7d9f88af","subtype":"command","commandType":"auto","position":2.5,"command":"print(table_name)\nprint(metafilepath)\nprint(staging_location)\nprint(curated_location)\nprint(curated_location_err)","commandVersion":20,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">\nabfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv\n&#39;//&#39;\n&#39;//&#39;\n&#39;//&#39;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662029065368,"submitTime":1662029065320,"finishTime":1662029065388,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",166]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"00b192ae-de8d-4145-bcf6-c1f76c76b53d"},{"version":"CommandV1","origId":2709619314155831,"guid":"e54af774-7520-4e7f-bfff-909512f2e982","subtype":"command","commandType":"auto","position":2.75,"command":"#START LOGGING\n\nimport logging\nimport datetime\n\n#dbfslogbasepath = \"/tmp\" + \"/\" + filenamewithtime\n\n#TAG LOGGING INFO TO NOTEBOOK\nlogger = logging.getLogger('DataPreparationNotebook')\n\n#SETTING THRESHOLD OF LOGGER TO INFO\nlogger.setLevel(logging.INFO)\n\nFilehandler = logging.FileHandler(dbfslogbasepath,mode = 'a')\n\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\n\nlogger.addHandler(Filehandler)\n\n#LOG INFO\nlogger.info(\"DataPreparation is Running... \")","commandVersion":24,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f96aa66c-bc79-43df-a3d4-1ee620beaef0"},{"version":"CommandV1","origId":2709619314155832,"guid":"f79aabe5-5046-4d2b-9644-62f693729701","subtype":"command","commandType":"auto","position":3.0,"command":"try:\n    s = 'newdf = spark.read.format(\"csv\").option(\"delimiter\", \"|\").option(\"header\",\"true\").option(\"inferSchema\",\"true\").load(' + staging_location + ')'\n    print(s)\n    exec(s)\n    logger.info(\"Reading datafiles from segregated location succeeded : refer cmd 6\")\nexcept:\n    logger.error(\"Reading datafiles from segregated location FAILED : refer cmd 6\")\n\n","commandVersion":68,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">newdf = spark.read.format(&#34;csv&#34;).option(&#34;delimiter&#34;, &#34;|&#34;).option(&#34;header&#34;,&#34;true&#34;).option(&#34;inferSchema&#34;,&#34;true&#34;).load(&#39;abfss://dev@[REDACTED].dfs.core.windows.net/raw/ISU_archive/segregated/DBERCHZ1/&#39;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"newdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"DBERCHZ1-MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BELZEILE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-CSNO","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-AB","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BIS","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-SNO","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-WDHFAKT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-BACKDOCLINE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-LRATESTEP","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-PEB","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-OPLFDNR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TCNUMTOR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TCDENOMTOR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-V_ABRMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-N_ABRMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-V_ZAHL1","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-N_ZAHL1","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-V_ZAHL2","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-N_ZAHL2","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-V_ZAHL3","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-N_ZAHL3","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-V_ZAHL4","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-N_ZAHL4","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-V_ZEITANT","nullable":true,"type":"string"},{"metadata":{},"name":"DBERCHZ1-N_ZEITANT","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190814045,"submitTime":1661190801770,"finishTime":1661190826224,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",291]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"420df8a0-75ee-4893-b81b-839fe1f027f4"},{"version":"CommandV1","origId":2709619314155833,"guid":"237831c0-ed05-4c6e-bee1-b87ec0028902","subtype":"command","commandType":"auto","position":5.0,"command":"# FUNCTION TO CLEAN HEADER WITH PROPER COLUMN NAMES FROM DATAFRAME\n\ndef revisit_header(df=newdf,table_n=table_name):\n    if fnmatch.fnmatch(df.columns[0],table_n + \"*\") == True:\n        for i in df.columns:\n            df = df.withColumnRenamed(i, i[len(table_n)+1:])\n        print(df.columns)\n        return df\n    else:\n        return df","commandVersion":58,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190826267,"submitTime":1661190801802,"finishTime":1661190826287,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fedadbc3-1904-4d4d-b9f6-3c2bf17fdb87"},{"version":"CommandV1","origId":2709619314155834,"guid":"6f76a90f-2c33-4068-b0e7-0f4d1da21b74","subtype":"command","commandType":"auto","position":6.0,"command":"newdf = revisit_header()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&#39;MANDT&#39;, &#39;BELNR&#39;, &#39;BELZEILE&#39;, &#39;CSNO&#39;, &#39;BELZART&#39;, &#39;ABSLKZ&#39;, &#39;DIFFKZ&#39;, &#39;BUCHREL&#39;, &#39;MENGESTREL&#39;, &#39;BETRSTREL&#39;, &#39;STGRQNT&#39;, &#39;STGRAMT&#39;, &#39;PRINTREL&#39;, &#39;AKLASSE&#39;, &#39;BRANCHE&#39;, &#39;TVORG&#39;, &#39;GEGEN_TVORG&#39;, &#39;TAX_TVORG&#39;, &#39;LINESORT&#39;, &#39;AB&#39;, &#39;BIS&#39;, &#39;TIMTYPZA&#39;, &#39;SCHEMANR&#39;, &#39;SNO&#39;, &#39;PROGRAMM&#39;, &#39;MASSBILL&#39;, &#39;SAISON&#39;, &#39;TIMBASIS&#39;, &#39;TIMTYP&#39;, &#39;FRAN_TYPE&#39;, &#39;KONZIGR&#39;, &#39;TARIFTYP&#39;, &#39;TARIFNR&#39;, &#39;KONDIGR&#39;, &#39;STTARIF&#39;, &#39;GEWKEY&#39;, &#39;WDHFAKT&#39;, &#39;TEMP_AREA&#39;, &#39;DRCKSTUF&#39;, &#39;ABGGRND1&#39;, &#39;ABGGRND2&#39;, &#39;ABGGRND3&#39;, &#39;ABGGRND4&#39;, &#39;ABGGRND5&#39;, &#39;ABGGRND6&#39;, &#39;ABGGRND7&#39;, &#39;ABGGRND8&#39;, &#39;ABGGRND9&#39;, &#39;ABGGRND10&#39;, &#39;EIN01&#39;, &#39;EIN02&#39;, &#39;EIN03&#39;, &#39;EIN04&#39;, &#39;AUS01&#39;, &#39;AUS02&#39;, &#39;MASS1&#39;, &#39;MASS2&#39;, &#39;MASS3&#39;, &#39;MASS4&#39;, &#39;DATUM1&#39;, &#39;DATUM2&#39;, &#39;RABZUS&#39;, &#39;BACKCANC01&#39;, &#39;BACKCANC02&#39;, &#39;BACKCANC03&#39;, &#39;BACKCANC04&#39;, &#39;BACKCANC05&#39;, &#39;BACKCANC&#39;, &#39;BACKEXEC&#39;, &#39;BACKDOCNO&#39;, &#39;BACKDOCLINE&#39;, &#39;DYNCANC01&#39;, &#39;DYNCANC02&#39;, &#39;DYNCANC03&#39;, &#39;DYNCANC04&#39;, &#39;DYNCANC05&#39;, &#39;DYNCANC&#39;, &#39;DYNEXEC&#39;, &#39;LRATESTEP&#39;, &#39;PEB&#39;, &#39;OPLFDNR&#39;, &#39;STAFO&#39;, &#39;ARTMENGE&#39;, &#39;STATTART&#39;, &#39;TIMECONTRL&#39;, &#39;TCNUMTOR&#39;, &#39;TCDENOMTOR&#39;, &#39;TIMTYPQUOT&#39;, &#39;AKTIV&#39;, &#39;KONZVER&#39;, &#39;PERTYP&#39;, &#39;ERCHV_ANCHOR&#39;, &#39;OUCONTRACT&#39;, &#39;V_ABRMENGE&#39;, &#39;N_ABRMENGE&#39;, &#39;V_ZAHL1&#39;, &#39;N_ZAHL1&#39;, &#39;V_ZAHL2&#39;, &#39;N_ZAHL2&#39;, &#39;V_ZAHL3&#39;, &#39;N_ZAHL3&#39;, &#39;V_ZAHL4&#39;, &#39;N_ZAHL4&#39;, &#39;V_ZEITANT&#39;, &#39;N_ZEITANT&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"newdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"string"},{"metadata":{},"name":"CSNO","nullable":true,"type":"string"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"string"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"string"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"string"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"string"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"string"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"string"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"string"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"string"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"string"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"string"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"string"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"string"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"string"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"string"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190826294,"submitTime":1661190801870,"finishTime":1661190827715,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",2065]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"35f25049-2e88-441f-b05f-10a60e407b52"},{"version":"CommandV1","origId":2709619314155835,"guid":"8462a93b-36a7-40fc-87a3-4f883ab176da","subtype":"command","commandType":"auto","position":7.0,"command":"# display(newdf)\ncols_from_file_source = newdf.columns","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190827724,"submitTime":1661190801878,"finishTime":1661190827743,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"11486","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d7916eb0-beed-426d-a72c-93881ee0f0af"},{"version":"CommandV1","origId":2709619314155836,"guid":"5220dd89-4c5a-4eaf-a755-11b1e77ddbf2","subtype":"command","commandType":"auto","position":8.0,"command":"%run \"../Metadata/Load_Metadata\"","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"html","error":null,"workflows":[],"startTime":1662029093029,"submitTime":1662029093029,"finishTime":1662029093583,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3a84eb2c-344d-4124-96b9-ff165ce526a9"},{"version":"CommandV1","origId":2709619314155837,"guid":"a9904363-a1bf-4590-bc6d-047323afb540","subtype":"script","commandType":"auto","position":8.25,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662029093134,"submitTime":0,"finishTime":1662029093158,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5220dd89-4c5a-4eaf-a755-11b1e77ddbf2"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c72dfa99-5a5d-4e02-9824-1b5323724f9e"},{"version":"CommandV1","origId":2709619314155838,"guid":"33d857c1-fe3f-4d2a-88d0-dd1a10289fcf","subtype":"script","commandType":"auto","position":8.5,"command":"","commandVersion":40,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662029093166,"submitTime":0,"finishTime":1662029093203,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5220dd89-4c5a-4eaf-a755-11b1e77ddbf2"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b79b8f9b-d062-4fd3-b310-8342a785c7a0"},{"version":"CommandV1","origId":2709619314155839,"guid":"79c5cc0e-5618-4ddf-9ec5-5b99c06babba","subtype":"script","commandType":"auto","position":8.75,"command":"","commandVersion":104,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Your Metadata dataframe is loaded\nUse following syntax to grab it\n &lt;new dataframe&gt; = load_metadata_df(&lt;path of metadata csv&gt;) \n\n\nNOTE : csv path parameter is optional as Functions uses default path\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662029093207,"submitTime":0,"finishTime":1662029093226,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5220dd89-4c5a-4eaf-a755-11b1e77ddbf2"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1beb3524-a0fc-41a8-b8e2-72722bf751f1"},{"version":"CommandV1","origId":2709619314155840,"guid":"b257bb3a-e192-4ee7-951e-05f66fcae244","subtype":"command","commandType":"auto","position":9.0,"command":"metadf = load_metadata_df(metafilepath)\n# display(metadf)","commandVersion":5,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"metadf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662029103462,"submitTime":1662029103414,"finishTime":1662029104998,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1782","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8688d4f5-0f52-42db-8467-b2290260c54e"},{"version":"CommandV1","origId":2709619314155841,"guid":"f8173b24-85d1-448d-9af4-e0b8c74a3e1d","subtype":"command","commandType":"auto","position":10.0,"command":"cols_from_metadata = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[0]).collect()\nprint(cols_from_metadata)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&#39;MANDT&#39;, &#39;BELNR&#39;, &#39;BELZEILE&#39;, &#39;CSNO&#39;, &#39;BELZART&#39;, &#39;ABSLKZ&#39;, &#39;DIFFKZ&#39;, &#39;BUCHREL&#39;, &#39;MENGESTREL&#39;, &#39;BETRSTREL&#39;, &#39;STGRQNT&#39;, &#39;STGRAMT&#39;, &#39;PRINTREL&#39;, &#39;AKLASSE&#39;, &#39;BRANCHE&#39;, &#39;TVORG&#39;, &#39;GEGEN_TVORG&#39;, &#39;TAX_TVORG&#39;, &#39;LINESORT&#39;, &#39;AB&#39;, &#39;BIS&#39;, &#39;TIMTYPZA&#39;, &#39;SCHEMANR&#39;, &#39;SNO&#39;, &#39;PROGRAMM&#39;, &#39;MASSBILL&#39;, &#39;SAISON&#39;, &#39;TIMBASIS&#39;, &#39;TIMTYP&#39;, &#39;FRAN_TYPE&#39;, &#39;KONZIGR&#39;, &#39;TARIFTYP&#39;, &#39;TARIFNR&#39;, &#39;KONDIGR&#39;, &#39;STTARIF&#39;, &#39;GEWKEY&#39;, &#39;WDHFAKT&#39;, &#39;TEMP_AREA&#39;, &#39;DRCKSTUF&#39;, &#39;ABGGRND1&#39;, &#39;ABGGRND2&#39;, &#39;ABGGRND3&#39;, &#39;ABGGRND4&#39;, &#39;ABGGRND5&#39;, &#39;ABGGRND6&#39;, &#39;ABGGRND7&#39;, &#39;ABGGRND8&#39;, &#39;ABGGRND9&#39;, &#39;ABGGRND10&#39;, &#39;EIN01&#39;, &#39;EIN02&#39;, &#39;EIN03&#39;, &#39;EIN04&#39;, &#39;AUS01&#39;, &#39;AUS02&#39;, &#39;MASS1&#39;, &#39;MASS2&#39;, &#39;MASS3&#39;, &#39;MASS4&#39;, &#39;DATUM1&#39;, &#39;DATUM2&#39;, &#39;RABZUS&#39;, &#39;BACKCANC01&#39;, &#39;BACKCANC02&#39;, &#39;BACKCANC03&#39;, &#39;BACKCANC04&#39;, &#39;BACKCANC05&#39;, &#39;BACKCANC&#39;, &#39;BACKEXEC&#39;, &#39;BACKDOCNO&#39;, &#39;BACKDOCLINE&#39;, &#39;DYNCANC01&#39;, &#39;DYNCANC02&#39;, &#39;DYNCANC03&#39;, &#39;DYNCANC04&#39;, &#39;DYNCANC05&#39;, &#39;DYNCANC&#39;, &#39;DYNEXEC&#39;, &#39;LRATESTEP&#39;, &#39;PEB&#39;, &#39;OPLFDNR&#39;, &#39;STAFO&#39;, &#39;ARTMENGE&#39;, &#39;STATTART&#39;, &#39;TIMECONTRL&#39;, &#39;TCNUMTOR&#39;, &#39;TCDENOMTOR&#39;, &#39;TIMTYPQUOT&#39;, &#39;AKTIV&#39;, &#39;KONZVER&#39;, &#39;PERTYP&#39;, &#39;ERCHV_ANCHOR&#39;, &#39;OUCONTRACT&#39;, &#39;V_ABRMENGE&#39;, &#39;N_ABRMENGE&#39;, &#39;V_ZAHL1&#39;, &#39;N_ZAHL1&#39;, &#39;V_ZAHL2&#39;, &#39;N_ZAHL2&#39;, &#39;V_ZAHL3&#39;, &#39;N_ZAHL3&#39;, &#39;V_ZAHL4&#39;, &#39;N_ZAHL4&#39;, &#39;V_ZEITANT&#39;, &#39;N_ZEITANT&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190828232,"submitTime":1661190801970,"finishTime":1661190828501,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",2065]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e25c28fa-0c52-477b-9d2f-c16475188002"},{"version":"CommandV1","origId":2709619314155842,"guid":"72205cb6-285c-48ac-9610-e0c3a7ef192c","subtype":"command","commandType":"auto","position":11.0,"command":"print(cols_from_file_source)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&#39;MANDT&#39;, &#39;BELNR&#39;, &#39;BELZEILE&#39;, &#39;CSNO&#39;, &#39;BELZART&#39;, &#39;ABSLKZ&#39;, &#39;DIFFKZ&#39;, &#39;BUCHREL&#39;, &#39;MENGESTREL&#39;, &#39;BETRSTREL&#39;, &#39;STGRQNT&#39;, &#39;STGRAMT&#39;, &#39;PRINTREL&#39;, &#39;AKLASSE&#39;, &#39;BRANCHE&#39;, &#39;TVORG&#39;, &#39;GEGEN_TVORG&#39;, &#39;TAX_TVORG&#39;, &#39;LINESORT&#39;, &#39;AB&#39;, &#39;BIS&#39;, &#39;TIMTYPZA&#39;, &#39;SCHEMANR&#39;, &#39;SNO&#39;, &#39;PROGRAMM&#39;, &#39;MASSBILL&#39;, &#39;SAISON&#39;, &#39;TIMBASIS&#39;, &#39;TIMTYP&#39;, &#39;FRAN_TYPE&#39;, &#39;KONZIGR&#39;, &#39;TARIFTYP&#39;, &#39;TARIFNR&#39;, &#39;KONDIGR&#39;, &#39;STTARIF&#39;, &#39;GEWKEY&#39;, &#39;WDHFAKT&#39;, &#39;TEMP_AREA&#39;, &#39;DRCKSTUF&#39;, &#39;ABGGRND1&#39;, &#39;ABGGRND2&#39;, &#39;ABGGRND3&#39;, &#39;ABGGRND4&#39;, &#39;ABGGRND5&#39;, &#39;ABGGRND6&#39;, &#39;ABGGRND7&#39;, &#39;ABGGRND8&#39;, &#39;ABGGRND9&#39;, &#39;ABGGRND10&#39;, &#39;EIN01&#39;, &#39;EIN02&#39;, &#39;EIN03&#39;, &#39;EIN04&#39;, &#39;AUS01&#39;, &#39;AUS02&#39;, &#39;MASS1&#39;, &#39;MASS2&#39;, &#39;MASS3&#39;, &#39;MASS4&#39;, &#39;DATUM1&#39;, &#39;DATUM2&#39;, &#39;RABZUS&#39;, &#39;BACKCANC01&#39;, &#39;BACKCANC02&#39;, &#39;BACKCANC03&#39;, &#39;BACKCANC04&#39;, &#39;BACKCANC05&#39;, &#39;BACKCANC&#39;, &#39;BACKEXEC&#39;, &#39;BACKDOCNO&#39;, &#39;BACKDOCLINE&#39;, &#39;DYNCANC01&#39;, &#39;DYNCANC02&#39;, &#39;DYNCANC03&#39;, &#39;DYNCANC04&#39;, &#39;DYNCANC05&#39;, &#39;DYNCANC&#39;, &#39;DYNEXEC&#39;, &#39;LRATESTEP&#39;, &#39;PEB&#39;, &#39;OPLFDNR&#39;, &#39;STAFO&#39;, &#39;ARTMENGE&#39;, &#39;STATTART&#39;, &#39;TIMECONTRL&#39;, &#39;TCNUMTOR&#39;, &#39;TCDENOMTOR&#39;, &#39;TIMTYPQUOT&#39;, &#39;AKTIV&#39;, &#39;KONZVER&#39;, &#39;PERTYP&#39;, &#39;ERCHV_ANCHOR&#39;, &#39;OUCONTRACT&#39;, &#39;V_ABRMENGE&#39;, &#39;N_ABRMENGE&#39;, &#39;V_ZAHL1&#39;, &#39;N_ZAHL1&#39;, &#39;V_ZAHL2&#39;, &#39;N_ZAHL2&#39;, &#39;V_ZAHL3&#39;, &#39;N_ZAHL3&#39;, &#39;V_ZAHL4&#39;, &#39;N_ZAHL4&#39;, &#39;V_ZEITANT&#39;, &#39;N_ZEITANT&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190828509,"submitTime":1661190802000,"finishTime":1661190828535,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",2065]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"671b428e-3b62-46eb-96ff-c14a8193036d"},{"version":"CommandV1","origId":2709619314155843,"guid":"377a2085-2f99-4f77-9bab-29ee3981bfd2","subtype":"command","commandType":"auto","position":12.0,"command":"try:\n  test_list1 = sorted(cols_from_file_source)\n  test_list2 = sorted(cols_from_metadata)\n  print(\"Schema Matches !!\")\nexcept:\n  print(\"Mismatch in schema\" + table_name)\n  #dbutils.notebook.exit('stop')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Schema Matches !!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190828543,"submitTime":1661190802061,"finishTime":1661190828566,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",45]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"da654e6d-fdf6-4322-8bd1-fcfe2f2d057d"},{"version":"CommandV1","origId":2709619314155844,"guid":"cd85cd1a-2abd-4eaa-8580-ab2fd461d0e2","subtype":"command","commandType":"auto","position":15.0,"command":"def generate_code_for_casting_columns_based_on_metadata(metadf,table_name,dfname,newdfname):\n  z = str(\"\")\n  cols = metadf.select(\"Field_Name\",\"delta_types\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[0]).collect()\n  col_types = metadf.select(\"Field_Name\",\"delta_types\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[1]).collect()\n  for i,j in zip(cols,col_types):\n    i = '\"' + i + '\"'\n    j = '\"' + j + '\"'\n    z = z + ('.withColumn(' + i + ',col(' + i + ').cast(' + j + '))')\n  return(newdfname + ' = ' + dfname + z)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190828600,"submitTime":1661190802098,"finishTime":1661190828618,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9a8fd149-c00b-42d5-9e29-43e8b1cfda38"},{"version":"CommandV1","origId":2709619314155845,"guid":"9afc1d53-a673-4949-8ae3-3a7619c42794","subtype":"command","commandType":"auto","position":16.0,"command":"try:\n    get_code = generate_code_for_casting_columns_based_on_metadata(metadf,table_name,'newdf','casted_df')\n    exec(get_code)\n    print(get_code)\n    logger.info(\"generate_code_for_casting_columns_based_on_metadata function succeeded : refer cmd 16\")\nexcept:\n    logger.error(\"generate_code_for_casting_columns_based_on_metadata function FAILED : refer cmd 16\")\n","commandVersion":37,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">casted_df = newdf.withColumn(&#34;MANDT&#34;,col(&#34;MANDT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BELNR&#34;,col(&#34;BELNR&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BELZEILE&#34;,col(&#34;BELZEILE&#34;).cast(&#34;int&#34;)).withColumn(&#34;CSNO&#34;,col(&#34;CSNO&#34;).cast(&#34;int&#34;)).withColumn(&#34;BELZART&#34;,col(&#34;BELZART&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABSLKZ&#34;,col(&#34;ABSLKZ&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DIFFKZ&#34;,col(&#34;DIFFKZ&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BUCHREL&#34;,col(&#34;BUCHREL&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MENGESTREL&#34;,col(&#34;MENGESTREL&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BETRSTREL&#34;,col(&#34;BETRSTREL&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;STGRQNT&#34;,col(&#34;STGRQNT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;STGRAMT&#34;,col(&#34;STGRAMT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;PRINTREL&#34;,col(&#34;PRINTREL&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AKLASSE&#34;,col(&#34;AKLASSE&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BRANCHE&#34;,col(&#34;BRANCHE&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TVORG&#34;,col(&#34;TVORG&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;GEGEN_TVORG&#34;,col(&#34;GEGEN_TVORG&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TAX_TVORG&#34;,col(&#34;TAX_TVORG&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;LINESORT&#34;,col(&#34;LINESORT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AB&#34;,col(&#34;AB&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BIS&#34;,col(&#34;BIS&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TIMTYPZA&#34;,col(&#34;TIMTYPZA&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;SCHEMANR&#34;,col(&#34;SCHEMANR&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;SNO&#34;,col(&#34;SNO&#34;).cast(&#34;int&#34;)).withColumn(&#34;PROGRAMM&#34;,col(&#34;PROGRAMM&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MASSBILL&#34;,col(&#34;MASSBILL&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;SAISON&#34;,col(&#34;SAISON&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TIMBASIS&#34;,col(&#34;TIMBASIS&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TIMTYP&#34;,col(&#34;TIMTYP&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;FRAN_TYPE&#34;,col(&#34;FRAN_TYPE&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;KONZIGR&#34;,col(&#34;KONZIGR&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TARIFTYP&#34;,col(&#34;TARIFTYP&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TARIFNR&#34;,col(&#34;TARIFNR&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;KONDIGR&#34;,col(&#34;KONDIGR&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;STTARIF&#34;,col(&#34;STTARIF&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;GEWKEY&#34;,col(&#34;GEWKEY&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;WDHFAKT&#34;,col(&#34;WDHFAKT&#34;).cast(&#34;double&#34;)).withColumn(&#34;TEMP_AREA&#34;,col(&#34;TEMP_AREA&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DRCKSTUF&#34;,col(&#34;DRCKSTUF&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND1&#34;,col(&#34;ABGGRND1&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND2&#34;,col(&#34;ABGGRND2&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND3&#34;,col(&#34;ABGGRND3&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND4&#34;,col(&#34;ABGGRND4&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND5&#34;,col(&#34;ABGGRND5&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND6&#34;,col(&#34;ABGGRND6&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND7&#34;,col(&#34;ABGGRND7&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND8&#34;,col(&#34;ABGGRND8&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND9&#34;,col(&#34;ABGGRND9&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABGGRND10&#34;,col(&#34;ABGGRND10&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;EIN01&#34;,col(&#34;EIN01&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;EIN02&#34;,col(&#34;EIN02&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;EIN03&#34;,col(&#34;EIN03&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;EIN04&#34;,col(&#34;EIN04&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AUS01&#34;,col(&#34;AUS01&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AUS02&#34;,col(&#34;AUS02&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MASS1&#34;,col(&#34;MASS1&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MASS2&#34;,col(&#34;MASS2&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MASS3&#34;,col(&#34;MASS3&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MASS4&#34;,col(&#34;MASS4&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DATUM1&#34;,col(&#34;DATUM1&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DATUM2&#34;,col(&#34;DATUM2&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;RABZUS&#34;,col(&#34;RABZUS&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKCANC01&#34;,col(&#34;BACKCANC01&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKCANC02&#34;,col(&#34;BACKCANC02&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKCANC03&#34;,col(&#34;BACKCANC03&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKCANC04&#34;,col(&#34;BACKCANC04&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKCANC05&#34;,col(&#34;BACKCANC05&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKCANC&#34;,col(&#34;BACKCANC&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKEXEC&#34;,col(&#34;BACKEXEC&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKDOCNO&#34;,col(&#34;BACKDOCNO&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;BACKDOCLINE&#34;,col(&#34;BACKDOCLINE&#34;).cast(&#34;int&#34;)).withColumn(&#34;DYNCANC01&#34;,col(&#34;DYNCANC01&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DYNCANC02&#34;,col(&#34;DYNCANC02&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DYNCANC03&#34;,col(&#34;DYNCANC03&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DYNCANC04&#34;,col(&#34;DYNCANC04&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DYNCANC05&#34;,col(&#34;DYNCANC05&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DYNCANC&#34;,col(&#34;DYNCANC&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;DYNEXEC&#34;,col(&#34;DYNEXEC&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;LRATESTEP&#34;,col(&#34;LRATESTEP&#34;).cast(&#34;int&#34;)).withColumn(&#34;PEB&#34;,col(&#34;PEB&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;OPLFDNR&#34;,col(&#34;OPLFDNR&#34;).cast(&#34;int&#34;)).withColumn(&#34;STAFO&#34;,col(&#34;STAFO&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ARTMENGE&#34;,col(&#34;ARTMENGE&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;STATTART&#34;,col(&#34;STATTART&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TIMECONTRL&#34;,col(&#34;TIMECONTRL&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;TCNUMTOR&#34;,col(&#34;TCNUMTOR&#34;).cast(&#34;double&#34;)).withColumn(&#34;TCDENOMTOR&#34;,col(&#34;TCDENOMTOR&#34;).cast(&#34;double&#34;)).withColumn(&#34;TIMTYPQUOT&#34;,col(&#34;TIMTYPQUOT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AKTIV&#34;,col(&#34;AKTIV&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;KONZVER&#34;,col(&#34;KONZVER&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;PERTYP&#34;,col(&#34;PERTYP&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ERCHV_ANCHOR&#34;,col(&#34;ERCHV_ANCHOR&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;OUCONTRACT&#34;,col(&#34;OUCONTRACT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;V_ABRMENGE&#34;,col(&#34;V_ABRMENGE&#34;).cast(&#34;double&#34;)).withColumn(&#34;N_ABRMENGE&#34;,col(&#34;N_ABRMENGE&#34;).cast(&#34;double&#34;)).withColumn(&#34;V_ZAHL1&#34;,col(&#34;V_ZAHL1&#34;).cast(&#34;double&#34;)).withColumn(&#34;N_ZAHL1&#34;,col(&#34;N_ZAHL1&#34;).cast(&#34;double&#34;)).withColumn(&#34;V_ZAHL2&#34;,col(&#34;V_ZAHL2&#34;).cast(&#34;double&#34;)).withColumn(&#34;N_ZAHL2&#34;,col(&#34;N_ZAHL2&#34;).cast(&#34;double&#34;)).withColumn(&#34;V_ZAHL3&#34;,col(&#34;V_ZAHL3&#34;).cast(&#34;double&#34;)).withColumn(&#34;N_ZAHL3&#34;,col(&#34;N_ZAHL3&#34;).cast(&#34;double&#34;)).withColumn(&#34;V_ZAHL4&#34;,col(&#34;V_ZAHL4&#34;).cast(&#34;double&#34;)).withColumn(&#34;N_ZAHL4&#34;,col(&#34;N_ZAHL4&#34;).cast(&#34;double&#34;)).withColumn(&#34;V_ZEITANT&#34;,col(&#34;V_ZEITANT&#34;).cast(&#34;double&#34;)).withColumn(&#34;N_ZEITANT&#34;,col(&#34;N_ZEITANT&#34;).cast(&#34;double&#34;))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"casted_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190828626,"submitTime":1661190802128,"finishTime":1661190832259,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",8091]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f3fb527a-e75c-444a-b61f-1d7633ad091f"},{"version":"CommandV1","origId":2709619314155846,"guid":"8f26e034-7978-4b90-abdb-87dd573ca7a1","subtype":"command","commandType":"auto","position":18.0,"command":"# FUNCTION TO REMOVE DUPLICATE ROWS\n\ndef duplicates_removal(dups_df):\n  df = dups_df.drop_duplicates()\n  keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n  orderbycol = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\").isNull()).rdd.map(lambda x : x[0]).collect()\n\n  windowspec = Window.partitionBy(keyfields).orderBy(orderbycol[0])\n  table_archive = df.withColumn(\"row_number\",row_number().over(windowspec)).select(\"*\").where(col(\"row_number\")==1)\n  table_erroneous = df.withColumn(\"row_number\",row_number().over(windowspec)).select(\"*\").where(col(\"row_number\")>1)\n  return (table_archive,table_erroneous)","commandVersion":26,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190832298,"submitTime":1661190802161,"finishTime":1661190832317,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b64def4c-8f8b-47c4-9da1-16a7b3392360"},{"version":"CommandV1","origId":2709619314155847,"guid":"d936c9dc-fb62-402f-b561-b38ac2aeac39","subtype":"command","commandType":"auto","position":19.0,"command":"archive_df,erroneous_df = duplicates_removal(casted_df)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"archive_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"row_number","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"erroneous_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"row_number","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190832325,"submitTime":1661190802196,"finishTime":1661190833046,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f7239afb-6c3a-4ff8-8142-540bf3c4f8a4"},{"version":"CommandV1","origId":2709619314155848,"guid":"6cc26413-7650-4e4e-a836-99796ef129d1","subtype":"command","commandType":"auto","position":20.75,"command":"def generate_code_for_adding_flag_columns(metadf,table_name,dfname,newdfname):\n    col1 = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n    if col1:\n        Logic_1 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',lit('ARCHIVE')).withColumn('EPOCH_FLAG',lit('ARCHIVE'))\"\n    else:\n        Logic_1 = newdfname + \" = \" + dfname + \".withColumn('EPOCH_FLAG',lit('ARCHIVE'))\"\n    return(Logic_1)","commandVersion":51,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190833179,"submitTime":1661190802396,"finishTime":1661190833196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cd1cf752-8dc9-47ec-b796-2cb797969faf"},{"version":"CommandV1","origId":2709619314155849,"guid":"0e466af8-635f-42f6-b6ea-ef4cb3b05d6b","subtype":"command","commandType":"auto","position":20.875,"command":"# GENERATE SCHEMA FOR ARCHIVE MAIN TABLE\n\ntry:\n    get_code = generate_code_for_adding_flag_columns(metadf,table_name,'archive_df','archive_part_col_added_df')\n    print(get_code)\n    exec(get_code)\n    logger.info(\"Generate Schema for Archive Main Table succeeded : refer cmd 20\")\nexcept:\n    logger.error(\"Generate Schema for Archive Main Table FAILED : refer cmd 20\")\n","commandVersion":53,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">archive_part_col_added_df = archive_df.withColumn(&#39;partitioncol&#39;,lit(&#39;ARCHIVE&#39;)).withColumn(&#39;EPOCH_FLAG&#39;,lit(&#39;ARCHIVE&#39;))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"archive_part_col_added_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"row_number","nullable":true,"type":"integer"},{"metadata":{},"name":"partitioncol","nullable":false,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190833202,"submitTime":1661190802422,"finishTime":1661190833462,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",180]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c4e7f5a3-334e-4eb8-808f-149b92240417"},{"version":"CommandV1","origId":2709619314155850,"guid":"3e9ab04a-873a-4dab-8e87-138975a546d2","subtype":"command","commandType":"auto","position":21.5,"command":"# GENERATE SCHEMA FOR ERROR TABLE\n\ntry:\n    get_code = generate_code_for_adding_flag_columns(metadf,table_name,'erroneous_df','erroneous_part_col_added_df')\n    print(get_code)\n    exec(get_code)\n    logger.info(\"Generate Schema for Archive Error Table succeeded : refer cmd 21\")\nexcept:\n    logger.error(\"Generate Schema for Archive Error Table FAILED : refer cmd 21\")\n","commandVersion":35,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">erroneous_part_col_added_df = erroneous_df.withColumn(&#39;partitioncol&#39;,lit(&#39;ARCHIVE&#39;)).withColumn(&#39;EPOCH_FLAG&#39;,lit(&#39;ARCHIVE&#39;))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"erroneous_part_col_added_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"row_number","nullable":true,"type":"integer"},{"metadata":{},"name":"partitioncol","nullable":false,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190833471,"submitTime":1661190802449,"finishTime":1661190833850,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",184]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"36c67019-c62c-4482-a4af-41f73b6c54ba"},{"version":"CommandV1","origId":2709619314155851,"guid":"72ef0ad2-b8c6-4490-9d24-c8dda12048eb","subtype":"command","commandType":"auto","position":23.0,"command":"archive_final_DF = archive_part_col_added_df.withColumn(\"EDA_Creation_date\",current_timestamp())\n# display(archive_final_DF)","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"archive_final_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"row_number","nullable":true,"type":"integer"},{"metadata":{},"name":"partitioncol","nullable":false,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190833912,"submitTime":1661190802468,"finishTime":1661190833971,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"12054","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ed1e6902-a725-4ee1-8681-01297d78d1f7"},{"version":"CommandV1","origId":2709619314155852,"guid":"f2101985-1964-41e7-9b8f-21d6d5198d86","subtype":"command","commandType":"auto","position":23.25,"command":"erroneous_final_DF = erroneous_part_col_added_df.withColumn(\"EDA_Creation_date\",current_timestamp())\n# display(erroneous_final_DF)","commandVersion":8,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"erroneous_final_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"row_number","nullable":true,"type":"integer"},{"metadata":{},"name":"partitioncol","nullable":false,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190833981,"submitTime":1661190802474,"finishTime":1661190834041,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"8173","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2b48d2ef-b1e5-4b41-9cc7-c447f425b65e"},{"version":"CommandV1","origId":2709619314155853,"guid":"df11635c-5331-40df-929b-55a882338b5a","subtype":"command","commandType":"auto","position":23.875,"command":"archive_write_DF = archive_final_DF.drop(\"row_number\")\nerroneous_write_DF = erroneous_final_DF.drop(\"row_number\")","commandVersion":20,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"archive_write_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"partitioncol","nullable":false,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"erroneous_write_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"BELNR","nullable":true,"type":"string"},{"metadata":{},"name":"BELZEILE","nullable":true,"type":"integer"},{"metadata":{},"name":"CSNO","nullable":true,"type":"integer"},{"metadata":{},"name":"BELZART","nullable":true,"type":"string"},{"metadata":{},"name":"ABSLKZ","nullable":true,"type":"string"},{"metadata":{},"name":"DIFFKZ","nullable":true,"type":"string"},{"metadata":{},"name":"BUCHREL","nullable":true,"type":"string"},{"metadata":{},"name":"MENGESTREL","nullable":true,"type":"string"},{"metadata":{},"name":"BETRSTREL","nullable":true,"type":"string"},{"metadata":{},"name":"STGRQNT","nullable":true,"type":"string"},{"metadata":{},"name":"STGRAMT","nullable":true,"type":"string"},{"metadata":{},"name":"PRINTREL","nullable":true,"type":"string"},{"metadata":{},"name":"AKLASSE","nullable":true,"type":"string"},{"metadata":{},"name":"BRANCHE","nullable":true,"type":"string"},{"metadata":{},"name":"TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"GEGEN_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"TAX_TVORG","nullable":true,"type":"string"},{"metadata":{},"name":"LINESORT","nullable":true,"type":"string"},{"metadata":{},"name":"AB","nullable":true,"type":"string"},{"metadata":{},"name":"BIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYPZA","nullable":true,"type":"string"},{"metadata":{},"name":"SCHEMANR","nullable":true,"type":"string"},{"metadata":{},"name":"SNO","nullable":true,"type":"integer"},{"metadata":{},"name":"PROGRAMM","nullable":true,"type":"string"},{"metadata":{},"name":"MASSBILL","nullable":true,"type":"string"},{"metadata":{},"name":"SAISON","nullable":true,"type":"string"},{"metadata":{},"name":"TIMBASIS","nullable":true,"type":"string"},{"metadata":{},"name":"TIMTYP","nullable":true,"type":"string"},{"metadata":{},"name":"FRAN_TYPE","nullable":true,"type":"string"},{"metadata":{},"name":"KONZIGR","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFTYP","nullable":true,"type":"string"},{"metadata":{},"name":"TARIFNR","nullable":true,"type":"string"},{"metadata":{},"name":"KONDIGR","nullable":true,"type":"string"},{"metadata":{},"name":"STTARIF","nullable":true,"type":"string"},{"metadata":{},"name":"GEWKEY","nullable":true,"type":"string"},{"metadata":{},"name":"WDHFAKT","nullable":true,"type":"double"},{"metadata":{},"name":"TEMP_AREA","nullable":true,"type":"string"},{"metadata":{},"name":"DRCKSTUF","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND1","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND2","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND3","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND4","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND5","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND6","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND7","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND8","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND9","nullable":true,"type":"string"},{"metadata":{},"name":"ABGGRND10","nullable":true,"type":"string"},{"metadata":{},"name":"EIN01","nullable":true,"type":"string"},{"metadata":{},"name":"EIN02","nullable":true,"type":"string"},{"metadata":{},"name":"EIN03","nullable":true,"type":"string"},{"metadata":{},"name":"EIN04","nullable":true,"type":"string"},{"metadata":{},"name":"AUS01","nullable":true,"type":"string"},{"metadata":{},"name":"AUS02","nullable":true,"type":"string"},{"metadata":{},"name":"MASS1","nullable":true,"type":"string"},{"metadata":{},"name":"MASS2","nullable":true,"type":"string"},{"metadata":{},"name":"MASS3","nullable":true,"type":"string"},{"metadata":{},"name":"MASS4","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM1","nullable":true,"type":"string"},{"metadata":{},"name":"DATUM2","nullable":true,"type":"string"},{"metadata":{},"name":"RABZUS","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"BACKCANC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCNO","nullable":true,"type":"string"},{"metadata":{},"name":"BACKDOCLINE","nullable":true,"type":"integer"},{"metadata":{},"name":"DYNCANC01","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC02","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC03","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC04","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC05","nullable":true,"type":"string"},{"metadata":{},"name":"DYNCANC","nullable":true,"type":"string"},{"metadata":{},"name":"DYNEXEC","nullable":true,"type":"string"},{"metadata":{},"name":"LRATESTEP","nullable":true,"type":"integer"},{"metadata":{},"name":"PEB","nullable":true,"type":"string"},{"metadata":{},"name":"OPLFDNR","nullable":true,"type":"integer"},{"metadata":{},"name":"STAFO","nullable":true,"type":"string"},{"metadata":{},"name":"ARTMENGE","nullable":true,"type":"string"},{"metadata":{},"name":"STATTART","nullable":true,"type":"string"},{"metadata":{},"name":"TIMECONTRL","nullable":true,"type":"string"},{"metadata":{},"name":"TCNUMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TCDENOMTOR","nullable":true,"type":"double"},{"metadata":{},"name":"TIMTYPQUOT","nullable":true,"type":"string"},{"metadata":{},"name":"AKTIV","nullable":true,"type":"string"},{"metadata":{},"name":"KONZVER","nullable":true,"type":"string"},{"metadata":{},"name":"PERTYP","nullable":true,"type":"string"},{"metadata":{},"name":"ERCHV_ANCHOR","nullable":true,"type":"string"},{"metadata":{},"name":"OUCONTRACT","nullable":true,"type":"string"},{"metadata":{},"name":"V_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"N_ABRMENGE","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL1","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL2","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL3","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZAHL4","nullable":true,"type":"double"},{"metadata":{},"name":"V_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"N_ZEITANT","nullable":true,"type":"double"},{"metadata":{},"name":"partitioncol","nullable":false,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190834050,"submitTime":1661190802500,"finishTime":1661190834142,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"746b5c7d-3b9c-4cb7-8cb9-1536d40f8fa9"},{"version":"CommandV1","origId":2709619314155854,"guid":"fcc6cd21-cc29-44ab-b2af-e5d9bc72129c","subtype":"command","commandType":"auto","position":24.0625,"command":"from delta.tables import *\nfrom pyspark.sql.functions import *","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190834225,"submitTime":1661190802566,"finishTime":1661190834244,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fe0874bc-02dc-46e8-a375-c16a36ff2e20"},{"version":"CommandV1","origId":2709619314155855,"guid":"09d1faf1-56f7-4ec9-af50-41d14be75cc1","subtype":"command","commandType":"auto","position":24.125,"command":"# IF FULL_LOAD = Yes, OVERWRITE FILES/FOLDER IN TARGET LOCATION ELSE PERFORM MERGE \n\ntry:    \n    if (str(FULL_LOAD) == 'Yes'):\n        dbutils.fs.rm(curated_location,True)\n        dbutils.fs.rm(curated_location_err,True)\n        s = 'archive_write_DF.write.format(\"delta\").mode(\"overwrite\").save(' + curated_location + ')'\n        exec(s)\n        s = 'erroneous_write_DF.write.format(\"delta\").mode(\"overwrite\").save(' + curated_location_err + ')'\n        exec(s)\n    else:\n        keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n        cond = ''\n        exitindex = len(keyfields)-1\n        for i in keyfields:\n            if keyfields.index(i) == exitindex:\n                cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i\n            else:\n                cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i + ' AND '\n        \n        cond = cond + ' AND logs.EDA_Creation_date < newDedupedLogs.EDA_Creation_date'\n        print(cond)\n    \n    \n        s = \"deltaTable = DeltaTable.forPath(spark, \" + curated_location + \")\"\n        exec(s)\n        newDedupedLogs = archive_write_DF\n    \n        deltaTable.alias(\"logs\").merge(\n            newDedupedLogs.alias(\"newDedupedLogs\"),\n            cond) \\\n          .whenMatchedUpdateAll() \\\n          .whenNotMatchedInsertAll() \\\n          .execute()\nexcept:\n    logger.error(\"MERGE FAILED : refer cmd 26\")","commandVersion":84,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661190834253,"submitTime":1661190802595,"finishTime":1661190897149,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"10380db2-2e63-485c-b92f-32d73fcf7a1c"}],"dashboards":[],"guid":"f31a4055-290a-42e0-a019-a90ba686ac83","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location":{"nuid":"77440f13-2446-4f8a-900e-117a4bea2a11","currentValue":"","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}}},"table_name":{"nuid":"1835a9a7-b4b8-4345-89dd-451362d8950c","currentValue":"","widgetInfo":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}},"metafilepath":{"nuid":"06f31d17-1414-4978-924a-0b73ae96c858","currentValue":"","widgetInfo":{"widgetType":"text","name":"metafilepath","defaultValue":"","label":"METADATA FILEPATH","options":{"widgetType":"text","validationRegex":null}}},"dbfslogbasepath":{"nuid":"3f209f01-80b4-4063-b0b9-c5fe03140954","currentValue":"","widgetInfo":{"widgetType":"text","name":"dbfslogbasepath","defaultValue":"","label":"DBFS LOG FILE PATH","options":{"widgetType":"text","validationRegex":null}}},"staging_location":{"nuid":"8461c019-22f9-4575-92e5-6a3656960fad","currentValue":"","widgetInfo":{"widgetType":"text","name":"staging_location","defaultValue":"","label":"staging location","options":{"widgetType":"text","validationRegex":null}}},"curated_location_err":{"nuid":"fb380019-930b-4741-b523-2be501fe7290","currentValue":"","widgetInfo":{"widgetType":"text","name":"curated_location_err","defaultValue":"","label":"curated location for error table","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"512f1b55-64ff-4f42-9170-3d8c6c1ebaff","currentValue":"","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":4,"widgetLayout":[{"name":"FULL_LOAD","width":193,"breakBefore":false},{"name":"curated_location","width":193,"breakBefore":false},{"name":"curated_location_err","width":193,"breakBefore":false},{"name":"staging_location","width":193,"breakBefore":false},{"name":"table_name","width":193,"breakBefore":false}]},"reposExportFormat":"SOURCE"}