{"version":"NotebookV1","origId":2709619314154582,"name":"STD Master Notebook Stream","language":"python","commands":[{"version":"CommandV1","origId":2709619314154583,"guid":"87c8ea24-7c21-4774-b3e9-a24feea55f48","subtype":"command","commandType":"auto","position":1.0,"command":"#%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"html","error":null,"workflows":[],"startTime":1662980629833,"submitTime":1662980629833,"finishTime":1662980638664,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0d74774b-07a6-4af5-bb60-63b711e20685"},{"version":"CommandV1","origId":2709619314154584,"guid":"0d936333-d741-4922-ac91-bee1794ecf22","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c76bc472-f9e1-4d28-8a1e-2907938e7a9d"},{"version":"CommandV1","origId":2709619314154585,"guid":"57e6593e-bd28-4846-8fee-fe23321c6712","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["env","db_name","pii_or_nonpii","tablecreationnbpath","silver_location","metaadlspath","FULL_LOAD","dataprepnbpath","manual_list_str","execution_logs_loc","replicate_loc","bronze_location","runfornpreviousdays"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980630250,"submitTime":0,"finishTime":1662980630273,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"408d3751-a8fe-4d10-863e-a612fd2c25cb"},{"version":"CommandV1","origId":2709619314154586,"guid":"4321fb37-2882-4fb8-9d50-00a3aeb4eb15","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980630280,"submitTime":0,"finishTime":1662980630295,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"610f2271-c0b4-478e-9177-81b4fb820cdc"},{"version":"CommandV1","origId":2709619314154587,"guid":"82513a7c-7dd6-4300-a761-0be3233d5009","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3dec7dcd-02ab-4cf9-8307-98a0804e28cf"},{"version":"CommandV1","origId":2709619314154588,"guid":"c2147fe0-c266-4475-928e-868ab49bf76d","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980630304,"submitTime":0,"finishTime":1662980630413,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1eb0be3-4eb5-4b26-9e34-3cdd1c9416ae"},{"version":"CommandV1","origId":2709619314154589,"guid":"8883a32e-ea5c-4758-8724-01dc772a6452","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980630427,"submitTime":0,"finishTime":1662980630463,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7515cb8a-2390-433d-82f9-f08339428da9"},{"version":"CommandV1","origId":2709619314154590,"guid":"35669b49-c25d-4d43-982a-81e71c6e97d1","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980630470,"submitTime":0,"finishTime":1662980636902,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7acbc3bf-56f6-453e-87c5-205bd5d7c3a9"},{"version":"CommandV1","origId":2709619314154591,"guid":"47246ac6-4a09-4818-aefd-4d1a557b065d","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980636908,"submitTime":0,"finishTime":1662980637132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a76313e7-cc6d-4bd4-ab37-d2803b38013a"},{"version":"CommandV1","origId":2709619314154592,"guid":"0d5647fd-c5b9-49c5-9334-f9d6243fd669","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980637142,"submitTime":0,"finishTime":1662980637300,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6765","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9642f7c-8f2f-4c94-ae2a-90b8853a20db"},{"version":"CommandV1","origId":2709619314154593,"guid":"75f1fd38-d84a-4135-9677-a494919ee5f0","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ab037e98-0a1a-4d5d-9f80-f35377c2d64c"},{"version":"CommandV1","origId":2709619314154594,"guid":"adbcac87-cf50-4e08-9892-6afea08b6212","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980637307,"submitTime":0,"finishTime":1662980637667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6765","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a16ee1f2-423d-4b40-b5ec-530a2f1553e1"},{"version":"CommandV1","origId":2709619314154595,"guid":"c178ef51-919d-4154-8d3b-15dfcbf6e651","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"062a7e7a-4ef8-4240-b425-cb4c4364a870"},{"version":"CommandV1","origId":2709619314154596,"guid":"394c7206-845b-4394-b804-3dbff0ef4d20","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980637677,"submitTime":0,"finishTime":1662980638263,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3951","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"022c4015-c3c4-4d32-9615-feb025f59161"},{"version":"CommandV1","origId":2709619314154597,"guid":"677d5852-7e40-4c98-ae0b-2ae3f07da1d5","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b34c4ab9-29dc-4f9f-9e05-a13cbf3cd726"},{"version":"CommandV1","origId":2709619314154598,"guid":"97c4cda4-53f6-404c-aa63-16f8fc2d3460","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638272,"submitTime":0,"finishTime":1662980638297,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5db8ed30-a618-4226-b742-90c474c075ce"},{"version":"CommandV1","origId":2709619314154599,"guid":"7721ccc5-55dd-4aae-89c3-766851a7e279","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638306,"submitTime":0,"finishTime":1662980638392,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["87c8ea24-7c21-4774-b3e9-a24feea55f48"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6f8438f1-e915-463c-8eb3-5ea987856b0b"},{"version":"CommandV1","origId":2709619314154600,"guid":"57ca3bb5-5f3c-4882-8aca-8d059376c4ed","subtype":"command","commandType":"auto","position":2.0,"command":"# SET LOAD TYPE (FULL LOAD = Yes/No)\ndbutils.widgets.text(\"FULL_LOAD\", \"No\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")\n\n# SET ENVIRONMENT FOR DATA LAKE (02 OR 10 OR etc)\ndbutils.widgets.text(\"env\", \"02\", \"ADLS ENVIRONMENT\")\nenv = dbutils.widgets.get(\"env\")\n\n#SET TABLE LIST (nonpii OR pii) \ndbutils.widgets.text(\"pii_or_nonpii\", \"nonpii\", \"TABLE PREFERENCE( NONPII/PII)\")\npii_or_nonpii = dbutils.widgets.get(\"pii_or_nonpii\")\n\n# SET MANUAL LIST OF TABLES (for example = table1 table2 table3 etc)\ndbutils.widgets.text(\"manual_list_str\", \"\", \"MANUAL TABLE LIST\")\nmanual_list_str = dbutils.widgets.get(\"manual_list_str\")\nmanual_list  =  (list(manual_list_str.split()))\n\n# SET DATABASE NAME\ndbutils.widgets.text(\"db_name\", \"cods_nonprod_active\", \"DATABASE NAME\")\ndb_name = dbutils.widgets.get(\"db_name\")\n\n#SET BASEPATH\nbasepath = 'abfss://dev@dtecuprodedaadl' + env + '.dfs.core.windows.net/'\n\n#SET SEGREGATED LOCATION PATH \ndbutils.widgets.text(\"replicate_loc\", \"curated/ISU_archive/cods_nonprod_compose\", \"REPLICATE-COMPOSE LOC\")\nreplicate_loc = basepath + dbutils.widgets.get(\"replicate_loc\")\n\n#SET STAGING LOCATION PATH\nstaging_location = replicate_loc\n\n#SET SILVER LOCATION PATH \ndbutils.widgets.text(\"silver_location\", \"curated/ISU_archive/silver\", \"SILVER LOC\")\nsilver_location = basepath + dbutils.widgets.get(\"silver_location\")\n\n#SET BRONZE LOCATION PATH \ndbutils.widgets.text(\"bronze_location\", \"curated/ISU_archive/bronze\", \"BRONZE LOC\")\nbronze_location = basepath + dbutils.widgets.get(\"bronze_location\")\n\n#SET EXECUTION LOGS LOCATION PATH \ndbutils.widgets.text(\"execution_logs_loc\", \"ISU_archive_support/execution_logs/stream_logs\", \"EXECUTION LOGS LOC\")\nexecution_logs_loc = basepath + dbutils.widgets.get(\"execution_logs_loc\")\n\n# SET RUN FOR N PREVIOUS DAYS (0 BYDEFAULT, EXAMPLES : 1,2,3,4,5,6..)\ndbutils.widgets.text(\"runfornpreviousdays\", \"\", \"RUN FOR N PREVIOUS DAYS\")\nrunfornpreviousdays = dbutils.widgets.get(\"runfornpreviousdays\")\n\n# SET METADATA FILEPATH FROM ADLS (For example  = ISU_archive_support/metadata/Final_metadata.csv)\ndbutils.widgets.text(\"metaadlspath\", \"ISU_archive_support/metadata/Final_metadata.csv\", \"METADATA FILE LOC\")\nmetaadlspath = dbutils.widgets.get(\"metaadlspath\")\n\n# SET METADATA FILE FULL PATH TO ADLS\nmetafilepath = basepath + metaadlspath\n\n#SET TABLE CREATION NOTEBOOK PATH\ndbutils.widgets.text(\"tablecreationnbpath\", \"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD Stream Dynamic Table Creation Using MetaTable\", \"TABLE CREATION NOTEBOOK PATH\")\ntablecreationnbpath = dbutils.widgets.get(\"tablecreationnbpath\")\n\n#SET DATA PEP NOTEBOOK PATH\ndbutils.widgets.text(\"dataprepnbpath\", \"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD STREAM_DATA_PREPARATION\", \"DATA PREP NOTEBOOK PATH\")\ndataprepnbpath = dbutils.widgets.get(\"dataprepnbpath\")","commandVersion":3,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"dataprepnbpath":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD STREAM_DATA_PREPARATION","execution_logs_loc":"ISU_archive_support/execution_logs/stream_logs","tablecreationnbpath":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD Stream Dynamic Table Creation Using MetaTable","db_name":"cods_nonprod_active","pii_or_nonpii":"nonpii","replicate_loc":"curated/ISU_archive/cods_nonprod_compose","runfornpreviousdays":"","manual_list_str":"ERDO","silver_location":"curated/ISU_archive/silver","metaadlspath":"ISU_archive_support/metadata/Final_metadata.csv","FULL_LOAD":"No","bronze_location":"curated/ISU_archive/bronze","env":"02"},"addedWidgets":{"dataprepnbpath":{"widgetType":"text","name":"dataprepnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD STREAM_DATA_PREPARATION","label":"DATA PREP NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}},"execution_logs_loc":{"widgetType":"text","name":"execution_logs_loc","defaultValue":"ISU_archive_support/execution_logs/stream_logs","label":"EXECUTION LOGS LOC","options":{"widgetType":"text","validationRegex":null}},"tablecreationnbpath":{"widgetType":"text","name":"tablecreationnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD Stream Dynamic Table Creation Using MetaTable","label":"TABLE CREATION NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}},"db_name":{"widgetType":"text","name":"db_name","defaultValue":"cods_nonprod_active","label":"DATABASE NAME","options":{"widgetType":"text","validationRegex":null}},"pii_or_nonpii":{"widgetType":"text","name":"pii_or_nonpii","defaultValue":"nonpii","label":"TABLE PREFERENCE( NONPII/PII)","options":{"widgetType":"text","validationRegex":null}},"replicate_loc":{"widgetType":"text","name":"replicate_loc","defaultValue":"curated/ISU_archive/cods_nonprod_compose","label":"REPLICATE-COMPOSE LOC","options":{"widgetType":"text","validationRegex":null}},"runfornpreviousdays":{"widgetType":"text","name":"runfornpreviousdays","defaultValue":"","label":"RUN FOR N PREVIOUS DAYS","options":{"widgetType":"text","validationRegex":null}},"manual_list_str":{"widgetType":"text","name":"manual_list_str","defaultValue":"","label":"MANUAL TABLE LIST","options":{"widgetType":"text","validationRegex":null}},"silver_location":{"widgetType":"text","name":"silver_location","defaultValue":"curated/ISU_archive/silver","label":"SILVER LOC","options":{"widgetType":"text","validationRegex":null}},"metaadlspath":{"widgetType":"text","name":"metaadlspath","defaultValue":"ISU_archive_support/metadata/Final_metadata.csv","label":"METADATA FILE LOC","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}},"bronze_location":{"widgetType":"text","name":"bronze_location","defaultValue":"curated/ISU_archive/bronze","label":"BRONZE LOC","options":{"widgetType":"text","validationRegex":null}},"env":{"widgetType":"text","name":"env","defaultValue":"02","label":"ADLS ENVIRONMENT","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638398,"submitTime":1662980629918,"finishTime":1662980638429,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2b4883bb-6308-4fde-a099-fc221e55017f"},{"version":"CommandV1","origId":2709619314154601,"guid":"cb0e7612-1a21-4838-ae62-6ca86facf10e","subtype":"command","commandType":"auto","position":3.0,"command":"print(\"basepath : \" + basepath)\nprint(\"FULL_LOAD : \" + FULL_LOAD)\nprint(\"pii_or_nonpii : \" + pii_or_nonpii)\nprint(\"manual_list : \" + manual_list_str)\nprint(\"db_name : \" + db_name)\nprint(\"replicate_loc : \" + replicate_loc)\nprint(\"staging_location : \" + staging_location)\nprint(\"silver_location : \" + silver_location)\nprint(\"bronze_location : \" + bronze_location)\nprint(\"execution_logs_loc : \" + execution_logs_loc)\nprint(\"metafilepath : \" + metafilepath)\nprint(\"tablecreationnbpath : \" + tablecreationnbpath)\nprint(\"dataprepnbpath : \" + dataprepnbpath)","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">basepath : abfss://dev@[REDACTED].dfs.core.windows.net/\nFULL_LOAD : No\npii_or_nonpii : nonpii\nmanual_list : ERDO\ndb_name : cods_nonprod_active\nreplicate_loc : abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/cods_nonprod_compose\nstaging_location : abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/cods_nonprod_compose\nsilver_location : abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/silver\nbronze_location : abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/bronze\nexecution_logs_loc : abfss://dev@[REDACTED].dfs.core.windows.net/ISU_archive_support/execution_logs/stream_logs\nmetafilepath : abfss://dev@[REDACTED].dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv\ntablecreationnbpath : /EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD Stream Dynamic Table Creation Using MetaTable\ndataprepnbpath : /EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD STREAM_DATA_PREPARATION\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638435,"submitTime":1662980629970,"finishTime":1662980638451,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",989]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"27552b3a-dd59-47d3-be33-4c7432993b1a"},{"version":"CommandV1","origId":2709619314154602,"guid":"7d96c310-c1da-4474-b361-61048c1c0e47","subtype":"command","commandType":"auto","position":4.0,"command":"#START LOGGING\n\nimport logging\nimport datetime\n\nexecution_logs_loc2 = execution_logs_loc + \"/\"\n\n#ADD FOLDER IF NOT EXIST\ndbutils.fs.mkdirs(execution_logs_loc)\n\ncurrentutctime = datetime.datetime.now().strftime('%Y%m%d_%H%M%S')\nfilenamewithtime = \"EDA_STREAM_\" + currentutctime +\".log\"\npartitions = datetime.datetime.now().strftime('%Y-%m-%d/')\n\ndbfslogbasepath = \"/tmp\" + \"/\" + filenamewithtime\n\n#TAG LOGGING INFO TO NOTEBOOK\nlogger = logging.getLogger('MasterNotebookStream')\n\n#SETTING THRESHOLD OF LOGGER TO INFO\nlogger.setLevel(logging.INFO)\n\nFilehandler = logging.FileHandler(dbfslogbasepath,mode = 'a')\n\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p')\nFilehandler.setFormatter(formatter)\n\nlogger.addHandler(Filehandler)\n\n#LOG INFO\nlogger.info(\"Master NoteBook for Stream run started \")\nlogger.info(\"Input Parameters >>\")\nlogger.info(\"basepath : \" + basepath + \",\" + \"FULL_LOAD : \" + FULL_LOAD + \",\" + \"pii_or_nonpii : \" + pii_or_nonpii + \",\" + \"manual_list : \" + manual_list_str + \",\" + \"db_name : \" + db_name + \",\" + \"replicate_loc : \" + replicate_loc + \",\" + \"staging_location : \" + staging_location + \",\" + \"silver_location : \" + silver_location + \",\" + \"bronze_location : \" + bronze_location + \",\" + \"metafilepath : \" + metafilepath + \",\" + \"tablecreationnbpath : \" + tablecreationnbpath + \",\" + \"dataprepnbpath : \" + dataprepnbpath)","commandVersion":13,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638456,"submitTime":1662980630004,"finishTime":1662980638520,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c58e80a5-c614-4d59-b81f-632800b8d59a"},{"version":"CommandV1","origId":2709619314154603,"guid":"b98c03b7-0b8c-4bfa-904d-c82b409507d6","subtype":"command","commandType":"auto","position":5.0,"command":"print(replicate_loc)\nfileloc = dbutils.fs.ls(replicate_loc)\n\n# LIST OF TABLES FROM DIRECTORY \ntablelist1 = list(map(lambda p: p.name[:-1].upper(), fileloc))\n\n# LIST OF ALL NONPII TABLES\nnonpiitablelist = ['CDHDR','CDPOS','DBERCHV','DBERCHZ1','DBERCHZ2','DBERCHZ3','DBERDL','DBERDLB','DFKKKO','DFKKOPK','DFKKOPKC','DFKKOPKX','DFKKZK','DFKKZPE','DFKKZPT','DFKKZS','EABL','EABLG','EMDUSDRQHEAD','EMDUSDRQINPUT','EMDUSDRQITEM','EMDUSDRQRESULT','ERCHC','ERCHO','ERDB','ERDO','ETTIFB','ETTIFN']\n\n# LIST OF ALL PII TABLES\npiitablelist = ['BCONT','DFKKCOLL','DFKKCOLLH','DFKKLOCKS','DFKKLOCKSH','DFKKOP','DFKKOPCOLL','DFKKOPW','DFKKZP','DFKKZV','ERCH','ERDK','FKKMACTIVITIES','FKKMAKO','FKKMAKT','FKKMAZE']\n\nif(pii_or_nonpii == 'nonpii'):\n    tablelist2 = nonpiitablelist\n    print(tablelist2)\nelif(pii_or_nonpii == 'pii'):\n    tablelist2 = piitablelist\n    print(tablelist2)\n\n# EFFECTIVE TABLE LIST\ntablelist = [value for value in tablelist1 if value in tablelist2]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/cods_nonprod_compose\n[&#39;CDHDR&#39;, &#39;CDPOS&#39;, &#39;DBERCHV&#39;, &#39;DBERCHZ1&#39;, &#39;DBERCHZ2&#39;, &#39;DBERCHZ3&#39;, &#39;DBERDL&#39;, &#39;DBERDLB&#39;, &#39;DFKKKO&#39;, &#39;DFKKOPK&#39;, &#39;DFKKOPKC&#39;, &#39;DFKKOPKX&#39;, &#39;DFKKZK&#39;, &#39;DFKKZPE&#39;, &#39;DFKKZPT&#39;, &#39;DFKKZS&#39;, &#39;EABL&#39;, &#39;EABLG&#39;, &#39;EMDUSDRQHEAD&#39;, &#39;EMDUSDRQINPUT&#39;, &#39;EMDUSDRQITEM&#39;, &#39;EMDUSDRQRESULT&#39;, &#39;ERCHC&#39;, &#39;ERCHO&#39;, &#39;ERDB&#39;, &#39;ERDO&#39;, &#39;ETTIFB&#39;, &#39;ETTIFN&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638526,"submitTime":1662980630034,"finishTime":1662980638596,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",648]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c645020d-7c5d-4865-9645-9aed2dd46a9c"},{"version":"CommandV1","origId":2709619314154604,"guid":"a094f41e-bad8-4de6-945a-26416f6850a9","subtype":"command","commandType":"auto","position":6.0,"command":"# IF TABLE LIST IS ENTERED MANUALLY FROM WIDGET THEN USE MANUAL TABLE LIST ELSE USE AVAILABLE TABLES LIST \n\nif(manual_list):\n    tablelist = manual_list\n    print(tablelist)\n    #LOG INFO\n    logger.info(\"Tablelist for current execution : \" + str(tablelist))\nelse:\n    tablelist\n    print(tablelist)\n    #LOG INFO\n    logger.info(\"Tablelist for current execution : \" + str(tablelist))\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&#39;ERDO&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980638605,"submitTime":1662980630063,"finishTime":1662980638625,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",44]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"39fbe0b8-7d97-46d0-ac37-fd9189c7725a"},{"version":"CommandV1","origId":2709619314154605,"guid":"8a0a1644-e7f6-4ef2-a4eb-56d3bc073d15","subtype":"command","commandType":"auto","position":7.0,"command":"# FOR ALL THE TABLES IN A LIST EXECUTE DATA PREPERATION FOLLOWED BY TABLE CREATION IN A LOOP\nlogger.info(\"----------------------------------------------------------------\")\n\ntry:  \n  for tablename in tablelist:\n      logger.info(\"Data Preperation Started for table : \" + tablename)\n      try:\n          dbutils.notebook.run(dataprepnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD ,\"table_name\" : tablename , \"staging_location\" : staging_location , \"curated_location\" : bronze_location , \"silver_location\" : silver_location ,\"metafilepath\" : metafilepath , \"dbfslogbasepath\" : dbfslogbasepath , \"runfornpreviousdays\" : runfornpreviousdays })\n          logger.info(\"Data Preperation Completed for table : \" + tablename)\n      except:\n          logger.error(\"Error occurred while Executing Data Preparation\")\n          logger.critical(\"Master NoteBook for Stream run Failed!\")\n          #dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)\n      \n      logger.info(\"Table Creation Started for table : \" + tablename)\n      try:\n          dbutils.notebook.run(tablecreationnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD , \"table_name\" : tablename , \"db_name\" : db_name , \"curated_location\" : silver_location ,\"metafilepath\" : metafilepath , \"dbfslogbasepath\" : dbfslogbasepath })\n          logger.info(\"Table Creation Completed for table : \" + tablename)\n          logger.info(\"----------------------------------------------------------------\")\n      except:        \n          logger.error(\"Error occurred while Executing Table Creation\")\n          logger.critical(\"Master NoteBook for Stream run Failed!\")\n          #dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)    \n      print(\"DONE WITH TABLE : \" + tablename)\nexcept:\n  dbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime) ","commandVersion":26,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DONE WITH TABLE : ERDO\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[{"jobId":938182692462400},{"jobId":497808726747717}],"startTime":1662980638632,"submitTime":1662980630072,"finishTime":1662980701611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",50]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"51f9d6cc-5f40-406f-822c-7ba6ebf04e5c"},{"version":"CommandV1","origId":2709619314154606,"guid":"9bfade68-77d0-440a-922c-17b8109175f9","subtype":"command","commandType":"auto","position":8.0,"command":"#LOG INFO\nlogger.info(\"Master NoteBook for Stream run Completed Successfully!\")\n\n#MOVE LOG FILE TO ADLS LOCATION\ndbutils.fs.mv(\"file:\" + dbfslogbasepath,execution_logs_loc2 + partitions + filenamewithtime)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[140]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1662980701618,"submitTime":1662980630101,"finishTime":1662980701795,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",41]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f06a2556-6a0f-45f3-a3b8-fe2d204af6e0"}],"dashboards":[],"guid":"e2df5976-614f-40cd-a239-874e3122469c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"dataprepnbpath":{"nuid":"de0c2dad-2451-45e6-bfd7-a794f709adba","currentValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD STREAM_DATA_PREPARATION","widgetInfo":{"widgetType":"text","name":"dataprepnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD STREAM_DATA_PREPARATION","label":"DATA PREP NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}}},"execution_logs_loc":{"nuid":"0603d259-bf0d-44af-9bfe-ae0f6cfbecf6","currentValue":"ISU_archive_support/execution_logs/stream_logs","widgetInfo":{"widgetType":"text","name":"execution_logs_loc","defaultValue":"ISU_archive_support/execution_logs/stream_logs","label":"EXECUTION LOGS LOC","options":{"widgetType":"text","validationRegex":null}}},"tablecreationnbpath":{"nuid":"bc08f7fb-9f0a-4641-9694-2adc5e052217","currentValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD Stream Dynamic Table Creation Using MetaTable","widgetInfo":{"widgetType":"text","name":"tablecreationnbpath","defaultValue":"/EDA/Data Engineer/POD_7_Dev/Archiving/Std_Stream/STD Stream Dynamic Table Creation Using MetaTable","label":"TABLE CREATION NOTEBOOK PATH","options":{"widgetType":"text","validationRegex":null}}},"db_name":{"nuid":"ae69bb2a-ffb3-4f68-9788-e2705defecd0","currentValue":"cods_nonprod_active","widgetInfo":{"widgetType":"text","name":"db_name","defaultValue":"cods_nonprod_active","label":"DATABASE NAME","options":{"widgetType":"text","validationRegex":null}}},"pii_or_nonpii":{"nuid":"427d84ab-ad03-481a-831b-ce0233299bdb","currentValue":"nonpii","widgetInfo":{"widgetType":"text","name":"pii_or_nonpii","defaultValue":"nonpii","label":"TABLE PREFERENCE( NONPII/PII)","options":{"widgetType":"text","validationRegex":null}}},"replicate_loc":{"nuid":"94b38a2e-929c-49b9-80ac-900e15e0be59","currentValue":"curated/ISU_archive/cods_nonprod_compose","widgetInfo":{"widgetType":"text","name":"replicate_loc","defaultValue":"curated/ISU_archive/cods_nonprod_compose","label":"REPLICATE-COMPOSE LOC","options":{"widgetType":"text","validationRegex":null}}},"runfornpreviousdays":{"nuid":"245c1e74-565d-4bfe-856d-652df85abe86","currentValue":"","widgetInfo":{"widgetType":"text","name":"runfornpreviousdays","defaultValue":"","label":"RUN FOR N PREVIOUS DAYS","options":{"widgetType":"text","validationRegex":null}}},"manual_list_str":{"nuid":"37ddf615-3eba-46ce-96b4-0788e8315763","currentValue":"ERDO","widgetInfo":{"widgetType":"text","name":"manual_list_str","defaultValue":"","label":"MANUAL TABLE LIST","options":{"widgetType":"text","validationRegex":null}}},"silver_location":{"nuid":"58864b72-78b9-4400-8bb7-13aafe491eef","currentValue":"curated/ISU_archive/silver","widgetInfo":{"widgetType":"text","name":"silver_location","defaultValue":"curated/ISU_archive/silver","label":"SILVER LOC","options":{"widgetType":"text","validationRegex":null}}},"metaadlspath":{"nuid":"c94e5245-32ad-413b-9e8d-47bdc419fc18","currentValue":"ISU_archive_support/metadata/Final_metadata.csv","widgetInfo":{"widgetType":"text","name":"metaadlspath","defaultValue":"ISU_archive_support/metadata/Final_metadata.csv","label":"METADATA FILE LOC","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"35cadc8d-3146-4987-8be0-23b53162ee19","currentValue":"No","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"No","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"bronze_location":{"nuid":"6498e5ad-59bb-423d-97c8-e874bc6a6347","currentValue":"curated/ISU_archive/bronze","widgetInfo":{"widgetType":"text","name":"bronze_location","defaultValue":"curated/ISU_archive/bronze","label":"BRONZE LOC","options":{"widgetType":"text","validationRegex":null}}},"env":{"nuid":"1329b87a-b008-4531-a7eb-753d588a2546","currentValue":"02","widgetInfo":{"widgetType":"text","name":"env","defaultValue":"02","label":"ADLS ENVIRONMENT","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}