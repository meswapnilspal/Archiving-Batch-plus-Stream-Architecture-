{"version":"NotebookV1","origId":2709619314156131,"name":"STREAM_DATA_PREPARATION_BACKUP","language":"python","commands":[{"version":"CommandV1","origId":2709619314156132,"guid":"5a6e8140-c22e-43bb-88ce-cbe02f400c7b","subtype":"command","commandType":"auto","position":0.5,"command":"%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"html","error":null,"workflows":[],"startTime":1660819416554,"submitTime":1660819416554,"finishTime":1660819425432,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8dc39775-467e-4ad3-949a-6f348e18a81b"},{"version":"CommandV1","origId":2709619314156133,"guid":"100cdc93-c7c2-4d83-b938-26cbdc4fa970","subtype":"script","commandType":"auto","position":0.5588235294117647,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c76bc472-f9e1-4d28-8a1e-2907938e7a9d"},{"version":"CommandV1","origId":2709619314156134,"guid":"d2ecd4db-bf24-4dc9-b002-8e0da89c39ed","subtype":"script","commandType":"auto","position":0.6176470588235294,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["curated_location","staging_location","silver_location","FULL_LOAD","table_name"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819416991,"submitTime":0,"finishTime":1660819417008,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"408d3751-a8fe-4d10-863e-a612fd2c25cb"},{"version":"CommandV1","origId":2709619314156135,"guid":"a1465382-4966-41ea-b1e9-51bef26ba457","subtype":"script","commandType":"auto","position":0.6764705882352942,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819417017,"submitTime":0,"finishTime":1660819417033,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"610f2271-c0b4-478e-9177-81b4fb820cdc"},{"version":"CommandV1","origId":2709619314156136,"guid":"470c68a5-d187-4ea1-b554-0cbc7b0b5e90","subtype":"script","commandType":"auto","position":0.7352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3dec7dcd-02ab-4cf9-8307-98a0804e28cf"},{"version":"CommandV1","origId":2709619314156137,"guid":"017176e1-e903-47a6-be51-40075f7fe4d1","subtype":"script","commandType":"auto","position":0.7941176470588236,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819417042,"submitTime":0,"finishTime":1660819417146,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1eb0be3-4eb5-4b26-9e34-3cdd1c9416ae"},{"version":"CommandV1","origId":2709619314156138,"guid":"d6d4b6c7-232b-4d28-b485-162783d06a7b","subtype":"script","commandType":"auto","position":0.8529411764705883,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819417153,"submitTime":0,"finishTime":1660819417186,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7515cb8a-2390-433d-82f9-f08339428da9"},{"version":"CommandV1","origId":2709619314156139,"guid":"e6814965-c163-4cf9-b969-276acdda4d66","subtype":"script","commandType":"auto","position":0.9117647058823529,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819417191,"submitTime":0,"finishTime":1660819423319,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7acbc3bf-56f6-453e-87c5-205bd5d7c3a9"},{"version":"CommandV1","origId":2709619314156140,"guid":"f480dd57-6de1-45cc-97ec-795e9c1fd90b","subtype":"script","commandType":"auto","position":0.9705882352941176,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819423327,"submitTime":0,"finishTime":1660819423538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a76313e7-cc6d-4bd4-ab37-d2803b38013a"},{"version":"CommandV1","origId":2709619314156141,"guid":"8e58cb7c-597e-4905-b762-cd81a0f3cfd3","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.window import Window\nimport fnmatch","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819425227,"submitTime":1660819416632,"finishTime":1660819425249,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"00194698-ce7f-4d6c-886d-53df7f5c63e2"},{"version":"CommandV1","origId":2709619314156142,"guid":"e560fd49-6e44-4c4b-a0a3-e8be7a3f17fd","subtype":"script","commandType":"auto","position":1.0294117647058822,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819423551,"submitTime":0,"finishTime":1660819423795,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6763","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9642f7c-8f2f-4c94-ae2a-90b8853a20db"},{"version":"CommandV1","origId":2709619314156143,"guid":"c46fbeec-1e9b-4aa7-a8e3-7111d9488883","subtype":"script","commandType":"auto","position":1.0882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ab037e98-0a1a-4d5d-9f80-f35377c2d64c"},{"version":"CommandV1","origId":2709619314156144,"guid":"5ee62248-9e9f-46c7-8cfe-61c8c10c5538","subtype":"script","commandType":"auto","position":1.1470588235294117,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819423813,"submitTime":0,"finishTime":1660819424237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6763","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a16ee1f2-423d-4b40-b5ec-530a2f1553e1"},{"version":"CommandV1","origId":2709619314156145,"guid":"a2095eb3-3fe2-4b89-b695-43333c732a02","subtype":"script","commandType":"auto","position":1.2058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"062a7e7a-4ef8-4240-b425-cb4c4364a870"},{"version":"CommandV1","origId":2709619314156146,"guid":"277918ed-100f-4091-8802-872464472386","subtype":"script","commandType":"auto","position":1.2647058823529411,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819424250,"submitTime":0,"finishTime":1660819425038,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3949","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"022c4015-c3c4-4d32-9615-feb025f59161"},{"version":"CommandV1","origId":2709619314156147,"guid":"7ae32ee4-43c7-44b5-94f8-f8a190cb324c","subtype":"script","commandType":"auto","position":1.3235294117647058,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b34c4ab9-29dc-4f9f-9e05-a13cbf3cd726"},{"version":"CommandV1","origId":2709619314156148,"guid":"182baaa6-fe0f-44fa-8b51-95c199e72ccc","subtype":"script","commandType":"auto","position":1.3823529411764706,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819425048,"submitTime":0,"finishTime":1660819425072,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5db8ed30-a618-4226-b742-90c474c075ce"},{"version":"CommandV1","origId":2709619314156149,"guid":"e0c91221-a54b-400d-85c1-b753d15ab297","subtype":"script","commandType":"auto","position":1.4411764705882353,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819425082,"submitTime":0,"finishTime":1660819425208,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5a6e8140-c22e-43bb-88ce-cbe02f400c7b"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6f8438f1-e915-463c-8eb3-5ea987856b0b"},{"version":"CommandV1","origId":2709619314156150,"guid":"cff1a873-d4f7-4091-b4fb-7cfa46bde2c1","subtype":"command","commandType":"auto","position":2.0,"command":"# Table Name\ndbutils.widgets.text(\"table_name\", \"\", \"table name\")\ntable_name = dbutils.widgets.get(\"table_name\")\n\n# Staging location ( source here )\ndbutils.widgets.text(\"staging_location\", \"\", \"staging location\")\nstaging_location = \"'\" + dbutils.widgets.get(\"staging_location\") + \"/\" + table_name.lower() + \"'\"\n\n# Curated location ( destination here )\ndbutils.widgets.text(\"curated_location\", \"\", \"curated location\")\ncurated_location = \"'\" + dbutils.widgets.get(\"curated_location\") + \"/\" + table_name + \"'\"\n\ndbutils.widgets.text(\"silver_location\", \"\", \"silver zone\")\nsilver_location = \"'\" + dbutils.widgets.get(\"silver_location\") + \"/\" + table_name + \"'\"\n\ndbutils.widgets.text(\"FULL_LOAD\", \"\", \"FULL LOAD\")\nFULL_LOAD = dbutils.widgets.get(\"FULL_LOAD\")","commandVersion":29,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"curated_location":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/bronze","table_name":"EMDUSDRQHEAD","staging_location":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/replicate","silver_location":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver","FULL_LOAD":"Yes"},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}},"table_name":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}},"staging_location":{"widgetType":"text","name":"staging_location","defaultValue":"","label":"staging location","options":{"widgetType":"text","validationRegex":null}},"silver_location":{"widgetType":"text","name":"silver_location","defaultValue":"","label":"silver zone","options":{"widgetType":"text","validationRegex":null}},"FULL_LOAD":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660916450554,"submitTime":1660916450491,"finishTime":1660916450581,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"44ac3d21-d0db-4b03-8935-427b16c4755b"},{"version":"CommandV1","origId":2709619314156151,"guid":"822f94b8-4cab-4a5b-86e2-54b341f71459","subtype":"command","commandType":"auto","position":3.0,"command":"print(table_name)\nprint(staging_location)\nprint(curated_location)","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">EMDUSDRQHEAD\n&#39;abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/replicate/emdusdrqhead&#39;\n&#39;abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/bronze/EMDUSDRQHEAD&#39;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819425287,"submitTime":1660819416651,"finishTime":1660819425309,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",231]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"61367c5d-46a0-4bee-836c-9eb531e946cf"},{"version":"CommandV1","origId":2709619314156152,"guid":"3f3a1f66-00e3-4089-830d-8f93557e6aba","subtype":"command","commandType":"auto","position":3.5,"command":"# staging_location = 'abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/replicate/dberchz3'","commandVersion":8,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819425317,"submitTime":1660819416659,"finishTime":1660819425336,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"82e7957e-97a2-41b7-babb-1025c0e3814f"},{"version":"CommandV1","origId":2709619314156153,"guid":"4123f406-285b-4f34-8cca-dc4b4884fd1b","subtype":"command","commandType":"auto","position":4.0,"command":"s = \"newdf = spark.readStream.option('ignoreChanges', 'true').format('delta').load(\" + staging_location + \")\"\nexec(s)\n\n# newdf = spark.readStream.option('inferSchema','True').format('delta').load(staging_location)\n","commandVersion":57,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"newdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"hdr__created_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__modified_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__oper","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__ts","nullable":true,"type":"timestamp"},{"metadata":{},"name":"mandt","nullable":true,"type":"string"},{"metadata":{},"name":"mdusrequestid","nullable":true,"type":"string"},{"metadata":{},"name":"process","nullable":true,"type":"string"},{"metadata":{},"name":"status","nullable":true,"type":"string"},{"metadata":{},"name":"priority","nullable":true,"type":"string"},{"metadata":{},"name":"timezone","nullable":true,"type":"string"},{"metadata":{},"name":"anlage","nullable":true,"type":"string"},{"metadata":{},"name":"abrdats","nullable":true,"type":"string"},{"metadata":{},"name":"abrvorg","nullable":true,"type":"string"},{"metadata":{},"name":"mdus","nullable":true,"type":"string"},{"metadata":{},"name":"erdat","nullable":true,"type":"string"},{"metadata":{},"name":"ernam","nullable":true,"type":"string"},{"metadata":{},"name":"aedat","nullable":true,"type":"string"},{"metadata":{},"name":"aenam","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/replicate/emdusdrqhead"}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819425347,"submitTime":1660819416668,"finishTime":1660819426196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ae1eee82-e61c-4d12-83ba-642a96758866"},{"version":"CommandV1","origId":2709619314156154,"guid":"4ad69d30-3dff-4c1f-8b1a-674bdaa6d5ea","subtype":"command","commandType":"auto","position":4.5,"command":"%run ../OTL/Load_Metadata","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"html","error":null,"workflows":[],"startTime":1660819416677,"submitTime":1660819416677,"finishTime":1660819426605,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0a908e1b-5353-4cdd-af31-2ec4f2f6d82d"},{"version":"CommandV1","origId":2709619314156155,"guid":"6d67b34f-b1c1-4e16-a168-3cac7ab1b962","subtype":"script","commandType":"auto","position":4.75,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819426204,"submitTime":0,"finishTime":1660819426225,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4ad69d30-3dff-4c1f-8b1a-674bdaa6d5ea"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c72dfa99-5a5d-4e02-9824-1b5323724f9e"},{"version":"CommandV1","origId":2709619314156156,"guid":"124a5cdb-26ee-4279-b16d-ed25efec0432","subtype":"command","commandType":"auto","position":4.75,"command":"metadf = load_metadata_df()","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"metadf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819426278,"submitTime":1660819416696,"finishTime":1660819426616,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ff2f49d1-8477-4b7b-a582-be1ac044093a"},{"version":"CommandV1","origId":2709619314156157,"guid":"0b6094ae-35ec-4cbb-8650-737b43fc5a08","subtype":"command","commandType":"auto","position":4.875,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9420152f-bf82-43e6-ab91-5f08b1236581"},{"version":"CommandV1","origId":2709619314156158,"guid":"0eab067a-84fa-4157-a8be-21ea618b51ef","subtype":"script","commandType":"auto","position":5.0,"command":"","commandVersion":40,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819426231,"submitTime":0,"finishTime":1660819426252,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4ad69d30-3dff-4c1f-8b1a-674bdaa6d5ea"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b79b8f9b-d062-4fd3-b310-8342a785c7a0"},{"version":"CommandV1","origId":2709619314156159,"guid":"9313fb5f-03c3-4cd0-8773-8cf71d73d4c6","subtype":"command","commandType":"auto","position":5.0,"command":"def generate_code_for_casting_columns_based_on_metadata(metadf,table_name,dfname,newdfname):\n  z = str(\"\")\n  cols = metadf.select(\"Field_Name\",\"delta_types\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[0]).collect()\n  col_types = metadf.select(\"Field_Name\",\"delta_types\").where(col(\"Table_Name\")==table_name).rdd.map(lambda x : x[1]).collect()\n  for i,j in zip(cols,col_types):\n    i = '\"' + i + '\"'\n    j = '\"' + j + '\"'\n    z = z + ('.withColumn(' + i + ',col(' + i + ').cast(' + j + '))')\n  return(newdfname + ' = ' + dfname + z)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819426623,"submitTime":1660819416719,"finishTime":1660819426645,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9ca9c4e-1998-407f-bafb-2f83db370ba0"},{"version":"CommandV1","origId":2709619314156160,"guid":"a8e3f451-ccbb-4f02-9e99-2e5a38260f11","subtype":"script","commandType":"auto","position":5.25,"command":"","commandVersion":104,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Your Metadata dataframe is loaded\nUse following syntax to grab it\n &lt;new dataframe&gt; = load_metadata_df(&lt;path of metadata csv&gt;) \n\n\nNOTE : csv path parameter is optional as Functions uses default path\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819426258,"submitTime":0,"finishTime":1660819426273,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4ad69d30-3dff-4c1f-8b1a-674bdaa6d5ea"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1beb3524-a0fc-41a8-b8e2-72722bf751f1"},{"version":"CommandV1","origId":2709619314156161,"guid":"2d416759-704c-4328-918b-df25c1c73809","subtype":"command","commandType":"auto","position":6.0,"command":"get_code = generate_code_for_casting_columns_based_on_metadata(metadf,table_name,'newdf','casted_df')\nexec(get_code)\nprint(get_code)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">casted_df = newdf.withColumn(&#34;MANDT&#34;,col(&#34;MANDT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MDUSREQUESTID&#34;,col(&#34;MDUSREQUESTID&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;PROCESS&#34;,col(&#34;PROCESS&#34;).cast(&#34;int&#34;)).withColumn(&#34;STATUS&#34;,col(&#34;STATUS&#34;).cast(&#34;int&#34;)).withColumn(&#34;PRIORITY&#34;,col(&#34;PRIORITY&#34;).cast(&#34;int&#34;)).withColumn(&#34;TIMEZONE&#34;,col(&#34;TIMEZONE&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ANLAGE&#34;,col(&#34;ANLAGE&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABRDATS&#34;,col(&#34;ABRDATS&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ABRVORG&#34;,col(&#34;ABRVORG&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;MDUS&#34;,col(&#34;MDUS&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ERDAT&#34;,col(&#34;ERDAT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;ERNAM&#34;,col(&#34;ERNAM&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AEDAT&#34;,col(&#34;AEDAT&#34;).cast(&#34;STRING&#34;)).withColumn(&#34;AENAM&#34;,col(&#34;AENAM&#34;).cast(&#34;STRING&#34;))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"casted_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"hdr__created_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__modified_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__oper","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__ts","nullable":true,"type":"timestamp"},{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{},"name":"AENAM","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819426651,"submitTime":1660819416728,"finishTime":1660819427117,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",1086]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6eb95d86-db80-4509-8fb2-e648565a12fe"},{"version":"CommandV1","origId":2709619314156162,"guid":"1a7495fb-c75e-4ef0-a640-7767619e4b2f","subtype":"command","commandType":"auto","position":7.0,"command":"def generate_code_for_creating_partition_column_based_on_type(metadf,table_name,dfname,newdfname):  \n  # get partition column from metatable\n  col1 = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n  #print(col1[0])\n  col2 = metadf.select('Partition_Key_Encoding').where(col('Table_Name')==table_name).where(col('Partition_Key') == 'Y').rdd.map(lambda x : x[0]).collect()\n  #print(col2[0])\n  column_for_partition_logic = col1[0]\n  partition_logic_encoding = int(col2[0])\n  \n  # decide partitioning logic based on encoding, and create partition column\n  Logic_1 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',expr('substring(\" + column_for_partition_logic + \",length(\" + column_for_partition_logic +\") - 2,length(\" + column_for_partition_logic + \"))'))\"\n  #print(Logic_1)\n  Logic_2 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',substring('\" + column_for_partition_logic + \"',1,6))\"\n  #print(Logic_2)\n  Logic_3 = newdfname + \" = \" + dfname + \".withColumn('partitioncol',substring('\" + column_for_partition_logic + \"',1,4))\"\n  Logic_4 = newdfname + \" = \" + dfname\n\n  if partition_logic_encoding == 1:\n    return(Logic_1)\n  elif partition_logic_encoding == 2:\n    return(Logic_2)\n  elif partition_logic_encoding == 3:\n    return(Logic_3)\n  else:\n    return(Logic_4)","commandVersion":15,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819427131,"submitTime":1660819416737,"finishTime":1660819427156,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4348697f-c60e-484d-b334-38b77c49bb88"},{"version":"CommandV1","origId":2709619314156163,"guid":"651c2a87-43b1-4708-8fc4-4064f1d5773e","subtype":"command","commandType":"auto","position":8.0,"command":"get_code = generate_code_for_creating_partition_column_based_on_type(metadf,table_name,'casted_df','replicate_df')\nprint(get_code)\nexec(get_code)","commandVersion":8,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">replicate_df = casted_df.withColumn(&#39;partitioncol&#39;,substring(&#39;ABRDATS&#39;,1,6))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"replicate_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"hdr__created_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__modified_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__oper","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__ts","nullable":true,"type":"timestamp"},{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{},"name":"AENAM","nullable":true,"type":"string"},{"metadata":{},"name":"partitioncol","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819427164,"submitTime":1660819416746,"finishTime":1660819427538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",120]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e7d1c16f-3c45-46a2-bf67-1baab44d8f41"},{"version":"CommandV1","origId":2709619314156164,"guid":"6182a3e5-0def-4204-bc16-31cd03272d0e","subtype":"command","commandType":"auto","position":8.25,"command":"replicate_flags_added = replicate_df.withColumn('EPOCH_FLAG',lit('CURRENT')).withColumn(\"EDA_Creation_date\",current_timestamp())","commandVersion":25,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"replicate_flags_added","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"hdr__created_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__modified_batch","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__oper","nullable":true,"type":"string"},{"metadata":{},"name":"hdr__ts","nullable":true,"type":"timestamp"},{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{},"name":"AENAM","nullable":true,"type":"string"},{"metadata":{},"name":"partitioncol","nullable":true,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819427545,"submitTime":1660819416755,"finishTime":1660819427577,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8a524b30-b1f2-43d0-92c2-148c5129e64f"},{"version":"CommandV1","origId":2709619314156165,"guid":"a8a4fdf4-d880-436d-b802-c9eeccd0cb33","subtype":"command","commandType":"auto","position":8.375,"command":"write_df = replicate_flags_added.drop('hdr__created_batch','hdr__modified_batch','hdr__oper','hdr__ts')","commandVersion":27,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"write_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{},"name":"AENAM","nullable":true,"type":"string"},{"metadata":{},"name":"partitioncol","nullable":true,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":false,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":false,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819427585,"submitTime":1660819416763,"finishTime":1660819427613,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e62d51c3-048a-4d9f-bb0a-bd0b238f1036"},{"version":"CommandV1","origId":2709619314156166,"guid":"6a6968c3-6373-4cd8-9795-6039cf8d6654","subtype":"command","commandType":"auto","position":9.0,"command":"curated_location1 = curated_location[1:-1]\nprint(curated_location1)\n\nsaveloc = f\"{curated_location1}\"\n# saveloc_cp = f\"{curated_location}_checkpoint\"\n\nstreamQuery = write_df.writeStream.trigger(once=True).format(\"delta\").partitionBy(\"partitioncol\").option(\"checkpointLocation\",f\"{saveloc}_checkpoint\").start(saveloc)\nstreamQuery.awaitTermination()","commandVersion":29,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">abfss://dev@[REDACTED].dfs.core.windows.net/curated/ISU_archive/bronze/EMDUSDRQHEAD\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819427624,"submitTime":1660819416774,"finishTime":1660819450412,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",111]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"425af22a-dba0-4fcc-b01e-9ada5c9fa421"},{"version":"CommandV1","origId":2709619314156167,"guid":"59f8dcc4-54f3-44f2-94da-680a6f33cfe6","subtype":"command","commandType":"auto","position":10.0,"command":"s = \"bronzedf = spark.read.format('delta').load(\" + curated_location + \")\"\nexec(s)","commandVersion":7,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"bronzedf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{},"name":"AENAM","nullable":true,"type":"string"},{"metadata":{},"name":"partitioncol","nullable":true,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":true,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/bronze/EMDUSDRQHEAD"}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819450420,"submitTime":1660819416782,"finishTime":1660819450474,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8bd366cb-b83f-4888-bce8-149a02e912b2"},{"version":"CommandV1","origId":2709619314156168,"guid":"f7caf1e4-f61b-4de1-9ecf-207702353f66","subtype":"command","commandType":"auto","position":10.5,"command":"print(bronzedf.count())","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1031847\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819450480,"submitTime":1660819416791,"finishTime":1660819450974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",35]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"859ff3a3-9224-484e-a1cf-6df0a655ea02"},{"version":"CommandV1","origId":2709619314156169,"guid":"875a0cd3-fc29-4d05-9ab4-92c9a8c7347a","subtype":"command","commandType":"auto","position":11.0,"command":"# duplicate removal\n\ndef duplicates_removal(dups_df):\n  df = dups_df.drop_duplicates()\n  keyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\n  orderbycol = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\").isNull()).rdd.map(lambda x : x[0]).collect()\n\n  windowspec = Window.partitionBy(keyfields).orderBy(orderbycol[0])\n  table_archive = df.withColumn(\"row_number\",row_number().over(windowspec)).select(\"*\").where(col(\"row_number\")==1)\n  #table_erroneous = df.withColumn(\"row_number\",row_number().over(windowspec)).select(\"*\").where(col(\"row_number\")>1)\n  return (table_archive,table_erroneous)","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1c5250fc-5a77-461c-bf2e-1978b9e2fec9"},{"version":"CommandV1","origId":2709619314156170,"guid":"d0d78a3d-5d50-4bf9-bdec-ca114df201b4","subtype":"command","commandType":"auto","position":11.5,"command":"if (str(FULL_LOAD) == 'Yes'):\n  s = 'bronzedf.limit(1).write.format(\"delta\").mode(\"overwrite\").partitionBy(\"partitioncol\").save(' + silver_location + ')'\n  exec(s)","commandVersion":28,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819450984,"submitTime":1660819416799,"finishTime":1660819452803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"aec7068f-b920-48f9-849f-25d6ab27cc42"},{"version":"CommandV1","origId":2709619314156171,"guid":"d01f4e21-a796-43fe-9e55-f202b4b11e83","subtype":"command","commandType":"auto","position":12.0,"command":"from delta.tables import *\nfrom pyspark.sql.functions import *\n\nkeyfields = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Key_Field\") == 'X').rdd.map(lambda x : x[0]).collect()\ncond = ''\nexitindex = len(keyfields)-1\nfor i in keyfields:\n    if keyfields.index(i) == exitindex:\n        cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i\n    else:\n        cond = cond + 'logs.' + i + ' = newDedupedLogs.' + i + ' AND '\n\ncond = cond + ' AND logs.EDA_Creation_date < newDedupedLogs.EDA_Creation_date'\n# print(cond)\n\n\n#deltaTable = DeltaTable.forPath(spark, curated_location)\ns = \"deltaTable = DeltaTable.forPath(spark, \" + silver_location + \")\"\nexec(s)\nnewDedupedLogs = bronzedf\n\ndeltaTable.alias(\"logs\").merge(\n    newDedupedLogs.alias(\"newDedupedLogs\"),\n    cond) \\\n  .whenMatchedUpdateAll() \\\n  .whenNotMatchedInsertAll() \\\n  .execute()","commandVersion":34,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"newDedupedLogs","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{},"name":"AENAM","nullable":true,"type":"string"},{"metadata":{},"name":"partitioncol","nullable":true,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":true,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/bronze/EMDUSDRQHEAD"}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819452811,"submitTime":1660819416808,"finishTime":1660819459657,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4702","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"da05fa7f-441b-4ff9-8c2b-dcadd86bde70"},{"version":"CommandV1","origId":2709619314156172,"guid":"5f68841c-ca2f-4d5f-8f74-feb2675e7284","subtype":"command","commandType":"auto","position":17.0,"command":"s = \"silverdf = spark.read.format('delta').load(\" + silver_location + \")\"\nexec(s)\n\nsilverdf.count()","commandVersion":12,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[58]: 1031848</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"silverdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"comment":" Client "},"name":"MANDT","nullable":true,"type":"string"},{"metadata":{"comment":" MDUS_Request_ID "},"name":"MDUSREQUESTID","nullable":true,"type":"string"},{"metadata":{"comment":" Creation_Process_for_MDUS_Request "},"name":"PROCESS","nullable":true,"type":"integer"},{"metadata":{"comment":" Status_of_MDUS_Request "},"name":"STATUS","nullable":true,"type":"integer"},{"metadata":{"comment":" Priority_of_MDUS_Request "},"name":"PRIORITY","nullable":true,"type":"integer"},{"metadata":{"comment":" Time_Zone "},"name":"TIMEZONE","nullable":true,"type":"string"},{"metadata":{"comment":" Installation "},"name":"ANLAGE","nullable":true,"type":"string"},{"metadata":{"comment":" Scheduled_Billing_Date "},"name":"ABRDATS","nullable":true,"type":"string"},{"metadata":{"comment":" Billing_Transaction "},"name":"ABRVORG","nullable":true,"type":"string"},{"metadata":{"comment":" Meter_Data_Unification_&_Synchronization "},"name":"MDUS","nullable":true,"type":"string"},{"metadata":{"comment":" Date_on_which_the_record_was_created "},"name":"ERDAT","nullable":true,"type":"string"},{"metadata":{"comment":" Name_of_Person_who_Created_the_Object "},"name":"ERNAM","nullable":true,"type":"string"},{"metadata":{"comment":" Changed_On "},"name":"AEDAT","nullable":true,"type":"string"},{"metadata":{"comment":" Name_of_Person_Who_Changed_Object "},"name":"AENAM","nullable":true,"type":"string"},{"metadata":{},"name":"partitioncol","nullable":true,"type":"string"},{"metadata":{},"name":"EPOCH_FLAG","nullable":true,"type":"string"},{"metadata":{},"name":"EDA_Creation_date","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver/EMDUSDRQHEAD"}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1660819459664,"submitTime":1660819416816,"finishTime":1660819460158,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",43]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ed62c58e-3701-46de-9b03-a4ec7f7d1a42"}],"dashboards":[],"guid":"82ee16f6-43a7-48e0-9b31-e60f2bcbe049","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location":{"nuid":"3814e204-ee20-4696-9337-ff89616cd3a1","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/bronze","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}}},"table_name":{"nuid":"e604d7ea-9761-410f-aea4-bf7c18a704bd","currentValue":"EMDUSDRQHEAD","widgetInfo":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}},"staging_location":{"nuid":"3193e479-c93e-4e1a-ae1c-fdb4477d91db","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/replicate","widgetInfo":{"widgetType":"text","name":"staging_location","defaultValue":"","label":"staging location","options":{"widgetType":"text","validationRegex":null}}},"silver_location":{"nuid":"cb95a823-346b-4fc5-87ff-37711c862ba1","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver","widgetInfo":{"widgetType":"text","name":"silver_location","defaultValue":"","label":"silver zone","options":{"widgetType":"text","validationRegex":null}}},"FULL_LOAD":{"nuid":"0d87261e-a357-44dd-bd00-816599c87d77","currentValue":"Yes","widgetInfo":{"widgetType":"text","name":"FULL_LOAD","defaultValue":"","label":"FULL LOAD","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}