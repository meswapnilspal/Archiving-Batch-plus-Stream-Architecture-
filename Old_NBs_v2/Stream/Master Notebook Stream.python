{"version":"NotebookV1","origId":2709619314156186,"name":"Master Notebook Stream","language":"python","commands":[{"version":"CommandV1","origId":2709619314156187,"guid":"40990eec-7a1f-42e7-9594-f4ed62ec2aa9","subtype":"command","commandType":"auto","position":3.8203125,"command":"","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"76015723-18fa-448e-8237-1205ad8f02f7"},{"version":"CommandV1","origId":2709619314156188,"guid":"41891cd7-628f-479e-abda-0a9787083b34","subtype":"command","commandType":"auto","position":7.640625,"command":"env = '02'\nbasepath = 'abfss://dev@dtecuprodedaadl' + env + '.dfs.core.windows.net/'","commandVersion":25,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348507929,"submitTime":1661348507867,"finishTime":1661348507951,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fb4b0740-c61b-430e-a09b-a19ee2cdb48e"},{"version":"CommandV1","origId":2709619314156189,"guid":"0ec5f864-e93d-41ea-b75d-721de04c5e2b","subtype":"command","commandType":"auto","position":9.55078125,"command":"replicate_loc = basepath + 'curated/ISU_archive/replicate'\nprint(replicate_loc)\nfileloc = dbutils.fs.ls(replicate_loc)\n\n# LIST OF TABLES FROM DIRECTORY \ntablelist1 = list(map(lambda p: p.name[:-1].upper(), fileloc))\n\n# LIST OF TABLES OF ALL NONPII TABLES\ntablelist2 = ['CDHDR','CDPOS','DBERCHV','DBERCHZ1','DBERCHZ2','DBERCHZ3','DBERDL','DBERDLB','DFKKKO','DFKKOPK','DFKKOPKC','DFKKOPKX','DFKKZK','DFKKZPE','DFKKZPT','DFKKZS','EABL','EABLG','EMDUSDRQHEAD','EMDUSDRQINPUT','EMDUSDRQITEM','EMDUSDRQRESULT','ERCHC','ERCHO','ERDB','ERDO','ETTIFB','ETTIFN']\n\n# EFFECTIVE TABLE LIST\ntablelist = [value for value in tablelist1 if value in tablelist2]","commandVersion":49,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/replicate\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348516708,"submitTime":1661348516667,"finishTime":1661348516850,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",108]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"196cd3e3-2d21-497d-a777-818c1e1dab89"},{"version":"CommandV1","origId":2709619314156190,"guid":"dd1b3552-7974-451d-97c9-8c41d6982718","subtype":"command","commandType":"auto","position":12.462890625,"command":"print(tablelist)","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&#39;CDHDR&#39;, &#39;CDPOS&#39;, &#39;DBERCHV&#39;, &#39;DBERCHZ1&#39;, &#39;DBERCHZ2&#39;, &#39;DBERCHZ3&#39;, &#39;DBERDL&#39;, &#39;DBERDLB&#39;, &#39;DFKKKO&#39;, &#39;DFKKOPKC&#39;, &#39;DFKKOPKX&#39;, &#39;DFKKZK&#39;, &#39;DFKKZPE&#39;, &#39;DFKKZPT&#39;, &#39;DFKKZS&#39;, &#39;EABL&#39;, &#39;EABLG&#39;, &#39;EMDUSDRQHEAD&#39;, &#39;EMDUSDRQINPUT&#39;, &#39;EMDUSDRQITEM&#39;, &#39;EMDUSDRQRESULT&#39;, &#39;ERCHC&#39;, &#39;ERCHO&#39;, &#39;ERDB&#39;, &#39;ERDO&#39;, &#39;ETTIFB&#39;, &#39;ETTIFN&#39;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348526459,"submitTime":1661348526417,"finishTime":1661348526484,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",544]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"53d636c2-f165-4185-997c-65b069892198"},{"version":"CommandV1","origId":2709619314156191,"guid":"f8271652-a9b7-4321-8f87-932f5c1be772","subtype":"command","commandType":"auto","position":13.9189453125,"command":"tablelist = ['DBERCHV', 'DBERCHZ1', 'DBERCHZ2', 'DBERCHZ3', 'DBERDL', 'DBERDLB', 'DFKKKO', 'DFKKOPKC', 'DFKKOPKX', 'DFKKZK', 'DFKKZPE', 'DFKKZPT', 'DFKKZS', 'EABL', 'EABLG', 'EMDUSDRQHEAD', 'EMDUSDRQINPUT', 'EMDUSDRQITEM', 'EMDUSDRQRESULT', 'ERCHC', 'ERCHO', 'ERDB', 'ERDO', 'ETTIFB', 'ETTIFN']","commandVersion":12,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348534336,"submitTime":1661348534288,"finishTime":1661348534355,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1b18924-98aa-4cf6-8e8d-d6921f2ffa9f"},{"version":"CommandV1","origId":2709619314156192,"guid":"c47e27b0-80ce-4539-9463-5c98e16a4264","subtype":"command","commandType":"auto","position":14.64697265625,"command":"# NEW\n\ntablelist = ['DFKKOPKX','DFKKZK','DFKKZPE','DFKKZPT','EABL']\n","commandVersion":13,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348540808,"submitTime":1661348540759,"finishTime":1661348540829,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1ae87b8b-2fbc-4cee-b834-cfd1a3939017"},{"version":"CommandV1","origId":2709619314156193,"guid":"9b15d69c-0e83-4cd7-911c-400404604ec3","subtype":"command","commandType":"auto","position":15.375,"command":"FULL_LOAD = \"Yes\"\ndb_name = \"cods_nonprod_active\"\nstaging_location = replicate_loc\nsilver_location = \"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver\"\nbronze_location = \"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/bronze\"\n#curated_location_err = \"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/archive/ERROR\"","commandVersion":73,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348551106,"submitTime":1661348551051,"finishTime":1661348551124,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e120cfc7-6310-4eab-9c8e-9c9a926ae4a9"},{"version":"CommandV1","origId":2709619314156194,"guid":"26414fc3-46cb-48ae-9384-26727ba5a9b3","subtype":"command","commandType":"auto","position":15.4375,"command":"tablecreationnbpath = '/EDA/Data Engineer/POD_7_Dev/Archiving/Stream/Stream Dynamic Table Creation Using MetaTable'\ndataprepnbpath = '/EDA/Data Engineer/POD_7_Dev/Archiving/Stream/STREAM_DATA_PREPARATION'","commandVersion":17,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661348560926,"submitTime":1661348560878,"finishTime":1661348560953,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ff1670ae-9d8c-474a-b014-5979ea1cbefa"},{"version":"CommandV1","origId":2709619314156195,"guid":"eb50156f-d6f7-4a2b-959f-b8424e1c5fe5","subtype":"command","commandType":"auto","position":15.5,"command":"for tablename in tablelist:\n    dbutils.notebook.run(dataprepnbpath, 0, { \"FULL_LOAD\" : FULL_LOAD ,\"table_name\" : tablename , \"staging_location\" : staging_location , \"curated_location\" : bronze_location , \"silver_location\" : silver_location })\n    dbutils.notebook.run(tablecreationnbpath, 0, { \"table_name\" : tablename , \"db_name\" : db_name , \"curated_location\" : silver_location })\n    print(\"DONE WITH TABLE : \" + tablename)","commandVersion":73,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">DONE WITH TABLE : DFKKOPKX\nDONE WITH TABLE : DFKKZK\nDONE WITH TABLE : DFKKZPE\nDONE WITH TABLE : DFKKZPT\nDONE WITH TABLE : EABL\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[{"jobId":270823788882318},{"jobId":921162960964703},{"jobId":294547294263121},{"jobId":1043557397013218},{"jobId":241393565437697},{"jobId":551295245263724},{"jobId":308019394970052},{"jobId":438628030776752},{"jobId":1041410438431146},{"jobId":979073705329730}],"startTime":1661348576386,"submitTime":1661348576333,"finishTime":1661350905609,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",154]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3fd9f19-fb0f-4b3d-a997-feb167ccabe7"},{"version":"CommandV1","origId":2709619314156196,"guid":"ab547576-eda0-4598-84d1-36dda3175bd1","subtype":"command","commandType":"auto","position":16.5,"command":"# dbutils.fs.rm('abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver/DBERCHV')","commandVersion":15,"state":"error","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"Cancelled","errorTraceType":"html","error":null,"workflows":[],"startTime":1661324582454,"submitTime":1661324582454,"finishTime":1661324585286,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f5425cab-266a-4e2f-b53a-3213671b59ea"},{"version":"CommandV1","origId":2709619314156197,"guid":"fc43bd56-f61a-4bec-99d5-8d3b160ae5e4","subtype":"command","commandType":"auto","position":17.5,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"edd8177d-e2a5-4d92-ad11-7760be848b16"}],"dashboards":[],"guid":"f3c53aed-6f18-438d-a548-7804de5dd17e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}