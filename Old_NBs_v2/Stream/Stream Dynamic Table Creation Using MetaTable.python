{"version":"NotebookV1","origId":2709619314156082,"name":"Stream Dynamic Table Creation Using MetaTable","language":"python","commands":[{"version":"CommandV1","origId":2709619314156083,"guid":"b9152c32-b506-44aa-981d-4c17e4056039","subtype":"command","commandType":"auto","position":0.5,"command":"%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258822459,"submitTime":1661258822459,"finishTime":1661258914286,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a148ab1d-dd46-4b99-8e29-522b88bf62a6"},{"version":"CommandV1","origId":2709619314156084,"guid":"9a6c1ee6-8711-4311-ba70-cbf81d22f4e4","subtype":"script","commandType":"auto","position":0.5588235294117647,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c76bc472-f9e1-4d28-8a1e-2907938e7a9d"},{"version":"CommandV1","origId":2709619314156085,"guid":"3a6af473-f732-47ba-9bf4-fc63a9af11d4","subtype":"script","commandType":"auto","position":0.6176470588235294,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["db_name","curated_location","table_name","curated_location_err"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258823301,"submitTime":0,"finishTime":1661258823315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"408d3751-a8fe-4d10-863e-a612fd2c25cb"},{"version":"CommandV1","origId":2709619314156086,"guid":"1afd21ff-bb0b-4f7b-8de9-0aa9fe56cc7c","subtype":"script","commandType":"auto","position":0.6764705882352942,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258823320,"submitTime":0,"finishTime":1661258823332,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"610f2271-c0b4-478e-9177-81b4fb820cdc"},{"version":"CommandV1","origId":2709619314156087,"guid":"d0642d94-61db-432d-b5ee-f46950215272","subtype":"script","commandType":"auto","position":0.7352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3dec7dcd-02ab-4cf9-8307-98a0804e28cf"},{"version":"CommandV1","origId":2709619314156088,"guid":"9d108a9a-a2fa-4187-b17b-f6df8e71fa12","subtype":"script","commandType":"auto","position":0.7941176470588236,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258823340,"submitTime":0,"finishTime":1661258823440,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1eb0be3-4eb5-4b26-9e34-3cdd1c9416ae"},{"version":"CommandV1","origId":2709619314156089,"guid":"d653491b-3b5d-47ae-a887-c815748b558c","subtype":"script","commandType":"auto","position":0.8529411764705883,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258823446,"submitTime":0,"finishTime":1661258823477,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7515cb8a-2390-433d-82f9-f08339428da9"},{"version":"CommandV1","origId":2709619314156090,"guid":"43685c9b-029c-4029-81d2-dd8c214fbea5","subtype":"script","commandType":"auto","position":0.9117647058823529,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258823482,"submitTime":0,"finishTime":1661258830420,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7acbc3bf-56f6-453e-87c5-205bd5d7c3a9"},{"version":"CommandV1","origId":2709619314156091,"guid":"a67308e3-fc73-4b66-9dbd-63ebcbede17b","subtype":"script","commandType":"auto","position":0.9705882352941176,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258830426,"submitTime":0,"finishTime":1661258830624,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a76313e7-cc6d-4bd4-ab37-d2803b38013a"},{"version":"CommandV1","origId":2709619314156092,"guid":"0d7a0dde-3b0d-4229-910e-bc4f0b3078a1","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.functions import *","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258914027,"submitTime":1661258822571,"finishTime":1661258914041,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7cc538c5-31ff-49f3-bee2-1635baa6633f"},{"version":"CommandV1","origId":2709619314156093,"guid":"a4ce3e63-088f-400f-a9c1-54d77bc3c61e","subtype":"script","commandType":"auto","position":1.0294117647058822,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258830633,"submitTime":0,"finishTime":1661258864920,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9642f7c-8f2f-4c94-ae2a-90b8853a20db"},{"version":"CommandV1","origId":2709619314156094,"guid":"0ad89c99-f420-47ba-9275-dd8346b00c40","subtype":"script","commandType":"auto","position":1.0882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ab037e98-0a1a-4d5d-9f80-f35377c2d64c"},{"version":"CommandV1","origId":2709619314156095,"guid":"431d5c33-3423-4e5a-b699-ba6f7b3aa9b5","subtype":"script","commandType":"auto","position":1.1470588235294117,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258864926,"submitTime":0,"finishTime":1661258909250,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a16ee1f2-423d-4b40-b5ec-530a2f1553e1"},{"version":"CommandV1","origId":2709619314156096,"guid":"f2688a00-675e-4d1d-b532-13f01c09c19a","subtype":"script","commandType":"auto","position":1.2058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"062a7e7a-4ef8-4240-b425-cb4c4364a870"},{"version":"CommandV1","origId":2709619314156097,"guid":"0aeb1783-3b0b-4419-8a58-4b4ec058f3a2","subtype":"script","commandType":"auto","position":1.2647058823529411,"command":"","commandVersion":1,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258909260,"submitTime":0,"finishTime":1661258913888,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"022c4015-c3c4-4d32-9615-feb025f59161"},{"version":"CommandV1","origId":2709619314156098,"guid":"b8c01f3c-ec28-42e6-ba80-07f5471e3d4d","subtype":"script","commandType":"auto","position":1.3235294117647058,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b34c4ab9-29dc-4f9f-9e05-a13cbf3cd726"},{"version":"CommandV1","origId":2709619314156099,"guid":"7279da07-f12a-4b99-a5e2-aeb58d16abd0","subtype":"script","commandType":"auto","position":1.3823529411764706,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258913895,"submitTime":0,"finishTime":1661258913917,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5db8ed30-a618-4226-b742-90c474c075ce"},{"version":"CommandV1","origId":2709619314156100,"guid":"2f77a504-1211-4873-bd64-ac5f36961d41","subtype":"script","commandType":"auto","position":1.4411764705882353,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258913924,"submitTime":0,"finishTime":1661258914021,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b9152c32-b506-44aa-981d-4c17e4056039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6f8438f1-e915-463c-8eb3-5ea987856b0b"},{"version":"CommandV1","origId":2709619314156101,"guid":"fd15004d-dce2-456e-86aa-0d0034d1427f","subtype":"command","commandType":"auto","position":2.0,"command":"dbutils.widgets.text(\"table_name\", \"\", \"table name\")\ntable_name = dbutils.widgets.get(\"table_name\")\n\ndbutils.widgets.text(\"db_name\", \"\", \"db name\")\ndb_name = dbutils.widgets.get(\"db_name\")\n\ndbutils.widgets.text(\"curated_location\", \"\", \"curated location\")\ncurated_location = \"'\" + dbutils.widgets.get(\"curated_location\") + \"/\" + table_name + \"/'\"\n\n# Curated location for Error Table\n# dbutils.widgets.text(\"curated_location_err\", \"\", \"curated location for error table\")\n# curated_location_err = \"'\" + dbutils.widgets.get(\"curated_location_err\") + \"/\" + table_name + \"/'\"","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"curated_location":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver","db_name":"cods_nonprod_active","table_name":"DBERCHZ3"},"addedWidgets":{"curated_location":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}},"db_name":{"widgetType":"text","name":"db_name","defaultValue":"","label":"db name","options":{"widgetType":"text","validationRegex":null}},"table_name":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661263302806,"submitTime":1661263302661,"finishTime":1661263302829,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"402bee3c-3da1-45e4-9e40-dedeecca86fb"},{"version":"CommandV1","origId":2709619314156102,"guid":"7bd4b9df-b120-4b88-bd09-acd480c2a039","subtype":"command","commandType":"auto","position":3.0,"command":"%run \"./Load_Metadata\"","commandVersion":5,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258822665,"submitTime":1661258822665,"finishTime":1661258914376,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d00966c3-d2eb-476a-8761-434375a79fe9"},{"version":"CommandV1","origId":2709619314156103,"guid":"b9613b1c-3d9c-4f7c-b597-0b721e6c813c","subtype":"script","commandType":"auto","position":3.25,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258914069,"submitTime":0,"finishTime":1661258914081,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7bd4b9df-b120-4b88-bd09-acd480c2a039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c72dfa99-5a5d-4e02-9824-1b5323724f9e"},{"version":"CommandV1","origId":2709619314156104,"guid":"ca18de01-f8df-4b55-a52c-fff3b11e14c0","subtype":"script","commandType":"auto","position":3.5,"command":"","commandVersion":40,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258914085,"submitTime":0,"finishTime":1661258914099,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7bd4b9df-b120-4b88-bd09-acd480c2a039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b79b8f9b-d062-4fd3-b310-8342a785c7a0"},{"version":"CommandV1","origId":2709619314156105,"guid":"dbcbfed3-59e4-4528-b0b4-86e0764d67b0","subtype":"script","commandType":"auto","position":3.75,"command":"","commandVersion":104,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Your Metadata dataframe is loaded\nUse following syntax to grab it\n &lt;new dataframe&gt; = load_metadata_df(&lt;path of metadata csv&gt;) \n\n\nNOTE : csv path parameter is optional as Functions uses default path\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258914104,"submitTime":0,"finishTime":1661258914117,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7bd4b9df-b120-4b88-bd09-acd480c2a039"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1beb3524-a0fc-41a8-b8e2-72722bf751f1"},{"version":"CommandV1","origId":2709619314156106,"guid":"ca408d5e-c23d-4e02-953e-7ec6910e9924","subtype":"command","commandType":"auto","position":4.0,"command":"metadf = load_metadata_df()","commandVersion":11,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"metadf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258914121,"submitTime":1661258822707,"finishTime":1661258922159,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1680","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ea9eb12c-c8ce-484e-a6a5-be8d1991963d"},{"version":"CommandV1","origId":2709619314156107,"guid":"d1ba3428-b3eb-4331-a7b3-2915c795fef6","subtype":"command","commandType":"auto","position":5.0,"command":"with_reqd_col_DF = metadf.select(\"*\").where(col(\"Table_Name\") == table_name )","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"with_reqd_col_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258922165,"submitTime":1661258822742,"finishTime":1661258922196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d9a45ac4-5aa6-4e3b-bca0-3ed41d5e0fa1"},{"version":"CommandV1","origId":2709619314156108,"guid":"b088dd9b-c4f6-49be-92a5-9850c3eeacdc","subtype":"command","commandType":"auto","position":6.0,"command":"# def generate_schema(column_name,types_name,comment,M_DF):\n#     columns_list = M_DF.select(column_name).rdd.map(lambda x : x[0]).collect()\n#     types_list = M_DF.select(types_name).rdd.map(lambda x : x[0]).collect()\n#     comments_list = M_DF.select(comment).rdd.map(lambda x : x[0]).collect()\n#     col1 =\"(\"\n#     col2 =\"\"\n#     for i,j,k in zip(columns_list,types_list,comments_list):\n#         col1 = col1 + \" \" + i + \" \" + j + \" \" + \"COMMENT\" + \" \" + \"'\" + \" \" + k + \" \" + \"'\" + \" \" + ', '\n#     partition_check = M_DF.select(\"Field_Name\").where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n#     if partition_check:\n#         return col1 + \"partitioncol STRING, EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \"\n#     else:\n#         return col1 + \"EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \"","commandVersion":65,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258922201,"submitTime":1661258822794,"finishTime":1661258922214,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0917ad3d-fc1e-4c3a-9ec2-66494ecfe20b"},{"version":"CommandV1","origId":2709619314156109,"guid":"bcc64686-82d2-4c65-99c7-1910aadddf7f","subtype":"command","commandType":"auto","position":6.5,"command":"def generate_schema(column_name,types_name,comment,M_DF):\n    columns_list = M_DF.select(column_name).rdd.map(lambda x : x[0]).collect()\n    types_list = M_DF.select(types_name).rdd.map(lambda x : x[0]).collect()\n#     comments_list = M_DF.select(comment).rdd.map(lambda x : x[0]).collect()\n    col1 =\"(\"\n    col2 =\"\"\n    for i,j in zip(columns_list,types_list):\n#         col1 = col1 + \" \" + i + \" \" + j + \" \" + \"COMMENT\" + \" \" + \"'\" + \" \" + k + \" \" + \"'\" + \" \" + ', '\n        col1 = col1 + \" \" + i + \" \" + j + \" \" + ', '\n    partition_check = M_DF.select(\"Field_Name\").where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n    if partition_check:\n        return col1 + \"partitioncol STRING, EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \"\n    else:\n        return col1 + \"EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \"","commandVersion":10,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258922220,"submitTime":1661258822822,"finishTime":1661258922238,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dd58ec1e-e092-4ffd-84f8-d2c607746d62"},{"version":"CommandV1","origId":2709619314156110,"guid":"42f1c7a2-9565-4c2e-8ab2-f2a3325e9329","subtype":"command","commandType":"auto","position":7.0,"command":"getschema = generate_schema(\"Field_Name\",\"delta_types\",\"Description\",with_reqd_col_DF)\nprint(getschema)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">( MANDT STRING ,  BELNR STRING ,  BELZEILE int ,  EQUNR STRING ,  GERAET STRING ,  MATNR STRING ,  ZWNUMMER int ,  INDEXNR int ,  ABLESGR STRING ,  ABLESGRV STRING ,  ATIM STRING ,  ATIMVA STRING ,  ADATMAX STRING ,  ATIMMAX STRING ,  THGDATUM STRING ,  ZUORDDAT STRING ,  REGRELSORT int ,  ABLBELNR STRING ,  LOGIKNR int ,  LOGIKZW int ,  ISTABLART STRING ,  ISTABLARTVA STRING ,  EXTPKZ STRING ,  BEGPROG STRING ,  ENDEPROG STRING ,  ABLHINW STRING ,  QDPROC int ,  MRCONNECT STRING ,  V_ZWSTAND double ,  N_ZWSTAND double ,  V_ZWSTNDAB double ,  N_ZWSTNDAB double ,  V_ZWSTVOR double ,  N_ZWSTVOR double ,  V_ZWSTDIFF double ,  N_ZWSTDIFF double , partitioncol STRING, EPOCH_FLAG STRING, EDA_Creation_date TIMESTAMP ) \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258922243,"submitTime":1661258822855,"finishTime":1661258954077,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",749]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bbd32ab6-f3ee-4d98-a7ba-712ca4f16223"},{"version":"CommandV1","origId":2709619314156111,"guid":"92ba8f8a-e2a1-4cda-8fa2-2c711029cee5","subtype":"command","commandType":"auto","position":8.0,"command":"#main_table = 'ISU_' + table_name + '_current'\n#mv comment# erroneous_table = 'ISU_' + table_name + '_arc_err'\n\n# print(main_table)\n# print(erroneous_table)\n#spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{main_table} {getschema} USING DELTA LOCATION {curated_location} \"\"\")\n#spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{main_table} {getschema} PARTITION BY (partitioncol string) USING DELTA LOCATION {curated_location} \"\"\")\n#mv comment# spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{erroneous_table} {getschema} USING DELTA LOCATION {curated_location_err} \"\"\")","commandVersion":36,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258954083,"submitTime":1661258822895,"finishTime":1661258954102,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0a0a8034-d280-4c4e-8166-3709f883944a"},{"version":"CommandV1","origId":2709619314156112,"guid":"51ace401-9cbd-449b-947a-97cf9f575039","subtype":"command","commandType":"auto","position":16.0,"command":"main_table = 'ISU_' + table_name + '_current'\nifpartitiontable = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\nprint(bool(ifpartitiontable))\nif ifpartitiontable:\n    spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{main_table} {getschema} USING DELTA PARTITIONED BY (partitioncol) LOCATION {curated_location} \"\"\")    \nelse:\n    spark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{main_table} {getschema} USING DELTA LOCATION {curated_location} \"\"\")","commandVersion":51,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">True\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258954107,"submitTime":1661258822926,"finishTime":1661258977702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",32]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"59565270-490f-49a8-b8c3-1ae8b44edae3"},{"version":"CommandV1","origId":2709619314156113,"guid":"bc4fd72c-ba95-4871-8dd9-1494e6010d9b","subtype":"command","commandType":"auto","position":17.0,"command":"# ifpartitiontable = metadf.select(\"Field_Name\").where(col(\"Table_Name\")==table_name).where(col(\"Partition_Key\") == 'Y').rdd.map(lambda x : x[0]).collect()\n# print(ifpartitiontable)","commandVersion":22,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661258977708,"submitTime":1661258822957,"finishTime":1661258977727,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"299","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b2f172c3-2b4a-4f08-9fe6-2f9b716c913f"},{"version":"CommandV1","origId":2709619314156114,"guid":"dcbe82af-f56b-4d3e-9032-d1f04d047df5","subtype":"command","commandType":"auto","position":18.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"01e4ea47-124c-4ff5-89bd-0bb51b9c99f2"}],"dashboards":[],"guid":"b50b829a-6bfb-422d-ab00-bb4c5ad5780e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"curated_location_err":{"nuid":"3b3bd77c-9139-4fa0-a958-f6cfe1ab0724","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/archive/ERROR","widgetInfo":{"widgetType":"text","name":"curated_location_err","defaultValue":"","label":"curated location for error table","options":{"widgetType":"text","validationRegex":null}}},"curated_location":{"nuid":"881dd8c8-0568-40b3-992f-4d0bad9e5b7b","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/curated/ISU_archive/silver","widgetInfo":{"widgetType":"text","name":"curated_location","defaultValue":"","label":"curated location","options":{"widgetType":"text","validationRegex":null}}},"db_name":{"nuid":"6a72d27d-7f3e-4d1d-a84b-b9f336c60208","currentValue":"cods_nonprod_active","widgetInfo":{"widgetType":"text","name":"db_name","defaultValue":"","label":"db name","options":{"widgetType":"text","validationRegex":null}}},"table_name":{"nuid":"07d73018-f0d6-4da6-8de2-f7ece67ebbca","currentValue":"DBERCHZ3","widgetInfo":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}