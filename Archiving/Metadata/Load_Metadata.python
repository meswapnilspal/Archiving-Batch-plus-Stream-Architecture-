{"version":"NotebookV1","origId":2937788264270974,"name":"Load_Metadata","language":"python","commands":[{"version":"CommandV1","origId":2937788264270975,"guid":"d502eef1-e83f-4bcc-a600-e4e3301b82e7","subtype":"command","commandType":"auto","position":5.5,"command":"from pyspark.sql.functions import *","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1658739828337,"submitTime":1658739784124,"finishTime":1658739828353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c72dfa99-5a5d-4e02-9824-1b5323724f9e"},{"version":"CommandV1","origId":2937788264270976,"guid":"5bcf27dd-3335-482f-85ee-68354c5d0187","subtype":"command","commandType":"auto","position":6.0,"command":"# NOTE : Default file path (metadat_path)does not need to be changed, it will get override while calling from master notebook\n\ndef load_metadata_df(metadata_path=\"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_archive_support/metadata/Final_metadata.csv\"):\n  metadataDF = spark.read.option(\"header\", \"true\").csv(metadata_path)\n  with_delta_types_DF = metadataDF.withColumn(\"delta_types\", when(col(\"Data_Type\") == None,\"STRING\")\n                                    .when(col(\"Data_Type\") == \"CLNT\",\"STRING\")\n                                    .when(col(\"Data_Type\") == \"CHAR\",\"STRING\")\n                                    .when(col(\"Data_Type\") == \"NUMC\",\"int\")\n                                    .when(col(\"Data_Type\") == \"DATS\",\"STRING\")\n                                    .when(col(\"Data_Type\") == \"UNIT\",\"STRING\")\n                                    .when(col(\"Data_Type\") == \"INT4\",\"double\")\n                                    .when(col(\"Data_Type\") == \"DEC\",\"double\")\n                                    .when(col(\"Data_Type\") == \"CURR\",\"double\")\n                                    .when(col(\"Data_Type\") == \"CUKY\",\"STRING\")\n                                    .otherwise(\"STRING\"))\n  return with_delta_types_DF","commandVersion":80,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1658739828362,"submitTime":1658739784132,"finishTime":1658739828399,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b79b8f9b-d062-4fd3-b310-8342a785c7a0"},{"version":"CommandV1","origId":2937788264270977,"guid":"0273ec73-e205-4429-a658-c72178667bda","subtype":"command","commandType":"auto","position":7.0,"command":"print(\"Your Metadata dataframe is loaded\")\nprint(\"Use following syntax to grab it\")\nprint(\" <new dataframe> = load_metadata_df(<path of metadata csv>) \")\nprint(\"\\n\")\nprint(\"NOTE : csv path parameter is optional as Functions uses default path\")","commandVersion":104,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Your Metadata dataframe is loaded\nUse following syntax to grab it\n &lt;new dataframe&gt; = load_metadata_df(&lt;path of metadata csv&gt;) \n\n\nNOTE : csv path parameter is optional as Functions uses default path\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1658739828407,"submitTime":1658739784139,"finishTime":1658739828425,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1beb3524-a0fc-41a8-b8e2-72722bf751f1"},{"version":"CommandV1","origId":2937788264270978,"guid":"d1789cd4-08af-4cda-859f-43a50a2c0144","subtype":"command","commandType":"auto","position":8.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7a79e239-0074-4c15-8051-2fe080852eb0"}],"dashboards":[],"guid":"aab69ae3-bd1f-4c97-b83d-0d59352c2b43","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}