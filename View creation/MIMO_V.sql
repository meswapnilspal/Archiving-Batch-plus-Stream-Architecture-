{"version":"NotebookV1","origId":2937788264270952,"name":"MIMO_V","language":"sql","commands":[{"version":"CommandV1","origId":2937788264270953,"guid":"22ea3c2c-701a-4687-8e27-d6facea4f9b8","subtype":"command","commandType":"auto","position":1.0,"command":"CREATE OR REPLACE TEMP VIEW UNION_DATA AS \nselect * \n,if(moveinDt < MICreatedOn, \"Retro\", \"\") as  RetroMI\n,days_between(moveinDt, MICreatedOn) as MIDaysDiff\n,leftstr(BEZUGSDAT, 4)\nfrom(\nselect EINZBELEG\n,VKONT\n,KUNDE\n,BEZUGSDAT\n,STORNOKZ\n,ADDADR\n,ERDAT\n,ERNAM\n,AEDAT\n,AENAM\n,LOEVM\n,date(BEZUGSDAT) as MoveinDt\n,date(ERDAT) as MICreatedOn\n,date(AEDAT) as MIChangedOn\n,IF(MoveinDt < MICreatedOn , \"RETRO\" , \"\") AS RetroMI\n,DAYS_BETWEEN(MoveinDt , MICreatedOn) AS MIDaysDiff\n,leftstr(BEZUGSDAT, 4) as YEAR\nFROM EEIN\nUNION ALL\nSELECT \nAUSZBELEG\n,KUNDE\n,VKONT\n,DEPARTUREDATE\n,STORAUSZ\n,ERDAT\n,AEDAT\n,ERNAM\n,AENAM\n,LOEVM\n,GPVKCHDATE\n,STORAUSZ\n,ERDAT\n,AEDAT\n,ERNAM\n,AENAM\n,LOEVM\n,GPVKCHDATE\n,DATE(DEPARTUREDATE) AS MOVEOUTDT\n,date(ERDAT) AS MOCreatedOn\n,DATE(AEDAT) AS MOChangedOn\n,IF(MOVEOUTDT < MOCreatedOn , \"RETRO\" , \"\") AS RetroMo\n,DAYS_BETWEEN(MOVEOUTDT , MOCreatedOn) AS MODaysDiff\n,leftstr(DEPARTUREDATE, 4) as YEAR\nFROM EAUS","commandVersion":342,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b66271b3-d45e-4aa9-bfc6-d27874a5b1b9"},{"version":"CommandV1","origId":2937788264270954,"guid":"a2644591-be5f-4586-86ab-4ead502f4389","subtype":"command","commandType":"auto","position":2.0,"command":"CREATE OR REPLACE TEMPORARY VIEW FINAL_VIEW AS \nSELECT *, (if VKNOT!= \" \", 1, 0) AS COUNT_1\nFROM UNION_DATA","commandVersion":53,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"609c29b1-e37b-45fa-b4b2-6ffcceb58885"}],"dashboards":[],"guid":"b5b8f446-dc02-4308-a361-a8b20e7e283c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}