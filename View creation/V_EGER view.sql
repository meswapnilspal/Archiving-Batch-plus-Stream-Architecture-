-- Databricks notebook source
CREATE VIEW V_EGER ( MANDT,
       EQUNR,
       BIS,
       AB,
       LOGIKNR,
       GERAET,
       MATNR,
       WERK,
       LAGER,
       ZWGRUPPE,
       EINBDAT,
       AUSBDAT,
       GERWECHS,
       DEVLOC,
       WGRUPPE,
       PRIMWNR1,
       SEKWNR1,
       PRIMWNR2,
       SEKWNR2,
       EAGRUPPE,
       KOMGRP,
       LOS,
       MESSDRCK,
       UEBERVER,
       BESITZ,
       BGLJAHR,
       WECHSEL,
       BGLSTAT,
       KZSTICH,
       SCHWGRAD,
       PLOMBDAT,
       HERST,
       BGLART,
       BGLNUM,
       UMBAUDAT,
       UMBAUGR,
       EICHFAEL,
       PARAMETR,
       PLOMBE,
       ERDAT,
       ERNAM,
       AEDAT,
       AENAM,
       ZSPANNS,
       ZSPANNP,
       ZSTROMS,
       ZSTROMP,
       BAUJJ,
       DEVGRP,
       SPARTE,
       TYPBZ,
       APPROVALNR,
       VLZEIT_DEV,
       KOMBINAT,
       BGLNETZ,
       ORDER_CODE,
       NOTIF_CODE,
       S_EQBS,
       PPM_METER,
       OBJNR,
       LOSSDTGROUP,
       RATING,
       P_VOLTAGE,
       S_VOLTAGE,
       AMS,
       AMCG_CAP_GRP,
       UII,
       MSG_ATTR_ID,
       CAP_ACT_GRP,
       EINBZEIT,
       AUSBZEIT,
       ZEITZONE ) AS SELECT
       T1.MANDT,
       T1.EQUNR,
       T3.BIS,
       T3.AB,
       T3.LOGIKNR,
       T2.SERNR,
       T2.MATNR,
       T2.WERK,
       T2.LAGER,
       T3.ZWGRUPPE,
       T3.EINBDAT,
       T3.AUSBDAT,
       T3.GERWECHS,
       T3.DEVLOC,
       T3.WGRUPPE,
       T3.PRIMWNR1,
       T3.SEKWNR1,
       T3.PRIMWNR2,
       T3.SEKWNR2,
       T1.EAGRUPPE,
       T1.KOMGRP,
       T1.LOS,
       T1.MESSDRCK,
       T1.UEBERVER,
       T1.BESITZ,
       T1.BGLJAHR,
       T1.WECHSEL,
       T1.BGLSTAT,
       T1.KZSTICH,
       T1.SCHWGRAD,
       T1.PLOMBDAT,
       T2.HERST,
       T1.BGLART,
       T1.BGLNUM,
       T1.UMBAUDAT,
       T1.UMBAUGR,
       T1.EICHFAEL,
       T1.PARAMETR,
       T1.PLOMBE,
       T2.ERDAT,
       T2.ERNAM,
       T1.AEDAT,
       T1.AENAM,
       T1.ZSPANNS,
       T1.ZSPANNP,
       T1.ZSTROMS,
       T1.ZSTROMP,
       T2.BAUJJ,
       T3.DEVGRP,
       T2.SPARTE,
       T2.TYPBZ,
       T1.APPROVALNR,
       T1.VLZEIT_DEV,
       T3.KOMBINAT,
       T1.BGLNETZ,
       T1.ORDER_CODE,
       T1.NOTIF_CODE,
       T2.S_EQBS,
       T3.PPM_METER,
       T2.OBJNR,
       T3.LOSSDTGROUP,
       T3.RATING,
       T3.P_VOLTAGE,
       T3.S_VOLTAGE,
       T3.AMS,
       T3.AMCG_CAP_GRP,
       T2.UII,
       T3.MSG_ATTR_ID,
       T3.CAP_ACT_GRP,
       T3.EINBZEIT,
       T3.AUSBZEIT,
       T3.ZEITZONE 
FROM EGERS T1,
       EQUI T2,
       EGERH T3 
WHERE T2.MANDT = T1.MANDT 
AND T2.EQUNR = T1.EQUNR 
AND T2.MANDT = T3.MANDT 
AND T2.EQUNR = T3.EQUNR 
AND T1.MANDT = T3.MANDT 
AND T1.EQUNR = T3.EQUNR 