{"version":"NotebookV1","origId":2937788264270907,"name":"CRM_INTERACTION_RECS_view creation","language":"scala","commands":[{"version":"CommandV1","origId":2937788264270908,"guid":"4c5bf8b6-15dc-4e37-ad23-8bed8e6f1de9","subtype":"command","commandType":"auto","position":1.375,"command":"spark.sql(\"\"\" create or replace temporary view CRMD_DHR_ACTIV_v as select GUID as OBJECT_GUID,\nCHANGED_AT as CHANGED_ON,\nCATEGORY as CATEGORY,\nPERSON_RESP as EMPLOYEE_RESP,\nPRIORITY as PRIORITY,\nDESCRIPTION_UC as DESCRIPTION,\nACTIVITY_PARTNER as ACTIVITYPARTNER,\nPROCESS_TYPE as TRANSACTION_TYPE,\nCONTACT_PERSON as CONTACT_PERS,\nDIRECTION as DIRECTION,\nFROMDATE as START_DATE,\nTODATE as END_DATE,\nSTAT_OPEN as OPEN,\nSTATUS as STATUS,\nUSER_STAT_PROC as STATUS_PROFILE,\nACT_TOT_DURA as DURATION_VALUE,\nACT_TOT_UNIT as TIME_UNIT\nfrom cdspocchange.CRMD_DHR_ACTIV \"\"\")","commandVersion":30,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"org.apache.spark.sql.AnalysisException: Table or view not found: cdspocchange.CRMD_DHR_ACTIV; line 18 pos 5;","errorTraceType":"html","error":"<div class=\"ansiout\">'Project ['GUID AS OBJECT_GUID#1454619, 'CHANGED_AT AS CHANGED_ON#1454620, 'CATEGORY AS CATEGORY#1454621, 'PERSON_RESP AS EMPLOYEE_RESP#1454622, 'PRIORITY AS PRIORITY#1454623, 'DESCRIPTION_UC AS DESCRIPTION#1454624, 'ACTIVITY_PARTNER AS ACTIVITYPARTNER#1454625, 'PROCESS_TYPE AS TRANSACTION_TYPE#1454626, 'CONTACT_PERSON AS CONTACT_PERS#1454627, 'DIRECTION AS DIRECTION#1454628, 'FROMDATE AS START_DATE#1454629, 'TODATE AS END_DATE#1454630, 'STAT_OPEN AS OPEN#1454631, 'STATUS AS STATUS#1454632, 'USER_STAT_PROC AS STATUS_PROFILE#1454633, 'ACT_TOT_DURA AS DURATION_VALUE#1454634, 'ACT_TOT_UNIT AS TIME_UNIT#1454635]\n+- 'UnresolvedRelation [cdspocchange, CRMD_DHR_ACTIV]\n\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:109)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1$adapted(CheckAnalysis.scala:95)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:192)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:191)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:191)\n\tat scala.collection.immutable.List.foreach(List.scala:392)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:191)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:95)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:92)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:180)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:203)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:223)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:200)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:91)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:171)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:171)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:92)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:89)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:81)\n\tat org.apache.spark.sql.execution.command.CreateViewCommand.run(views.scala:96)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:79)\n\tat org.apache.spark.sql.Dataset.$anonfun$logicalPlan$1(Dataset.scala:234)\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3709)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$5(SQLExecution.scala:116)\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:249)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$1(SQLExecution.scala:101)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:77)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:199)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3707)\n\tat org.apache.spark.sql.Dataset.&lt;init&gt;(Dataset.scala:234)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:104)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:101)\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:680)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:675)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-931331582115538:1)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-931331582115538:62)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-931331582115538:64)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$$iw$$iw$$iw.&lt;init&gt;(command-931331582115538:66)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$$iw$$iw.&lt;init&gt;(command-931331582115538:68)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$$iw.&lt;init&gt;(command-931331582115538:70)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read.&lt;init&gt;(command-931331582115538:72)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$.&lt;init&gt;(command-931331582115538:76)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$read$.&lt;clinit&gt;(command-931331582115538)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$eval$.$print(&lt;notebook&gt;:6)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff25.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:745)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1021)\n\tat scala.tools.nsc.interpreter.IMain.$anonfun$interpret$1(IMain.scala:574)\n\tat scala.reflect.internal.util.ScalaClassLoader.asContext(ScalaClassLoader.scala:41)\n\tat scala.reflect.internal.util.ScalaClassLoader.asContext$(ScalaClassLoader.scala:37)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:41)\n\tat scala.tools.nsc.interpreter.IMain.loadAndRunReq$1(IMain.scala:573)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:600)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:570)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:219)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.$anonfun$repl$1(ScalaDriverLocal.scala:204)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:789)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:742)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:204)\n\tat com.databricks.backend.daemon.driver.DriverLocal.$anonfun$execute$10(DriverLocal.scala:431)\n\tat com.databricks.logging.UsageLogging.$anonfun$withAttributionContext$1(UsageLogging.scala:239)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:62)\n\tat com.databricks.logging.UsageLogging.withAttributionContext(UsageLogging.scala:234)\n\tat com.databricks.logging.UsageLogging.withAttributionContext$(UsageLogging.scala:231)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:48)\n\tat com.databricks.logging.UsageLogging.withAttributionTags(UsageLogging.scala:276)\n\tat com.databricks.logging.UsageLogging.withAttributionTags$(UsageLogging.scala:269)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:48)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:408)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.$anonfun$tryExecutingCommand$1(DriverWrapper.scala:653)\n\tat scala.util.Try$.apply(Try.scala:213)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:645)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:598)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:337)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:219)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1643281223824,"submitTime":1643281223824,"finishTime":1643281230058,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"creation of  : CRMD_DHR_ACTIV_v","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"65b75e4c-7a7c-4ca9-87af-9fa242877d0e"},{"version":"CommandV1","origId":2937788264270909,"guid":"dc79e384-4560-4d75-9eb1-adc8507b6708","subtype":"command","commandType":"auto","position":1.40625,"command":"spark.sql(\"\"\" create or replace temporary view CRMD_ORDERADM_H_v as select GUID as OBJECT_GUID,\nOBJECT_ID as TRANSACTION_NO,\nPROCESS_TYPE as TRANSACTION_TYPE,\nPOSTING_DATE as POSTING_DATE,\nDESCRIPTION as DESCRIPTION,\nDESCR_LANGUAGE as DESCR_LANGUAGE,\nCREATED_AT as CREATED_AT,\nCREATED_BY as CREATED_BY,\nCHANGED_AT as CHANGED_AT,\nCHANGED_BY as CHANGED_BY,\nHEAD_CHANGED_AT as CHANGED_ON,\nOBJECT_TYPE as TRANS_CAT,\nARCHIVING_FLAG as CAN_BE_ARCHIVED,\nDESCRIPTION_UC as DESCRIPTION_UC,\nOBJECT_ID_OK as NUMBER_VALID,\nCRM_CHANGED_AT as CRM_CHANGED_ON\nfrom cdspocchange.CRMD_ORDERADM_H \"\"\")","commandVersion":6,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"org.apache.spark.sql.AnalysisException: Table or view not found: cdspocchange.CRMD_ORDERADM_H; line 17 pos 5;","errorTraceType":"html","error":"<div class=\"ansiout\">'Project ['GUID AS OBJECT_GUID#1471903, 'OBJECT_ID AS TRANSACTION_NO#1471904, 'PROCESS_TYPE AS TRANSACTION_TYPE#1471905, 'POSTING_DATE AS POSTING_DATE#1471906, 'DESCRIPTION AS DESCRIPTION#1471907, 'DESCR_LANGUAGE AS DESCR_LANGUAGE#1471908, 'CREATED_AT AS CREATED_AT#1471909, 'CREATED_BY AS CREATED_BY#1471910, 'CHANGED_AT AS CHANGED_AT#1471911, 'CHANGED_BY AS CHANGED_BY#1471912, 'HEAD_CHANGED_AT AS CHANGED_ON#1471913, 'OBJECT_TYPE AS TRANS_CAT#1471914, 'ARCHIVING_FLAG AS CAN_BE_ARCHIVED#1471915, 'DESCRIPTION_UC AS DESCRIPTION_UC#1471916, 'OBJECT_ID_OK AS NUMBER_VALID#1471917, 'CRM_CHANGED_AT AS CRM_CHANGED_ON#1471918]\n+- 'UnresolvedRelation [cdspocchange, CRMD_ORDERADM_H]\n\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:109)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1$adapted(CheckAnalysis.scala:95)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:192)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:191)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:191)\n\tat scala.collection.immutable.List.foreach(List.scala:392)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:191)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:95)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:92)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:180)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:203)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:223)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:200)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:91)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:171)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:171)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:92)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:89)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:81)\n\tat org.apache.spark.sql.execution.command.CreateViewCommand.run(views.scala:96)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:79)\n\tat org.apache.spark.sql.Dataset.$anonfun$logicalPlan$1(Dataset.scala:234)\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3709)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$5(SQLExecution.scala:116)\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:249)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$1(SQLExecution.scala:101)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:77)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:199)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3707)\n\tat org.apache.spark.sql.Dataset.&lt;init&gt;(Dataset.scala:234)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:104)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:101)\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:680)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:675)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-486899719500324:1)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-486899719500324:61)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-486899719500324:63)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$$iw$$iw$$iw.&lt;init&gt;(command-486899719500324:65)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$$iw$$iw.&lt;init&gt;(command-486899719500324:67)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$$iw.&lt;init&gt;(command-486899719500324:69)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read.&lt;init&gt;(command-486899719500324:71)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$.&lt;init&gt;(command-486899719500324:75)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$read$.&lt;clinit&gt;(command-486899719500324)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$eval$.$print(&lt;notebook&gt;:6)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff27.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:745)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1021)\n\tat scala.tools.nsc.interpreter.IMain.$anonfun$interpret$1(IMain.scala:574)\n\tat scala.reflect.internal.util.ScalaClassLoader.asContext(ScalaClassLoader.scala:41)\n\tat scala.reflect.internal.util.ScalaClassLoader.asContext$(ScalaClassLoader.scala:37)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:41)\n\tat scala.tools.nsc.interpreter.IMain.loadAndRunReq$1(IMain.scala:573)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:600)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:570)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:219)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.$anonfun$repl$1(ScalaDriverLocal.scala:204)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:789)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:742)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:204)\n\tat com.databricks.backend.daemon.driver.DriverLocal.$anonfun$execute$10(DriverLocal.scala:431)\n\tat com.databricks.logging.UsageLogging.$anonfun$withAttributionContext$1(UsageLogging.scala:239)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:62)\n\tat com.databricks.logging.UsageLogging.withAttributionContext(UsageLogging.scala:234)\n\tat com.databricks.logging.UsageLogging.withAttributionContext$(UsageLogging.scala:231)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:48)\n\tat com.databricks.logging.UsageLogging.withAttributionTags(UsageLogging.scala:276)\n\tat com.databricks.logging.UsageLogging.withAttributionTags$(UsageLogging.scala:269)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:48)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:408)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.$anonfun$tryExecutingCommand$1(DriverWrapper.scala:653)\n\tat scala.util.Try$.apply(Try.scala:213)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:645)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:598)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:337)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:219)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1643283129082,"submitTime":1643283129082,"finishTime":1643283130116,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"creation of CRMD_ORDERADM_H_v","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"eed30d5c-518e-4a2c-bce7-ac5220d45917"},{"version":"CommandV1","origId":2937788264270910,"guid":"807a6f46-5ff1-400f-85ab-c36c314e578b","subtype":"command","commandType":"auto","position":1.421875,"command":"spark.sql(\"\"\" create or replace temporary view CRMD_ACTIVITY_H_v as select GUID as OBJECT_GUID,\nCATEGORY as CATEGORY,\nDIRECTION as DIRECTION,\nEXTERN_ACT_ID as EXTERNAL_NO,\nADDRESS_ID as ACTIVITY_ADDRESS,\nCOMPLETION as percent_COMPLETE,\nACTIVITY_H_DUMMY as DUMMY,\nZZAFLD000013 as CLASS,\nZZAFLD000014 as ACTION,\nZZAFLD000015 as SOURCE_SYSTEM,\nZZCOMEMPHTXT as COMMUNICATION_MEDIU,\nZZBFLD00000H as BUSINESS_AGREEMENT,\nZZBFLD00000I as DEFECT_DESCRIPTION,\nZZESCALATION as ZZESCALATION,\nTASK as TASK,\nCLASS as ACTIVITY_CLASS\nfrom cdspocchange.CRMD_ACTIVITY_H \"\"\")","commandVersion":7,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"org.apache.spark.sql.AnalysisException: Table or view not found: cdspocchange.CRMD_ACTIVITY_H; line 17 pos 5;","errorTraceType":"html","error":"<div class=\"ansiout\">'Project ['GUID AS OBJECT_GUID#1473281, 'CATEGORY AS CATEGORY#1473282, 'DIRECTION AS DIRECTION#1473283, 'EXTERN_ACT_ID AS EXTERNAL_NO#1473284, 'ADDRESS_ID AS ACTIVITY_ADDRESS#1473285, 'COMPLETION AS percent_COMPLETE#1473286, 'ACTIVITY_H_DUMMY AS DUMMY#1473287, 'ZZAFLD000013 AS CLASS#1473288, 'ZZAFLD000014 AS ACTION#1473289, 'ZZAFLD000015 AS SOURCE_SYSTEM#1473290, 'ZZCOMEMPHTXT AS COMMUNICATION_MEDIU#1473291, 'ZZBFLD00000H AS BUSINESS_AGREEMENT#1473292, 'ZZBFLD00000I AS DEFECT_DESCRIPTION#1473293, 'ZZESCALATION AS ZZESCALATION#1473294, 'TASK AS TASK#1473295, 'CLASS AS ACTIVITY_CLASS#1473296]\n+- 'UnresolvedRelation [cdspocchange, CRMD_ACTIVITY_H]\n\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:109)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1$adapted(CheckAnalysis.scala:95)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:192)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:191)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:191)\n\tat scala.collection.immutable.List.foreach(List.scala:392)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:191)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:95)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:92)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:180)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:203)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:223)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:200)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:91)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:171)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:171)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:92)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:89)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:81)\n\tat org.apache.spark.sql.execution.command.CreateViewCommand.run(views.scala:96)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:79)\n\tat org.apache.spark.sql.Dataset.$anonfun$logicalPlan$1(Dataset.scala:234)\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3709)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$5(SQLExecution.scala:116)\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:249)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$1(SQLExecution.scala:101)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:77)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:199)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3707)\n\tat org.apache.spark.sql.Dataset.&lt;init&gt;(Dataset.scala:234)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:104)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:101)\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:680)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:845)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:675)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-486899719500325:1)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(command-486899719500325:61)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(command-486899719500325:63)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$$iw$$iw$$iw.&lt;init&gt;(command-486899719500325:65)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$$iw$$iw.&lt;init&gt;(command-486899719500325:67)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$$iw.&lt;init&gt;(command-486899719500325:69)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read.&lt;init&gt;(command-486899719500325:71)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$.&lt;init&gt;(command-486899719500325:75)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$read$.&lt;clinit&gt;(command-486899719500325)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$eval$.$print$lzycompute(&lt;notebook&gt;:7)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$eval$.$print(&lt;notebook&gt;:6)\n\tat linebe1d59610a664c9fa2ffad9951c0e6ff29.$eval.$print(&lt;notebook&gt;)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat scala.tools.nsc.interpreter.IMain$ReadEvalPrint.call(IMain.scala:745)\n\tat scala.tools.nsc.interpreter.IMain$Request.loadAndRun(IMain.scala:1021)\n\tat scala.tools.nsc.interpreter.IMain.$anonfun$interpret$1(IMain.scala:574)\n\tat scala.reflect.internal.util.ScalaClassLoader.asContext(ScalaClassLoader.scala:41)\n\tat scala.reflect.internal.util.ScalaClassLoader.asContext$(ScalaClassLoader.scala:37)\n\tat scala.reflect.internal.util.AbstractFileClassLoader.asContext(AbstractFileClassLoader.scala:41)\n\tat scala.tools.nsc.interpreter.IMain.loadAndRunReq$1(IMain.scala:573)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:600)\n\tat scala.tools.nsc.interpreter.IMain.interpret(IMain.scala:570)\n\tat com.databricks.backend.daemon.driver.DriverILoop.execute(DriverILoop.scala:219)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.$anonfun$repl$1(ScalaDriverLocal.scala:204)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExitInternal$.trapExit(DriverLocal.scala:789)\n\tat com.databricks.backend.daemon.driver.DriverLocal$TrapExit$.apply(DriverLocal.scala:742)\n\tat com.databricks.backend.daemon.driver.ScalaDriverLocal.repl(ScalaDriverLocal.scala:204)\n\tat com.databricks.backend.daemon.driver.DriverLocal.$anonfun$execute$10(DriverLocal.scala:431)\n\tat com.databricks.logging.UsageLogging.$anonfun$withAttributionContext$1(UsageLogging.scala:239)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:62)\n\tat com.databricks.logging.UsageLogging.withAttributionContext(UsageLogging.scala:234)\n\tat com.databricks.logging.UsageLogging.withAttributionContext$(UsageLogging.scala:231)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:48)\n\tat com.databricks.logging.UsageLogging.withAttributionTags(UsageLogging.scala:276)\n\tat com.databricks.logging.UsageLogging.withAttributionTags$(UsageLogging.scala:269)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:48)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:408)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.$anonfun$tryExecutingCommand$1(DriverWrapper.scala:653)\n\tat scala.util.Try$.apply(Try.scala:213)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:645)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.getCommandOutputAndError(DriverWrapper.scala:486)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:598)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:337)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:219)\n\tat java.lang.Thread.run(Thread.java:748)</div>","workflows":[],"startTime":1643283305249,"submitTime":1643283305249,"finishTime":1643283305968,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"creation of CRMD_ACTIVITY_H_v","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3ccbcfef-2ad1-4a0e-aa05-d0dbd416267a"},{"version":"CommandV1","origId":2937788264270911,"guid":"82bd1071-8d69-4488-b08a-f357e8dc63ea","subtype":"command","commandType":"auto","position":1.43359375,"command":"%sql\nCREATE OR REPLACE TEMPORARY VIEW CRM_V1 AS\nselect CRMD_DHR_ACTIV_V.OBJECT_GUID,\nCRMD_DHR_ACTIV_V.CHANGED_ON,\nCRMD_DHR_ACTIV_V.CATEGORY,\nCRMD_DHR_ACTIV_V.EMPLOYEE_RESP,\nCRMD_DHR_ACTIV_V.PRIORITY,\nCRMD_DHR_ACTIV_V.DESCRIPTION,\nCRMD_DHR_ACTIV_V.ACTIVITYPARTNER,\nCRMD_DHR_ACTIV_V.TRANSACTION_TYPE,\nCRMD_DHR_ACTIV_V.CONTACT_PERS,\nCRMD_DHR_ACTIV_V.DIRECTION,\nCRMD_DHR_ACTIV_V.START_DATE,\nCRMD_DHR_ACTIV_V.END_DATE,\nCRMD_DHR_ACTIV_V.OPEN,\nCRMD_DHR_ACTIV_V.STATUS,\nCRMD_DHR_ACTIV_V.STATUS_PROFILE,\nCRMD_DHR_ACTIV_V.DURATION_VALUE,\nCRMD_DHR_ACTIV_V.TIME_UNIT,\n\nCRMD_ORDERADM_H_V.TRANSACTION_NO,\nCRMD_ORDERADM_H_V.POSTING_DATE,\nCRMD_ORDERADM_H_V.DESCRIPTION_UC\nCRMD_ORDERADM_H_V.DESCR_LANGUAGE,\nCRMD_ORDERADM_H_V.CREATED_AT,\nCRMD_ORDERADM_H_V.CREATED_BY,\nCRMD_ORDERADM_H_V.CHANGED_AT,\nCRMD_ORDERADM_H_V.CHANGED_BY,\nCRMD_ORDERADM_H_V.CHANGED_ON,\nCRMD_ORDERADM_H_V.TRANS_CAT,\nCRMD_ORDERADM_H_V.CAN_BE_ARCHIVED,\nCRMD_ORDERADM_H_V.NUMBER_VALID,\nCRMD_ORDERADM_H_V.CRM_CHANGED_ON,\n\nCRMD_ACTIVITY_H_V.CATEGORY,\nCRMD_ACTIVITY_H_V.DIRECTION,\nCRMD_ACTIVITY_H_V.EXTERNAL_NO,\nCRMD_ACTIVITY_H_V.%_COMPLETE,\nCRMD_ACTIVITY_H_V.CLASS,\nCRMD_ACTIVITY_H_V.ACTION,\nCRMD_ACTIVITY_H_V.COMMUNICATION_MEDIU,\nCRMD_ACTIVITY_H_V.BUSINESS_AGREEMENT,\nCRMD_ACTIVITY_H_V.DEFECT_DESCRIPTION,\nCRMD_ACTIVITY_H_V.ZZESCALATION,\nCRMD_ACTIVITY_H_V.TASK,\nCRMD_ACTIVITY_H_V.ACTIVITY_CLASS,\nCRMD_ACTIVITY_H_V.ACTIVITY_ADDRESS,\nCRMD_ACTIVITY_H_V.SOURCE_SYSTEM\n\nCRM_ACTIVITY_TEXT.CLASS_TXT,\nCRM_ACTIVITY_TEXT.ACTION_TXT\n\nfrom CRMD_DHR_ACTIV_V left join CRMD_ORDERADM_H_V on CRMD_DHR_ACTIV_V.OBJECT_GUID = CRMD_ORDERADM_H_V.OBJECT_GUID\nleft join CRMD_ACTIVITY_H_V on CRMD_DHR_ACTIV_V.OBJECT_GUID = CRMD_ACTIVITY_H_V.OBJECT_GUID\nleft join CRM_ACTIVITY_TEXT \non CRMD_ACTIVITY_H_V.CLASS = CRM_ACTIVITY_TEXT.CCLASS and CRMD_ACTIVITY_H_V.ACTION = CRM_ACTIVITY_TEXT.ACTIVITY","commandVersion":85,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"OBJECT_GUID","type":"\"string\"","metadata":"{}"},{"name":"CHANGED_ON","type":"\"decimal(15,0)\"","metadata":"{}"},{"name":"CATEGORY","type":"\"string\"","metadata":"{}"},{"name":"EMPLOYEE_RESP","type":"\"string\"","metadata":"{}"},{"name":"PRIORITY","type":"\"string\"","metadata":"{}"},{"name":"DESCRIPTION","type":"\"string\"","metadata":"{}"},{"name":"ACTIVITYPARTNER","type":"\"string\"","metadata":"{}"},{"name":"TRANSACTION_TYPE","type":"\"string\"","metadata":"{}"},{"name":"CONTACT_PERS","type":"\"string\"","metadata":"{}"},{"name":"DIRECTION","type":"\"string\"","metadata":"{}"},{"name":"START_DATE","type":"\"string\"","metadata":"{}"},{"name":"END_DATE","type":"\"string\"","metadata":"{}"},{"name":"OPEN","type":"\"string\"","metadata":"{}"},{"name":"STATUS","type":"\"string\"","metadata":"{}"},{"name":"STATUS_PROFILE","type":"\"string\"","metadata":"{}"},{"name":"DURATION_VALUE","type":"\"decimal(13,0)\"","metadata":"{}"},{"name":"TIME_UNIT","type":"\"string\"","metadata":"{}"},{"name":"TRANSACTION_NO","type":"\"string\"","metadata":"{}"},{"name":"POSTING_DATE","type":"\"string\"","metadata":"{}"},{"name":"DESCR_LANGUAGE","type":"\"string\"","metadata":"{}"},{"name":"CREATED_AT","type":"\"decimal(15,0)\"","metadata":"{}"},{"name":"CREATED_BY","type":"\"string\"","metadata":"{}"},{"name":"CHANGED_AT","type":"\"decimal(15,0)\"","metadata":"{}"},{"name":"CHANGED_BY","type":"\"string\"","metadata":"{}"},{"name":"TRANS_CAT","type":"\"string\"","metadata":"{}"},{"name":"CAN_BE_ARCHIVED","type":"\"string\"","metadata":"{}"},{"name":"DESCRIPTION_UC","type":"\"string\"","metadata":"{}"},{"name":"NUMBER_VALID","type":"\"string\"","metadata":"{}"},{"name":"CRM_CHANGED_ON","type":"\"decimal(15,0)\"","metadata":"{}"},{"name":"EXTERNAL_NO","type":"\"string\"","metadata":"{}"},{"name":"ACTIVITY_ADDRESS","type":"\"string\"","metadata":"{}"},{"name":"percent_COMPLETE","type":"\"string\"","metadata":"{}"},{"name":"DUMMY","type":"\"string\"","metadata":"{}"},{"name":"CLASS","type":"\"string\"","metadata":"{}"},{"name":"ACTION","type":"\"string\"","metadata":"{}"},{"name":"SOURCE_SYSTEM","type":"\"string\"","metadata":"{}"},{"name":"COMMUNICATION_MEDIU","type":"\"string\"","metadata":"{}"},{"name":"BUSINESS_AGREEMENT","type":"\"string\"","metadata":"{}"},{"name":"DEFECT_DESCRIPTION","type":"\"string\"","metadata":"{}"},{"name":"ZZESCALATION","type":"\"string\"","metadata":"{}"},{"name":"TASK","type":"\"string\"","metadata":"{}"},{"name":"ACTIVITY_CLASS","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1636536324332,"submitTime":1636536324281,"finishTime":1636536324812,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Join 3","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4137eea3-d278-43b0-9636-669fdccc8888"},{"version":"CommandV1","origId":2937788264270912,"guid":"76f8c6c9-b326-459c-8671-4158da93e88b","subtype":"command","commandType":"auto","position":1.4345703125,"command":"%sql\nCREATE OR REPLACE TEMPORARY VIEW CRM_V2 AS\nSELECT v1.*, \nCRM_ACTIVITY_TEXT.CLASS_TXT AS CLASS_TXT_1 from CRM_V1  v1 left join CRM_ACTIVITY_TEXT\nON v1.CLASS = CRM_ACTIVITY_TEXT.CCLASS","commandVersion":54,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"join 4","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"03c0bf26-714b-4c49-b95f-0a3a59ed88da"},{"version":"CommandV1","origId":2937788264270913,"guid":"f4cf8196-371d-471a-aaaf-4df1f6ea7fa4","subtype":"command","commandType":"auto","position":2.4345703125,"command":"%sql\nCREATE OR REPLACE TEMPORARY VIEW CRM_V3 AS \nselect \nACTIVITY_CLASS,\nZZESCALATION,\nDEFECT_DESCRIPTION,\nBUSINESS_AGREEMENT,\nACTION,\nCLASS,\n%_COMPLETE,\nACTIVITY_ADDRESS,\nEXTERNAL_NO,\nCRM_CHANGED_ON,\nCHANGED_ON as ORD_CHANGED_ON,\nCHANGED_AT,\nCREATED_AT,\nCHANGED_ON,\nNUMBER_VALID,\nCAN_BE_ARCHIVED,\nTRANS_CAT,\nCHANGED_BY,\nCREATED_BY,\nDESCR_LANGUAGE,\nPOSTING_DATE,\nTRANSACTION_NO,\nTIME_UNIT,\nsum(DURATION_VALUE) as DURATION_VALUE,\nSTATUS_PROFILE,\nSTATUS,\nOPEN,\nEND_DATE,\nSTART_DATE,\nDIRECTION,\nCONTACT_PERS,\nTRANSACTION_TYPE,\nACTIVITYPARTNER,\nDESCRIPTION,\nPRIORITY,\nEMPLOYEE_RESP,\nCATEGORY,\nOBJECT_GUID,\nCATEGORY AS ACTIVITY_CATEGORY,\nDIRECTION AS ACTIVITY_DIRECTION,\nCOMMUNICATION_MEDIU,\nTASK,\nCLASS_TXT,\nACTION_TXT,\nCLASS_TXT,\nCLASS_TXT_1,\nSOURCE_SYSTEM, \ncount(OBJECT_GUID) as Interactions\nfrom CRM_V2\ngroup by\nACTIVITY_CLASS,\nZZESCALATION,\nDEFECT_DESCRIPTION,\nBUSINESS_AGREEMENT,\nACTION,\nCLASS,\n%_COMPLETE,\nACTIVITY_ADDRESS,\nEXTERNAL_NO,\nCRM_CHANGED_ON,\nCHANGED_ON ,\nCHANGED_AT,\nCREATED_AT,\nCHANGED_ON,\nNUMBER_VALID,\nCAN_BE_ARCHIVED,\nTRANS_CAT,\nCHANGED_BY,\nCREATED_BY,\nDESCR_LANGUAGE,\nPOSTING_DATE,\nTRANSACTION_NO,\nTIME_UNIT,\nSTATUS_PROFILE,\nSTATUS,\nOPEN,\nEND_DATE,\nSTART_DATE,\nDIRECTION,\nCONTACT_PERS,\nTRANSACTION_TYPE,\nACTIVITYPARTNER,\nDESCRIPTION,\nPRIORITY,\nEMPLOYEE_RESP,\nCATEGORY,\nOBJECT_GUID,\nCATEGORY ,\nDIRECTION ,\nCOMMUNICATION_MEDIU,\nTASK,\nCLASS_TXT,\nACTION_TXT,\nCLASS_TXT,\nCLASS_TXT_1\nSOURCE_SYSTEM ","commandVersion":62,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Aggregation","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"69cd8cbd-6cfc-4cd1-83de-7e8562ce02f5"},{"version":"CommandV1","origId":2937788264270914,"guid":"b533e4c8-793e-472b-a2cf-38d02cb89afc","subtype":"command","commandType":"auto","position":3.4345703125,"command":"%sql\nCREATE OR REPLACE VIEW CRM_V4 AS \nselect CRM_V3.*, \nif(DIRECTION = '0', 'INBOUND', if (DIRECTION = '1', 'OUTBOUND', '')) as DIRECTION_TXT\n,to_date(CHANGED_ON) as DATE_INTR\n,sum(CHANGED_ON)  as CHANGED_ON_DHR   ---?\n,localtoutc(utcnow(),'EST') as  CURR_TSTMP   ------current timestamp\n,now() as CURR_DT   --------current date\n,daysbetween(DATE_INTR,CURR_DT) as DIFF_DT\n,leftstr(string(\"CHANGED_ON\"), 4) as YEAR_INTR\nfrom CRM_V3","commandVersion":16,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c49e887a-ac3b-4902-8332-07231f3f82c0"},{"version":"CommandV1","origId":2937788264270915,"guid":"7b7bba35-83d4-4220-9aa2-8858b5a48f9b","subtype":"command","commandType":"auto","position":4.4345703125,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"be9bc4fd-be84-466e-ad23-25d555ffd70d"}],"dashboards":[],"guid":"ff9ded72-7981-4ebd-ae15-7da01e7834ca","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}