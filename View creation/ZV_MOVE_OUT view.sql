-- Databricks notebook source
CREATE VIEW ZV_MOVE_OUT ( MANDT,
       MOVE_OUT_DOC,
       BUSINESSPARTNER,
       CONTRACT_ACCT,
       CREATED_ON,
       CREATED_BY,
       CONTRACT,
       INSTALLATION,
       PREMISE,
       MOVE_OUT_DATE,
       CONNECTION_OBJ,
       ACTUAL_MO_DATE,
       AUTO_FINAL_BILL,
       PSTNG_DATE,
       FORM,
       PRINT_REQUEST,
       BPC_CCLASS,
       BPC_ACTIVITY,
       EFFECTIVE_DT,
       REVERSED,
       CHANGED_ON,
       CHANGED_BY,
       WANT_DATE ) AS SELECT
       T1.MANDT,
       T1.AUSZBELEG,
       T1.KUNDE,
       T1.VKONT,
       T1.ERDAT,
       T1.ERNAM,
       T2.VERTRAG,
       T2.ANLAGE,
       T2.VSTELLE,
       T2.AUSZDAT,
       T3.HAUS,
       T1.DEPARTUREDATE,
       T1.SCHLUSSRECH,
       T1.BUDAT,
       T1.FORMBEST,
       T1.DELAYED_PRINT,
       T1.BPC_CCLASS,
       T1.BPC_ACTIVITY,
       T1.GPVKCHDATE,
       T1.STORAUSZ,
       T1.AEDAT,
       T1.AENAM,
       T1.ZZWANTDATE 
FROM PI6.EAUS T1,
       PI6.EAUSV T2,
       PI6.EVBS T3 
WHERE T1.MANDT = T2.MANDT 
AND T1.AUSZBELEG = T2.AUSZBELEG 
AND T2.MANDT = T3.MANDT 
AND T2.VSTELLE = T3.VSTELLE