{"version":"NotebookV1","origId":2937788264272771,"name":"PPS - Outage Status","language":"python","commands":[{"version":"CommandV1","origId":2937788264272772,"guid":"e7e599a4-ba20-4e9a-891c-38f41a37c150","subtype":"command","commandType":"auto","position":1.0,"command":"\"/EDA/Analyst/Framework/Secrets-Databricks-Cache\"","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[1]: &#39;/EDA/Analyst/Framework/Secrets-Databricks-Cache&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359542,"submitTime":1645058357546,"finishTime":1645058359578,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",92]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3c39ca48-9633-4817-ae6e-7bac5dd851bc"},{"version":"CommandV1","origId":2937788264272773,"guid":"b9095789-538c-4a8d-8043-2310e19e1d06","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264272774,"guid":"fa11829e-ede8-4e40-b9ea-8fa12f678b21","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264272775,"guid":"6bb9c317-4838-4d8d-8a4c-2a5b2504a089","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264272776,"guid":"ec14b0d2-6771-4208-8386-57d635c2c6ea","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762204836,"submitTime":0,"finishTime":1639762204875,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264272777,"guid":"ecfff84d-eaa5-484a-9e0f-3796929e3cc5","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954307083,"submitTime":0,"finishTime":1639954307215,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264272778,"guid":"a53f2397-2027-4ae1-831e-476925a5d186","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["stop_date","start_date"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117985525,"submitTime":0,"finishTime":1642117985636,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264272779,"guid":"02b11b5a-4a7e-4d36-92cb-bd6a6deb3c59","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762204912,"submitTime":0,"finishTime":1639762204964,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264272780,"guid":"1a979308-bbae-4beb-bc49-68d9ffdd438c","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954307422,"submitTime":0,"finishTime":1639954307487,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264272781,"guid":"a3c07329-303a-4bad-8b71-9cf0347d587d","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117985789,"submitTime":0,"finishTime":1642117985843,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264272782,"guid":"6b266f48-a09e-4a96-a2b5-66bdadc69aac","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264272783,"guid":"a12f1166-cafd-410c-b495-45b463032a2f","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264272784,"guid":"9d2f2f97-59eb-4b27-8046-cc5bb66004a0","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264272785,"guid":"9efb3e92-352e-44d7-be83-baf80674d434","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762204975,"submitTime":0,"finishTime":1639762205575,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264272786,"guid":"a7a5caac-98fd-4663-9f10-dcf2d850693f","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954307513,"submitTime":0,"finishTime":1639954312065,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264272787,"guid":"e560b26b-2841-4540-8b50-c722f1739b8e","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117985895,"submitTime":0,"finishTime":1642117990804,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264272788,"guid":"4c70a413-e2f8-4902-a4c0-3c74655bb717","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":232,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762205719,"submitTime":0,"finishTime":1639762205796,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264272789,"guid":"aabbce3b-3e15-431f-a0a5-8614464c38f4","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":232,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954312265,"submitTime":0,"finishTime":1639954312327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264272790,"guid":"c7525cd1-6f6c-4350-9cf4-96f665c31c24","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":239,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117990957,"submitTime":0,"finishTime":1642117991027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264272791,"guid":"7ed58abd-0b5a-440a-a4c3-4c9c73d83197","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":126,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762205808,"submitTime":0,"finishTime":1639762216259,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264272792,"guid":"ad97870b-6861-4ebe-8d7d-e8c85425c36b","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":126,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954312340,"submitTime":0,"finishTime":1639954322144,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264272793,"guid":"f3c2ffd5-1aab-4f7b-b021-8cdd55fe1e71","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":127,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117991082,"submitTime":0,"finishTime":1642118001140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264272794,"guid":"08a4e7ae-6909-48a9-9e45-0570aebea585","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":46,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762216270,"submitTime":0,"finishTime":1639762216853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264272795,"guid":"7561121e-d0a0-4b2f-80af-2d148ef6b02b","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":46,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954322155,"submitTime":0,"finishTime":1639954323183,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264272796,"guid":"4466f876-c545-42ac-b264-0dfd1a88c198","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":47,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118001174,"submitTime":0,"finishTime":1642118002189,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264272797,"guid":"5e849365-9ade-4162-a243-45ffee352f63","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n# PPS Outage Analysis\n\n## Purpose\nTo create a timeline of outage status per meter and job by applying business rules that mirror the PPS outage system to analyze the number of meters in \"Don't Know\" status throughout an outage job\n\n## Deliverable\nWorkbook with widgets that can produce the analysis for a given date range.\n\n## How to run\n1. Enter a file name and ADLS folder path (with the last \"/\" on the folder path)\n2. Enter a start/stop date in the yyyy-mm-dd HH:MM:SS (keep leading 0s on single digit months, days, hours, minutes, seconds) Time is in EST\n3. Select or confirm  dte-cu-prod-premisepowerstatus-cluster-001 is the selected cluster and is running\n4. Run all and the file will be written to the specified location in ADLS\n5. For single meter numbers, go to the section \"* Run single profiles\" and uncomment and run the workbook up to that point\n\n## Steps\n1. Prepare data by pulling in needed tables and summarizing the voltage reads\n2. Create time intervals on the meters/outages in order to begin applying business rules\n3. Apply business rules for around if power status is \"Yes\", \"No\", \"Don't Know\"\n4. Apply the 95% power rule for impacted meters\n5. Group up into intervals to provide summarized data\n6. Write to file\n\n## Source Tables\n\n#### edw.location_outage_history\nInService jobs tied to premise. Must filter for date intervals (user input) and outage job TYCOD outage codes (provided by DTE)\n\n#### edw.cispersl2\nUsed here as the link table between premise and meter number\n\n#### edw.ami_voltage_intervals\nFive minute voltage reads for each meter. Currently using the eda_creation_date_localtime and taking the voltage from lastest 5 minute read prior to the eda_creation_date_localtime\n\n#### edw.nmnlvltg\nContains the nominal voltage for each meter\n\n#### edw.ami_elc_meter_events\nDifferent events, but for this analysis we only care about primary power up events\n\n#### edw.outcall\nOutage call table","commandVersion":456,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"aa2e6d1b-8090-477a-9077-46a93ce2aea1"},{"version":"CommandV1","origId":2937788264272798,"guid":"c7791e42-7000-4348-8fe1-d5e96589604d","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762216863,"submitTime":0,"finishTime":1639762220811,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264272799,"guid":"1136b652-a852-4c97-b678-ab2f7942a5b6","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954323193,"submitTime":0,"finishTime":1639954328457,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264272800,"guid":"52a0c1b7-19bc-42d5-9898-28d45e49bd3b","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118002223,"submitTime":0,"finishTime":1642118007435,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264272801,"guid":"afd74829-ebe7-4422-8b9b-14f24937cefb","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264272802,"guid":"e7d443d8-ce44-4f61-bb7a-14f67a82d80d","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264272803,"guid":"6ee9ea7d-b64c-44ea-956e-3e58c0404046","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264272804,"guid":"c7ef8c56-dd9c-4c20-8fda-2faea1ede253","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762220835,"submitTime":0,"finishTime":1639762221819,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264272805,"guid":"bc3ce200-0fd2-46a2-8766-77039d022e37","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954328476,"submitTime":0,"finishTime":1639954329643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264272806,"guid":"b6b23c7c-edb9-4313-bf19-0720f0e161f0","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118007478,"submitTime":0,"finishTime":1642118008550,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264272807,"guid":"51b889eb-d2da-4df2-a572-e1461d2215e9","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264272808,"guid":"e24064d8-97f5-4240-bf1c-f4bf6d57ea18","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264272809,"guid":"cee187e3-e02f-4ea8-930b-7bc23f317991","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264272810,"guid":"612abec7-28a3-4eb6-ab32-eae12789a30a","subtype":"command","commandType":"auto","position":1.75,"command":"dbutils.widgets.text(\"start_date\", \"\", \"Start Date\")\ndbutils.widgets.text(\"stop_date\", \"\", \"Stop Date\")\ndbutils.widgets.text(\"path\", \"\", \"Folder Path\")\ndbutils.widgets.text(\"name\", \"\", \"File Name\")","commandVersion":43,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{"name":{"widgetType":"text","name":"name","defaultValue":"","label":"File Name","options":{"widgetType":"text","validationRegex":null}},"stop_date":{"widgetType":"text","name":"stop_date","defaultValue":"","label":"Stop Date","options":{"widgetType":"text","validationRegex":null}},"path":{"widgetType":"text","name":"path","defaultValue":"","label":"Folder Path","options":{"widgetType":"text","validationRegex":null}},"start_date":{"widgetType":"text","name":"start_date","defaultValue":"","label":"Start Date","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359584,"submitTime":1645058357871,"finishTime":1645058359610,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2c467533-bc77-4ab9-9dcf-235b41201a1c"},{"version":"CommandV1","origId":2937788264272811,"guid":"050bce20-60ab-474f-8cd2-fffd804c4d5b","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":177,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762221837,"submitTime":0,"finishTime":1639762230127,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264272812,"guid":"f275ae3f-9673-420c-a43a-e6243e1eb9ba","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":177,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954329655,"submitTime":0,"finishTime":1639954338546,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264272813,"guid":"237ad30d-64fa-4ba9-877b-b40493b48d79","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":185,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118008602,"submitTime":0,"finishTime":1642118016873,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264272814,"guid":"94da704e-f701-4959-8a3a-88dd38a3d963","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264272815,"guid":"ccbef953-026c-4f5b-9ffa-a588a52c45e3","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264272816,"guid":"e136d76c-fc9d-4d74-ab1d-fc5ce41ad2e0","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264272817,"guid":"1107ec32-bfce-4331-a12c-c6c5dedf0892","subtype":"command","commandType":"auto","position":1.875,"command":"start_date = dbutils.widgets.get(\"start_date\")\nstop_date = dbutils.widgets.get(\"stop_date\")\npath = dbutils.widgets.get(\"path\")\nname = dbutils.widgets.get(\"name\")","commandVersion":28,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"name":"default","stop_date":"2021-07-09 17:00:00","path":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/Dummy_test/pps_outage/","start_date":"2021-07-06 17:00:00"},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359617,"submitTime":1645058358203,"finishTime":1645058359643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4bbb6e59-3bb9-40f9-90ec-56094095f4af"},{"version":"CommandV1","origId":2937788264272818,"guid":"56d051cc-540a-495a-9220-35f909cc84cf","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762230139,"submitTime":0,"finishTime":1639762230187,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264272819,"guid":"5db2aa47-2eb6-4288-bad3-dc25c41b4acc","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954338563,"submitTime":0,"finishTime":1639954338604,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264272820,"guid":"b28f6c1f-5f82-414a-84c1-e07884505289","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118016901,"submitTime":0,"finishTime":1642118016951,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264272821,"guid":"56092fc5-ca33-46ef-83a9-e557f913213b","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762230204,"submitTime":0,"finishTime":1639762230586,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264272822,"guid":"a3420da3-634c-49e0-aa29-93a45b741d26","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954338629,"submitTime":0,"finishTime":1639954338943,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264272823,"guid":"9689aeb6-3a5f-4c63-8458-f238a5b417d9","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118016984,"submitTime":0,"finishTime":1642118017343,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264272824,"guid":"40af751b-d97f-40f7-8560-6d51322bc177","subtype":"command","commandType":"auto","position":2.0,"command":"#start_date = \"2021-10-11 09:24:00\"\n#stop_date = \"2021-10-13 12:24:02\"","commandVersion":65,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359648,"submitTime":1645058358406,"finishTime":1645058359674,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f144a517-ca11-44ba-8706-d5659624e4ab"},{"version":"CommandV1","origId":2937788264272825,"guid":"5e293d9e-5c10-4cbd-aba4-eb2fb6a4066c","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n# A) Prep data","commandVersion":37,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"caa0e9ee-64c4-4c9f-9108-78ee4b69ba5e"},{"version":"CommandV1","origId":2937788264272826,"guid":"3129570e-0508-49f6-88fb-25802e38cd8c","subtype":"command","commandType":"auto","position":3.25,"command":"%md\n#### Read in functions","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b6d80caf-609f-488f-a35e-057f4ce9c3d6"},{"version":"CommandV1","origId":2937788264272827,"guid":"0245d13a-2fe3-4779-b104-f517364189c5","subtype":"command","commandType":"auto","position":3.5,"command":"from datetime import datetime, timedelta\nimport itertools\nfrom pyspark.sql.functions import col, substring, row_number, when, lit, to_timestamp, length, lag, greatest, last, sum, expr, min, unix_timestamp\nfrom pyspark.sql.window import Window\n\n#spark.conf.set(\"spark.databricks.io.cache.enabled\", True)","commandVersion":94,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359680,"submitTime":1645058358888,"finishTime":1645058359704,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"89c0e9dc-6d52-442b-a841-98e3cb1e4c4e"},{"version":"CommandV1","origId":2937788264272828,"guid":"9c9dd3aa-2620-41b3-b356-219b01c433e6","subtype":"command","commandType":"auto","position":4.0,"command":"date_fmt = \"%Y-%m-%d %H:%M:%S\"\nstart_dt = datetime.strptime(start_date, date_fmt) + timedelta(hours=-10)\nstop_dt = datetime.strptime(stop_date, date_fmt) + timedelta(hours=72)\n\nami_start_part_key = int(f\"{start_dt.year}{'{:02d}'.format(start_dt.month)}{'{:02d}'.format(start_dt.day)}\")\nami_stop_part_key = int(f\"{stop_dt.year}{'{:02d}'.format(stop_dt.month)}{'{:02d}'.format(stop_dt.day)}\")\n\ndate_range_key = list(map(lambda x: str(x), range(ami_start_part_key, ami_stop_part_key + 1)))\ndate_ym_key = list(set(map(lambda x: x[0:6], date_range_key)))\n\np_read_time_lt_query = \",\".join(date_range_key)\np_read_time_lt_ym_query = \",\".join(date_ym_key)","commandVersion":340,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359709,"submitTime":1645058359030,"finishTime":1645058359745,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad182cb4-e7b6-4bcb-8681-4994108ab24f"},{"version":"CommandV1","origId":2937788264272829,"guid":"8ae9fe25-6f91-48e8-a660-249ac1ed23d6","subtype":"command","commandType":"auto","position":4.5,"command":"%md\n#### List of outage TYCOD values","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5ee2d3f5-69ef-4801-8e88-9fc09bf59848"},{"version":"CommandV1","origId":2937788264272830,"guid":"678c6816-edc8-4918-91b2-01a71cbd3fce","subtype":"command","commandType":"auto","position":4.75,"command":"outage_types = ['CP','FUSE','ISO','OHCKT','OHTRANS','RECLO','UGCKT','UGPSC','UGTRANS', 'CUTCOND','OHDS','OHSWC','UGDS','UGFUSE', 'SDXL','ONELEG','XCURR','TEMPOHDS','TEMPFUSE']","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359751,"submitTime":1645058359247,"finishTime":1645058359783,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"989c8186-2b4a-4ab0-9559-17ff2ca81de5"},{"version":"CommandV1","origId":2937788264272831,"guid":"f85dac39-e70e-4bf8-a5b1-3ce2fadb5b18","subtype":"command","commandType":"auto","position":4.8125,"command":"%md\n#### Build storm timeline intervals","commandVersion":18,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4bf40d2a-058e-4c6b-92ff-3f53996a0b7f"},{"version":"CommandV1","origId":2937788264272832,"guid":"152a8def-df5b-4e83-9287-a6be79508da5","subtype":"command","commandType":"auto","position":4.828125,"command":"rng = itertools.count(0,1)\n  \ndate_rng = map(lambda x: {\"interval\": f\"+{x} hours\", \"time_step\": x, \"end_time_step\": x+1, \"interval_tm_start\": start_dt + timedelta(hours=x),\"interval_tm_stop\": start_dt + timedelta(hours=(x+1))}, rng)\ninterval_data = itertools.takewhile(lambda x: x[\"interval_tm_start\"] <= stop_dt, date_rng)\n\ninterval_df = spark.createDataFrame(interval_data)","commandVersion":288,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/spark/python/pyspark/sql/session.py:387: UserWarning: inferring schema from dict is deprecated,please use pyspark.sql.Row instead\n  warnings.warn(&#34;inferring schema from dict is deprecated,&#34;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058359790,"submitTime":1645058359467,"finishTime":1645058360106,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"217e40d8-0883-412c-b209-3b2f50be38f3"},{"version":"CommandV1","origId":2937788264272833,"guid":"35bf0f3e-23de-452e-a991-3b219e9f1613","subtype":"command","commandType":"auto","position":4.9140625,"command":"%md\n#### Build job timeline intervals","commandVersion":14,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f072b229-6a15-4f3a-96b4-6a6540b72871"},{"version":"CommandV1","origId":2937788264272834,"guid":"c721563f-8ca3-48a8-91a0-a4225addf20d","subtype":"command","commandType":"auto","position":4.95703125,"command":"interval_data = [{\"job_interval\": \"0 - 1 min\", \"job_time_step\": 0, \"job_end_time_step\": 60},\n                  {\"job_interval\": \"1 min - 1 hour\", \"job_time_step\": 60, \"job_end_time_step\": 3600},\n                  {\"job_interval\": \"1 hour - 2 hours\", \"job_time_step\": 3600, \"job_end_time_step\": 7200},\n                  {\"job_interval\": \"2 hours - 4 hours\", \"job_time_step\": 7200, \"job_end_time_step\": 14400},\n                  {\"job_interval\": \"4 hours - 12 hours\", \"job_time_step\": 14400, \"job_end_time_step\": 43200},\n                  {\"job_interval\": \"12 hours - 24 hours\", \"job_time_step\": 43200, \"job_end_time_step\": 86400},\n                  {\"job_interval\": \"24 hours - 48 hours\", \"job_time_step\": 86400, \"job_end_time_step\": 172800},\n                  {\"job_interval\": \"48 hours - 72 hours\", \"job_time_step\": 172800, \"job_end_time_step\": 259200},\n                  {\"job_interval\": \"72 hours - 96 hours\", \"job_time_step\": 259200, \"job_end_time_step\": 345600},\n                  {\"job_interval\": \"96 hours+\", \"job_time_step\": 345600, \"job_end_time_step\": 999999}]\n\njob_interval_data =spark.createDataFrame(interval_data)","commandVersion":75,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_interval_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058360114,"submitTime":1645058359705,"finishTime":1645058360213,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"774e3a43-0c6d-417e-870c-cef1ee80e3be"},{"version":"CommandV1","origId":2937788264272835,"guid":"59801a19-1072-4342-b8de-411c32164947","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n#### Filter outage interval for time period and outage events and convert to list of events","commandVersion":45,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7fa5b965-f998-4707-b6bd-7b49793b5296"},{"version":"CommandV1","origId":2937788264272836,"guid":"d57e0973-877a-4336-92e0-ce867bf8065d","subtype":"command","commandType":"auto","position":7.0,"command":"import pyspark.sql.functions as f\ncol = f.col\n\n#filtered_outage_intervals_df = spark.sql(\"\"\"select event_number, premise, tycod, out_dt_tm, on_dt_tm \nfiltered_outage_intervals_df2 = spark.sql(\"\"\"select *\n                                            from edw.location_outage_history\"\"\") \\\n  .filter(col(\"tycod\").isin(outage_types) & \\\n          (col(\"OUT_DT_TM\") >= start_date) & \\\n          (col(\"ON_DT_TM\") <= stop_date) & \\\n          (col(\"EVENT_STATUS\") != 'C') )\n","commandVersion":281,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_outage_intervals_df2","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"PREMISE","nullable":true,"type":"long"},{"metadata":{},"name":"EVENT_NUMBER","nullable":true,"type":"string"},{"metadata":{},"name":"REV_NUM","nullable":true,"type":"long"},{"metadata":{},"name":"CIRCUIT_OPERATION_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CIRCUIT","nullable":true,"type":"string"},{"metadata":{},"name":"SECT_POINT","nullable":true,"type":"string"},{"metadata":{},"name":"TYCOD","nullable":true,"type":"string"},{"metadata":{},"name":"CAUSE_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"OUT_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"ON_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"RESOLVED_UNRESOLVED_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CREW_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_CALLED_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CALLBACK_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_REP","nullable":true,"type":"string"},{"metadata":{},"name":"DATE_ADDED_TO_HIS","nullable":true,"type":"timestamp"},{"metadata":{},"name":"STILL_IN_INSERVICE","nullable":true,"type":"string"},{"metadata":{},"name":"EVENT_STATUS","nullable":true,"type":"string"},{"metadata":{},"name":"AMI_CALLED_CODE","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058360218,"submitTime":1645058359940,"finishTime":1645058360876,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"49d811d5-ef34-4a50-82b1-b5974195764d"},{"version":"CommandV1","origId":2937788264272837,"guid":"831f3cff-664a-494b-923f-fa24da468afd","subtype":"command","commandType":"auto","position":7.625,"command":"from pyspark.sql.functions import *\n\nfiltered_outage_intervals_df3 = filtered_outage_intervals_df2.withColumn('from_timestamp', to_timestamp(col('OUT_DT_TM')))\\\n  .withColumn('end_timestamp', to_timestamp(col('ON_DT_TM')))\\\n  .withColumn('DiffInSeconds', col('end_timestamp').cast('long') - col('from_timestamp').cast('long')).drop('from_timestamp', 'end_timestamp').filter(col('DiffInSeconds') >= 300).drop('DiffInSeconds')\n\n#filtered_outage_intervals_df.select('OUT_DT_TM', 'ON_DT_TM').show()\n\n\n","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_outage_intervals_df3","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"PREMISE","nullable":true,"type":"long"},{"metadata":{},"name":"EVENT_NUMBER","nullable":true,"type":"string"},{"metadata":{},"name":"REV_NUM","nullable":true,"type":"long"},{"metadata":{},"name":"CIRCUIT_OPERATION_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CIRCUIT","nullable":true,"type":"string"},{"metadata":{},"name":"SECT_POINT","nullable":true,"type":"string"},{"metadata":{},"name":"TYCOD","nullable":true,"type":"string"},{"metadata":{},"name":"CAUSE_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"OUT_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"ON_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"RESOLVED_UNRESOLVED_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CREW_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_CALLED_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CALLBACK_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_REP","nullable":true,"type":"string"},{"metadata":{},"name":"DATE_ADDED_TO_HIS","nullable":true,"type":"timestamp"},{"metadata":{},"name":"STILL_IN_INSERVICE","nullable":true,"type":"string"},{"metadata":{},"name":"EVENT_STATUS","nullable":true,"type":"string"},{"metadata":{},"name":"AMI_CALLED_CODE","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058424603,"submitTime":1645058424557,"finishTime":1645058424836,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6eae834e-28eb-47fa-a5f8-387adfd88740"},{"version":"CommandV1","origId":2937788264272838,"guid":"8af18770-6be6-4696-b7ef-3d4f94d44d18","subtype":"command","commandType":"auto","position":7.9375,"command":"filtered_outage_intervals_df = filtered_outage_intervals_df3.select('event_number', 'premise', 'tycod', 'out_dt_tm', 'on_dt_tm')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_outage_intervals_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1645058434790,"submitTime":1645058434742,"finishTime":1645058434841,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9ea06738-3001-4dfc-95f8-3903b98a3d8e"},{"version":"CommandV1","origId":2937788264272839,"guid":"eaa9cc24-e937-4335-b8dd-83556c8321a9","subtype":"command","commandType":"auto","position":8.25,"command":"%md\n#### Merge with cispersl2 to get premise ID","commandVersion":14,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0ddce117-8036-4370-83c6-24384b5a04ad"},{"version":"CommandV1","origId":2937788264272840,"guid":"a51a28ca-ebea-4de7-ad0f-829ff1b4f5ff","subtype":"command","commandType":"auto","position":8.5,"command":"outage_df = filtered_outage_intervals_df.join(spark.sql(\"\"\"select METER_NUM as meter_number, premise from edw.cispersl2\n                                                            where DISCON_FOR_NON_PAY='A' and AMI_ENABLED = 'T'\"\"\"),\\\n                                  \"premise\",\\\n                                  \"inner\") \\\n  .withColumnRenamed(\"out_dt_tm\", \"job_out_dt_tm\") \\\n  .withColumnRenamed(\"on_dt_tm\", \"job_on_dt_tm\") \\\n  .withColumnRenamed(\"meter_number\", \"job_meter_number\") \\\n  .withColumnRenamed(\"premise\", \"job_premise\") ","commandVersion":151,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outage_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_premise","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518141719,"submitTime":1642518110369,"finishTime":1642518149929,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a6a4b5b5-1e3b-47cb-80d0-59e01f5bb096"},{"version":"CommandV1","origId":2937788264272841,"guid":"3358743d-9f0e-4779-b511-2fa85f66ba5a","subtype":"command","commandType":"auto","position":8.625,"command":"%md \n##### Create distinct list of meters impacted by outage events","commandVersion":13,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ffdacc2d-82db-4880-a41d-b1f78add0172"},{"version":"CommandV1","origId":2937788264272842,"guid":"3fd902d7-b99d-4518-ba0a-73ad1d1b79c6","subtype":"command","commandType":"auto","position":8.75,"command":"filtered_premise_meter_df = outage_df \\\n  .select(\"job_premise\", \"job_meter_number\") \\\n  .distinct() \\\n  .withColumnRenamed(\"job_premise\", \"premise\") \\\n  .withColumnRenamed(\"job_meter_number\", \"meter_number\")","commandVersion":9,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_premise_meter_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518149952,"submitTime":1642518110395,"finishTime":1642518150013,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"83340a16-246b-4ae2-abce-a39075a204f4"},{"version":"CommandV1","origId":2937788264272843,"guid":"78d85ec3-bc3d-4dd3-b717-1db14de300f1","subtype":"command","commandType":"auto","position":8.875,"command":"%md\n#### Create counts by outage job to select largest outage jobs for tie break when jobs overlap\n\nLower rank indicates a larger job size","commandVersion":47,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6cc58b95-3d9d-4dbe-9147-85cb3a4d49df"},{"version":"CommandV1","origId":2937788264272844,"guid":"f39bb831-29b0-4e8c-9b53-10765f6a9fe8","subtype":"command","commandType":"auto","position":8.9375,"command":"from pyspark.sql.functions import count\n\nwindow = Window.orderBy(col(\"meters_in_job\").desc())\n\njob_rank = outage_df \\\n  .groupBy(col(\"event_number\")) \\\n  .agg(count(col(\"job_meter_number\")).alias(\"meters_in_job\")) \\\n  .withColumn(\"job_rank\", row_number().over(window)) \\\n  .drop(\"meters_in_job\")","commandVersion":139,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_rank","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518150039,"submitTime":1642518110431,"finishTime":1642518150242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"427","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"07866606-93b9-4151-849f-961b607bbe85"},{"version":"CommandV1","origId":2937788264272845,"guid":"d8fa64f6-72ab-4b38-a5a1-50ae545af05e","subtype":"command","commandType":"auto","position":8.96875,"command":"outage_premise_df = outage_df \\\n  .join(job_rank, \"event_number\", \"inner\")","commandVersion":28,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outage_premise_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_premise","nullable":true,"type":"long"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518150275,"submitTime":1642518110444,"finishTime":1642518150364,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0678eb7f-508a-4828-86f3-d0d724e5ca93"},{"version":"CommandV1","origId":2937788264272846,"guid":"66467286-91ee-449f-90de-babb8b8491f8","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n#### Pull in relevant AMI voltage reads\n1. Grab AMI reads filtered by local date partition key\n2. Inner join with filtered outage events by premise ID\n3. Keep: meter ID, premise ID, volatage read, read time, read_time local, eda ingestion time\n4. Group by meter, premise, eda ingestion time\n5. Order by max read time and max Vh(a)","commandVersion":281,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"63e18403-eb74-4613-9215-d96e41900712"},{"version":"CommandV1","origId":2937788264272847,"guid":"5403b42d-bc83-43b4-b382-d48f333b654f","subtype":"command","commandType":"auto","position":10.25,"command":"%md\n#### Select the meters impacted and cut down to leading two digits for partition query","commandVersion":23,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0269f3ec-efb3-45f5-9159-db85269886c4"},{"version":"CommandV1","origId":2937788264272848,"guid":"0a274790-aba3-4151-99df-db44a1e4072e","subtype":"command","commandType":"auto","position":10.5,"command":"meter_range = outage_premise_df \\\n  .select(col(\"job_meter_number\")).rdd \\\n  .distinct().flatMap(lambda x: x).collect()\n\nmeter_range_key = list(map(lambda x: x[-2:], filter(lambda x: x != None, meter_range)))\np_mpartkey_query = \"'\" + \"','\".join(meter_range_key) + \"'\"","commandVersion":244,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518150394,"submitTime":1642518110501,"finishTime":1642518171499,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ac9beb43-df67-48d1-b3e3-57bc9b75137b"},{"version":"CommandV1","origId":2937788264272849,"guid":"02301a1c-c76d-4091-bcfe-d96f09373b3a","subtype":"command","commandType":"auto","position":10.75,"command":"%md\n#### Create query on voltage intervals\nPer discussion we are filtering for Vh(a) and then multiplying by 12 to get an hourly read","commandVersion":34,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"089ffad0-c04a-423f-83f5-82151d75940f"},{"version":"CommandV1","origId":2937788264272850,"guid":"6e4cd99e-1a79-4fa5-a70e-da0920fde9ff","subtype":"command","commandType":"auto","position":11.0,"command":"intermediate_df = spark.sql(\"\"\"select * from edw.ami_voltage_intervals\n                                         where p_read_time_lt in ({0}) and\n                                              p_mpartkey in ({1}) and\n                                               meter_quantity = 'Vh(a)'\"\"\".format(p_read_time_lt_query, p_mpartkey_query))\n\ntrimmed_volt_reads_df = intermediate_df.join(outage_premise_df, intermediate_df.meter_number == outage_premise_df.job_meter_number, \"inner\") \\\n                            .select(col(\"meter_number\"), col(\"meter_quantity\"), col(\"read_time_localtime\"),\\\n                                    col(\"read_value\"), col(\"eda_creation_date_localtime\")) \\\n                            .withColumn(\"full_read_value\", col(\"read_value\") * 12)","commandVersion":441,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"intermediate_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"meter_quantity","nullable":true,"type":"string"},{"metadata":{},"name":"read_time","nullable":true,"type":"timestamp"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"read_value","nullable":true,"type":"decimal(22,6)"},{"metadata":{},"name":"interval_length","nullable":true,"type":"integer"},{"metadata":{},"name":"profile_status_list","nullable":true,"type":"string"},{"metadata":{},"name":"pulse_multiplier","nullable":true,"type":"decimal(15,6)"},{"metadata":{},"name":"meter_esn","nullable":true,"type":"string"},{"metadata":{},"name":"device_class","nullable":true,"type":"string"},{"metadata":{},"name":"scaling_type","nullable":true,"type":"string"},{"metadata":{},"name":"eda_creation_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"filename","nullable":true,"type":"string"},{"metadata":{},"name":"p_read_time_lt","nullable":true,"type":"integer"},{"metadata":{},"name":"p_read_time","nullable":true,"type":"integer"},{"metadata":{},"name":"p_mpartkey","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"trimmed_volt_reads_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"meter_quantity","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"read_value","nullable":true,"type":"decimal(22,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518171521,"submitTime":1642518110542,"finishTime":1642518175223,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"979","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a61a5fab-617f-479d-87c4-64e4f7c8624c"},{"version":"CommandV1","origId":2937788264272851,"guid":"d1da6438-5cae-42f2-a676-225d893f6664","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n#### Group by meter number, event number, eda creation date and select max read time prior to ingestion time and full read value (this last shouldn't matter) row","commandVersion":67,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9096c5bc-a25d-4c20-a69e-b8b29efd2e7a"},{"version":"CommandV1","origId":2937788264272852,"guid":"6451fde7-faa3-4d62-9cce-6f3c87fd2f5d","subtype":"command","commandType":"auto","position":13.0,"command":"window = Window.partitionBy(col(\"meter_number\"), \\\n                            col(\"eda_creation_date_localtime\")) \\\n  .orderBy(col(\"read_time_localtime\").desc())\n\nselected_volt_per_interval_df = trimmed_volt_reads_df \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .select(col(\"meter_number\"),  col(\"read_time_localtime\"), col(\"full_read_value\"), \\\n          col(\"eda_creation_date_localtime\"))","commandVersion":248,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"selected_volt_per_interval_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518175248,"submitTime":1642518110579,"finishTime":1642518175390,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e5b3c1a7-1fa4-4c65-a60e-b35b90907051"},{"version":"CommandV1","origId":2937788264272853,"guid":"3ab08e78-1b28-4ef5-b4e2-9d5e978771d3","subtype":"command","commandType":"auto","position":14.5,"command":"%md\n#### Attach nominal voltage and calculate nominal voltage percent","commandVersion":17,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3c57e696-554f-47fb-b6ad-37dd1033fd51"},{"version":"CommandV1","origId":2937788264272854,"guid":"01d7b0fc-8a14-4a3b-9c85-6c03f51b245f","subtype":"command","commandType":"auto","position":16.0,"command":"nmnl_volt_df = spark.sql(\"\"\"select METER_NUMBER as meter_number, NMNL_VOLT_A as nmnl_volt from edw.nmnlvltg\"\"\")","commandVersion":53,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"nmnl_volt_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"nmnl_volt","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518175407,"submitTime":1642518110609,"finishTime":1642518176080,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1734","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b2468589-980b-47f7-af77-f299191bf95f"},{"version":"CommandV1","origId":2937788264272855,"guid":"1cb4a25d-4577-409d-ac9a-04f830269248","subtype":"command","commandType":"auto","position":17.0,"command":"volt_per_interval_nominal_df = selected_volt_per_interval_df \\\n  .join(nmnl_volt_df, \"meter_number\", \"inner\") \\\n  .withColumn(\"nmnl_volt_pct\", col(\"full_read_value\") / col(\"nmnl_volt\")) \\\n  .withColumnRenamed(\"meter_number\", \"meter_number_volt\") \\\n  .drop(col(\"nmnl_volt\"))","commandVersion":137,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"volt_per_interval_nominal_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number_volt","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518176106,"submitTime":1642518110617,"finishTime":1642518176219,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1840","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e04c137e-a645-4e7a-9c76-bfdf6ab00d95"},{"version":"CommandV1","origId":2937788264272856,"guid":"c0fccf6a-3710-4087-bc90-0a81e33b4160","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n# B) Create intervals, job status and initial power status","commandVersion":19,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"12342dd5-b691-4885-aae1-5209da529d08"},{"version":"CommandV1","origId":2937788264272857,"guid":"230c43ac-893f-4b15-9c16-d03f202c53e0","subtype":"command","commandType":"auto","position":21.0,"command":"full_meter_intervals = filtered_premise_meter_df \\\n  .join(interval_df)","commandVersion":143,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"full_meter_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518176238,"submitTime":1642518110651,"finishTime":1642518176269,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"273","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a158c049-2ae3-4519-8573-1ae7b04ac57b"},{"version":"CommandV1","origId":2937788264272858,"guid":"cacfb41a-70ee-4c1d-b9c4-035787cdf070","subtype":"command","commandType":"auto","position":21.5,"command":"%md\n#### Join on jobs and handle overlapping by taking the most populous job if two","commandVersion":34,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c87ec20a-c554-4be5-b0d4-823279ed5fe5"},{"version":"CommandV1","origId":2937788264272859,"guid":"7f4cdc87-315e-4d41-9bdf-e3c5249caea8","subtype":"command","commandType":"auto","position":22.0,"command":"cond_jobs = (col(\"job_meter_number\") == col(\"meter_number\")) & \\\n             ((col(\"job_out_dt_tm\").between(col(\"interval_tm_start\"), col(\"interval_tm_stop\"))) | \\\n             (col(\"job_on_dt_tm\").between(col(\"interval_tm_start\"), col(\"interval_tm_stop\"))) | \\\n             ((col(\"job_out_dt_tm\") <= col(\"interval_tm_start\")) & (col(\"job_on_dt_tm\") >= col(\"interval_tm_stop\"))))\n              \nraw_outage_intervals = full_meter_intervals \\\n  .join(outage_premise_df.drop(\"job_premise\"), on=cond_jobs, how=\"left_outer\")\n\n\nwindow = Window.partitionBy(raw_outage_intervals.meter_number, col(\"interval\")) \\\n  .orderBy(col(\"job_rank\"))\n\nselected_outage_intervals = raw_outage_intervals \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"job_rank\")","commandVersion":374,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"raw_outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518176287,"submitTime":1642518110679,"finishTime":1642518176443,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1997","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a2fa8fd3-fb80-4fa2-856e-c13acb4ff9c7"},{"version":"CommandV1","origId":2937788264272860,"guid":"1770c36f-3070-4cdb-8009-98d20bc85b0d","subtype":"command","commandType":"auto","position":22.25,"command":"outage_intervals = selected_outage_intervals \\\n  .drop(\"job_meter\") \\\n  .withColumnRenamed(\"job_out_dt_tm\", \"out_dt_tm\") \\\n  .withColumnRenamed(\"job_on_dt_tm\", \"on_dt_tm\") \\\n  .withColumn(\"job_status\", when(col(\"on_dt_tm\") > col(\"interval_tm_stop\"),  lit(\"Job Open\"))\n                           .when(col(\"on_dt_tm\") <= col(\"interval_tm_stop\"), lit(\"Job Closed\"))\n                           .otherwise(lit(\"Job Closed\"))) \\\n  .withColumn(\"job_start\", when(col(\"out_dt_tm\") >= col(\"interval_tm_start\"), lit(\"Yes\"))) \\\n  .withColumn(\"power_status\", lit(None))","commandVersion":254,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518176464,"submitTime":1642518110688,"finishTime":1642518176597,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5af76aeb-8b0d-42aa-8d90-e1b081aa9546"},{"version":"CommandV1","origId":2937788264272861,"guid":"35ca0b10-987a-488c-82cd-cc006b08457e","subtype":"command","commandType":"auto","position":22.34375,"command":"%md\n#### Create small interval around job start\n\n1. job_start_intervals creates an interval 1 minute around the job inside the starting interval and puts it at 0.2 to keep it in order\n2. job_prior_intervals splits the original starting interval into an interval before the job starts\n3. On the interval right before a job, check that there isn't a prior job that just ended","commandVersion":74,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f0d5f545-03c4-4664-97ec-0db7b8d44bd5"},{"version":"CommandV1","origId":2937788264272862,"guid":"fad9fd11-74e1-40bf-9d09-9a631bebf365","subtype":"command","commandType":"auto","position":22.4375,"command":"check_not_middle_job_window = Window.partitionBy(col(\"meter_number\")).orderBy(col(\"time_step\"))\n\njob_start_intervals = outage_intervals.filter(col(\"job_start\") == \"Yes\") \\\n  .withColumn(\"interval_tm_start\", col(\"out_dt_tm\")) \\\n  .withColumn(\"interval_tm_stop\", col(\"out_dt_tm\") + expr('INTERVAL 1 minutes')) \\\n  .withColumn(\"time_step\", col(\"time_step\") + 0.2)\n\njob_prior_intervals = outage_intervals.filter(col(\"job_start\") == \"Yes\") \\\n  .withColumn(\"interval_tm_stop\", col(\"out_dt_tm\")) \\\n  .withColumn(\"in_between_jobs\", lag(col(\"event_number\"), 1).over(check_not_middle_job_window)) \\\n  .withColumn(\"job_start\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"job_start\"))) \\\n  .withColumn(\"job_status\", when(col(\"in_between_jobs\").isNull(), lit(\"Job Closed\")).otherwise(col(\"job_status\")) ) \\\n  .withColumn(\"out_dt_tm\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"out_dt_tm\"))) \\\n  .withColumn(\"on_dt_tm\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"on_dt_tm\"))) \\\n  .withColumn(\"event_number\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"event_number\"))) \\\n  .withColumn(\"tycod\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"tycod\"))) \\\n  .withColumn(\"job_meter_number\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"job_meter_number\"))) \\\n  .withColumn(\"time_step\", col(\"time_step\") + 0.1) \\\n  .drop(col(\"in_between_jobs\"))\n\njob_post_intervals = outage_intervals.filter(col(\"job_start\") == \"Yes\") \\\n  .withColumn(\"interval_tm_start\", col(\"out_dt_tm\") + expr('INTERVAL 1 minutes')) \\\n  .withColumn(\"job_start\", lit(None)) \\\n  .withColumn(\"time_step\", col(\"time_step\") + 0.3)\n\nwithout_job_intervals = outage_intervals.filter(col(\"job_start\").isNull())\n\nsplit_outage_intervals = without_job_intervals \\\n  .union(job_start_intervals) \\\n  .union(job_prior_intervals) \\\n  .union(job_post_intervals)","commandVersion":374,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_start_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"job_prior_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"job_post_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"null"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"without_job_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"split_outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518176620,"submitTime":1642518110717,"finishTime":1642518177147,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2303","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c9de62dc-848f-4d92-9b74-bf80b044b450"},{"version":"CommandV1","origId":2937788264272863,"guid":"0987ae4f-0857-4938-82c7-b0903bbaaef4","subtype":"command","commandType":"auto","position":23.0,"command":"%md\n### Join all indications/events\n1. Join the voltage reads\n2. Join on PPU up events\n3. Join on calls","commandVersion":35,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cc16a369-8cd4-45ef-9697-10eb9cc8b0fe"},{"version":"CommandV1","origId":2937788264272864,"guid":"254784dd-b497-4524-b27a-79667a12c8fe","subtype":"command","commandType":"auto","position":25.5,"command":"%md\n#### 1) Range join on voltage reads\n1. Join where meter number and interval match\n2. Make sure that we take latest eda date inside interval","commandVersion":42,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"df9e4d9b-1d36-4fd4-88cf-86fa543df3f6"},{"version":"CommandV1","origId":2937788264272865,"guid":"f016be75-1452-4034-b9e9-4d998f23727c","subtype":"command","commandType":"auto","position":26.0,"command":"cond_volt = (col(\"meter_number\") == col(\"meter_number_volt\")) & \\\n             (col(\"interval_tm_start\") <= col(\"eda_creation_date_localtime\")) & \\\n             (col(\"interval_tm_stop\") > col(\"eda_creation_date_localtime\"))\n\ninterval_volt_df = split_outage_intervals \\\n    .join(volt_per_interval_nominal_df, on=cond_volt, how=\"left_outer\")\n\nwindow_volt = Window.partitionBy(split_outage_intervals.meter_number, col(\"time_step\")) \\\n  .orderBy(col(\"eda_creation_date_localtime\").desc())\n\nselected_interval_volt_df = interval_volt_df \\\n  .withColumn(\"row\", row_number().over(window_volt)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"event_number_volt\", \"meter_number_volt\", \"read_time_localtime\")","commandVersion":212,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_volt_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"meter_number_volt","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_interval_volt_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518177167,"submitTime":1642518110824,"finishTime":1642518177366,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1bc6fb19-d7d1-45d4-88eb-bf8a7e6b2f1d"},{"version":"CommandV1","origId":2937788264272866,"guid":"d39622a2-e078-4663-bced-5ab8b93e6cf7","subtype":"command","commandType":"auto","position":26.5,"command":"%md\n#### 2) Range join the PPU up events\n1. Join meter number and interval\n2. Make sure to take the latest","commandVersion":26,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2fa75436-fe1a-497a-922e-ad0d18237fea"},{"version":"CommandV1","origId":2937788264272867,"guid":"8b4e0eb5-6a1c-4b3a-86ba-46f71556f78f","subtype":"command","commandType":"auto","position":27.0,"command":"events_df = spark.sql(\"\"\"select meter_number as meter_number_ppu, event_name, eda_creation_date_localtime as ppu_eda_creation_date_localtime from edw.ami_elc_meter_events\n                         where p_event_time_lt_ym in ({0}) and\n                               p_mpartkey in ({1}) and\n                               event_name = 'Primary Power Up'\"\"\".format(p_read_time_lt_ym_query, p_mpartkey_query))","commandVersion":94,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"events_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number_ppu","nullable":true,"type":"string"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518177389,"submitTime":1642518110862,"finishTime":1642518178516,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3891","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a1d54008-3009-4282-a5b0-9ae3362c379d"},{"version":"CommandV1","origId":2937788264272868,"guid":"df9720df-24e3-4b31-b634-8a77de559e02","subtype":"command","commandType":"auto","position":27.25,"command":"%md\n##### Take latest PPU inside time interval and join","commandVersion":15,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cb7e04c7-f054-4efe-adca-fc4774af778c"},{"version":"CommandV1","origId":2937788264272869,"guid":"8c2b5004-745f-404e-b02f-875846f58f9e","subtype":"command","commandType":"auto","position":27.5,"command":"cond_event = (col(\"meter_number\") == col(\"meter_number_ppu\")) & \\\n             (col(\"interval_tm_start\") <= col(\"ppu_eda_creation_date_localtime\")) & \\\n             (col(\"interval_tm_stop\") > col(\"ppu_eda_creation_date_localtime\"))\n\ninterval_volt_ppu_df = selected_interval_volt_df \\\n    .join(events_df, on=cond_event, how=\"left_outer\")\n\nwindow = Window.partitionBy(col(\"meter_number\"), col(\"time_step\")) \\\n  .orderBy(col(\"ppu_eda_creation_date_localtime\").desc())\n\nselected_interval_volt_ppu_df = interval_volt_ppu_df \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"event_number_volt\", \"meter_number_ppu\")\n","commandVersion":141,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_volt_ppu_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"meter_number_ppu","nullable":true,"type":"string"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_interval_volt_ppu_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518178534,"submitTime":1642518110890,"finishTime":1642518178759,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3f1355de-cc3b-4d43-a8b9-b23201fa91a8"},{"version":"CommandV1","origId":2937788264272870,"guid":"37ac4717-6e03-4dce-8647-ec1980d309be","subtype":"command","commandType":"auto","position":28.5,"command":"%md\n#### 3) Range join on outage call events","commandVersion":17,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fd099e2b-c3ce-4b25-8197-b80338e942ae"},{"version":"CommandV1","origId":2937788264272871,"guid":"81dcf635-fa41-4d7f-a6b8-d3184fb0b87d","subtype":"command","commandType":"auto","position":28.75,"command":"%md\n##### Create datetime for outage calls","commandVersion":18,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6ad516df-815c-4c5f-af36-0f8068d4d4a7"},{"version":"CommandV1","origId":2937788264272872,"guid":"d0e28d64-994b-4e61-9c69-7c0c82948b95","subtype":"command","commandType":"auto","position":29.0,"command":"outcall_df = spark.sql(\"\"\"select METER_NUM as meter_number_call, EVNTNUM as event_number_call, CDTS, CALLTYPE from edw.outcall\"\"\") \\\n  .withColumn(\"CDTS_trim\", col(\"CDTS\").substr(lit(0), length(col('CDTS')) - 2)) \\\n  .withColumn(\"CDTS_datetime\", to_timestamp(col(\"CDTS_trim\"), \"yyyyMMddHHmmss\")) \\\n  .drop(\"CDTS_trim\", \"CDTS\")","commandVersion":77,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outcall_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"event_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518178784,"submitTime":1642518110941,"finishTime":1642518183442,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c7c976a9-656c-455a-8b27-8159a8b7152e"},{"version":"CommandV1","origId":2937788264272873,"guid":"472edc26-ba59-4543-bee7-0e6fa88e0868","subtype":"command","commandType":"auto","position":30.0,"command":"%md\n##### Perform the join","commandVersion":6,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d43a9c26-bf07-4439-806b-e7af3f49b6cf"},{"version":"CommandV1","origId":2937788264272874,"guid":"f71c4bf9-6a22-4148-8525-8a03ca4e4a1f","subtype":"command","commandType":"auto","position":31.0,"command":"cond_call = (col(\"meter_number\") == col(\"meter_number_call\")) & \\\n             (col(\"interval_tm_start\") <= col(\"CDTS_datetime\")) & \\\n             (col(\"interval_tm_stop\") > col(\"CDTS_datetime\"))\n\ninterval_volt_ppu_call_df = selected_interval_volt_ppu_df \\\n    .join(outcall_df, on=cond_call, how=\"left_outer\")\n\nwindow = Window.partitionBy(col(\"meter_number\"), col(\"time_step\")) \\\n  .orderBy(col(\"CDTS_datetime\").desc())\n\nselected_interval_volt_ppu_call_df = interval_volt_ppu_call_df \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"event_number_call\", \"meter_number_call\")","commandVersion":93,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_volt_ppu_call_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"meter_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"event_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_interval_volt_ppu_call_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518183464,"submitTime":1642518110967,"finishTime":1642518183703,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"db11a464-cdc4-491b-b383-1ad9fa786ac0"},{"version":"CommandV1","origId":2937788264272875,"guid":"bba53e73-dfe4-4432-a36e-d8b065d58b2f","subtype":"command","commandType":"auto","position":31.5,"command":"%md\n# C) Apply business logic to each meter combo sequentially","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"136fcfdb-4be7-4e12-91f9-efe6064887b7"},{"version":"CommandV1","origId":2937788264272876,"guid":"0e79d8f0-0a8b-472c-aa9c-214094d839fe","subtype":"command","commandType":"auto","position":32.720703125,"command":"%md\n####  Application of business rules","commandVersion":29,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"42942948-833a-463d-97fe-12cf9b119e1a"},{"version":"CommandV1","origId":2937788264272877,"guid":"52cfb04f-9546-4f81-9199-ba068199d1dc","subtype":"command","commandType":"auto","position":32.7216796875,"command":"%md\n1. Update job_status, power_status names\n2. Find the maximum timestamp of events in each interval\n3. Determine which event (voltage read, outage call, PPU - primary power up)\n4. Adding a lag variable to be able to determine when job starts and ends\n5. Mark the discrete events that occur and the power status\n6. Fill in the gaps between jobs\n7. Repeat this process of marking and filling for the Job Open\n8. Calculate the 95% rule at job close \n9. Repeat the mark and fill process","commandVersion":109,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8acf6f44-6f18-47c5-8dfd-8b24f96ed827"},{"version":"CommandV1","origId":2937788264272878,"guid":"334454b2-db9a-4a7e-b23e-480abb3f92b2","subtype":"command","commandType":"auto","position":32.72216796875,"command":"%md\n##### Update names, find max timestamp of event, determine which event and add lagging job status variable","commandVersion":32,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bc5a6e62-2387-4c42-9b18-8f647872a4c2"},{"version":"CommandV1","origId":2937788264272879,"guid":"3d5d0543-4e25-4784-99ca-aa5af5ea9dbd","subtype":"command","commandType":"auto","position":32.72265625,"command":"bus_logic_window = Window.partitionBy(\"meter_number\").orderBy(col(\"time_step\").asc())\n\nrename_voltage_df = selected_interval_volt_ppu_call_df \\\n  .withColumnRenamed('job_status', 'job_status_orig') \\\n  .withColumnRenamed('power_status', 'power_status_orig') \\\n  .withColumn('time_occurence', greatest(col(\"eda_creation_date_localtime\"), col(\"ppu_eda_creation_date_localtime\"), col(\"CDTS_datetime\"))) \\\n  .withColumn(\"max_event\", when(col(\"eda_creation_date_localtime\") == col(\"time_occurence\"), \"volt\") \\\n                          .when(col(\"ppu_eda_creation_date_localtime\") == col(\"time_occurence\"), \"ppu\") \\\n                          .when(col(\"CDTS_datetime\") == col(\"time_occurence\"), \"call\")) \\\n  .withColumn('job_status_over', lag(col(\"job_status_orig\"), 1).over(bus_logic_window)) \\\n  .withColumn('power_status_over', lag(col(\"power_status_orig\"), 1).over(bus_logic_window))    ","commandVersion":69,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"rename_voltage_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_occurence","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_over","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518183724,"submitTime":1642518111065,"finishTime":1642518184027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3506","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"20ac2fc1-e854-4079-9fe1-3ba8d8cbb1c9"},{"version":"CommandV1","origId":2937788264272880,"guid":"63b604a4-ec1e-4946-81ab-b6925dc3c685","subtype":"command","commandType":"auto","position":32.728519439697266,"command":"%md\n##### Mark discrete outage events\n\nKeep in mind we have to make sure the outage job is not null for calls to keep call \"No\" response only being updated inside the job window, the lookback will be handled in next step","commandVersion":46,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ba018bb0-99f2-44a2-b731-796ab8502a44"},{"version":"CommandV1","origId":2937788264272881,"guid":"cbc9d80f-67f5-4e97-a8bb-c9aee908703e","subtype":"command","commandType":"auto","position":32.73438262939453,"command":"discrete_bis_rules = rename_voltage_df.withColumn(\"power_status_orig\", \n            when((col(\"max_event\") == \"ppu\"), \"Yes\")\n            .when((col(\"max_event\") == \"call\") & (col(\"event_number\").isNotNull()), \"No\")\n            .when((col(\"max_event\") == \"volt\") & (col(\"full_read_value\") < 90), \"No\")\n            .when((col(\"max_event\") == \"volt\") & (col(\"nmnl_volt_pct\") >= 0.92), \"Yes\"))","commandVersion":234,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"discrete_bis_rules","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig","nullable":true,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_occurence","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_over","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518184045,"submitTime":1642518111091,"finishTime":1642518184694,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4329","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"48c5fe67-4e9e-4497-97a2-8a3eba280ad5"},{"version":"CommandV1","origId":2937788264272882,"guid":"3c9060f4-06f2-4a9a-9b1c-64d09ee40915","subtype":"command","commandType":"auto","position":32.7343864440918,"command":"%md\n##### Switch Yes status to Don't know on job open, mark and fill and get lagging call for first open\n\nWe have call information, we can go back at least two records before, taking the first non-null event we can find (that is between 1 and 2 hours prior to the outage job), then we check if it was a call and the job is opening and mark \"No\"","commandVersion":79,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9e4d35d3-3553-4668-93e2-d9a52589ed2c"},{"version":"CommandV1","origId":2937788264272883,"guid":"3e868dd8-dc5a-4043-a528-eaac79205f10","subtype":"command","commandType":"auto","position":32.73439025878906,"command":"full_business_no_95_rule = discrete_bis_rules \\\n  .withColumn('power_status_orig_compare', last('power_status_orig', ignorenulls=True).over(bus_logic_window.rowsBetween(Window.unboundedPreceding, 0))) \\\n  .withColumn('lag_max_event', last('max_event', ignorenulls=True).over(bus_logic_window.rowsBetween(-2, 0))) \\\n  .withColumn(\"power_status_orig_dk\",                 \n      when((col(\"power_status_orig_compare\") == \"Yes\") & (col(\"job_status_orig\") ==\"Job Open\") & (col(\"job_status_over\")==\"Job Closed\"), \"Don't Know\")\n     .when((col(\"lag_max_event\") == \"call\") & (col(\"job_status_orig\") ==\"Job Open\") & (col(\"job_status_over\")==\"Job Closed\"), \"No\")\n     .otherwise(col(\"power_status_orig\"))) \\\n  .withColumn('final_power_status', last('power_status_orig_dk', ignorenulls=True).over(bus_logic_window)) \\\n  .drop(col(\"lag_max_event\"))","commandVersion":260,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"full_business_no_95_rule","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig","nullable":true,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_occurence","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_over","nullable":true,"type":"null"},{"metadata":{},"name":"power_status_orig_compare","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig_dk","nullable":true,"type":"string"},{"metadata":{},"name":"final_power_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518184712,"submitTime":1642518111119,"finishTime":1642518184995,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4691","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"706ae0ed-6d3f-4956-8222-214b8fd59abc"},{"version":"CommandV1","origId":2937788264272884,"guid":"abc2406c-6de3-4810-87a3-eeda43d7479c","subtype":"command","commandType":"auto","position":32.734405517578125,"command":"%md\n# D)  95% rule\n\n- If status is No and 95%+ of meters impacted by the outage job are Yes and no event happens, the meter power status becomes Don’t Know\n\n- If status is Don’t Know and <95% of meters impacted by the outage job are Yes and no event happens, the meter power status becomes No\n\n\n##### Calculate the power status at job close, then mark the locations where power status changes and fill","commandVersion":34,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"efaf9fa2-91c7-4446-9067-0a98551951af"},{"version":"CommandV1","origId":2937788264272885,"guid":"5c38738e-ba0d-4da5-9d7c-fe92d69e5952","subtype":"command","commandType":"auto","position":32.73442077636719,"command":"job_interval_percentage = full_business_no_95_rule \\\n  .filter((col(\"job_status_orig\") == \"Job Closed\") & (col(\"job_status_over\") == \"Job Open\")) \\\n  .select(col(\"meter_number\"), col(\"event_number\"), col(\"final_power_status\"), col(\"job_status_orig\")) \\\n  .withColumn(\"power_yes_status\", when(col(\"final_power_status\") == \"Yes\", 1).otherwise(0)) \\\n  .groupBy(col(\"event_number\")) \\\n  .agg(count(col(\"meter_number\")).alias(\"meters_in_job\"), sum(col(\"power_yes_status\")).alias(\"power_yes_status\")) \\\n  .withColumn(\"percent_yes_meters\", col(\"power_yes_status\") / col(\"meters_in_job\"))\n\nfull_business_95 = full_business_no_95_rule \\\n  .join(job_interval_percentage, on=\"event_number\", how = \"left\") \\\n  .withColumn(\"power_status_orig_95\", when((col(\"job_status_orig\") == \"Job Closed\") & (col(\"job_status_over\") == \"Job Open\") & (col(\"max_event\").isNull()),\n                                       when((col(\"final_power_status\") == \"Don't Know\") & (col(\"percent_yes_meters\") < 0.95), \"No\") \\\n                                       .when((col(\"final_power_status\") == \"No\") & (col(\"percent_yes_meters\") >= 0.95), \"Yes\")) \\\n                                      .otherwise(col(\"power_status_orig_dk\"))) \\\n  .withColumn('final_power_status_95', last('power_status_orig_95', ignorenulls=True).over(bus_logic_window)) \\\n  .drop(\"job_meter_number\", \"job_start\", \"power_status_orig\", \"CALLTYPE\", \"event_name\", \"time_occurence\", \"job_status_over\",\n        \"power_status_over\", \"power_status_orig_compare\", \"power_status_orig_dk\", \"final_power_status\", \"meters_in_job\",\n        \"power_yes_status\", \"power_status_orig_95\")\n","commandVersion":587,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_interval_percentage","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"meters_in_job","nullable":false,"type":"long"},{"metadata":{},"name":"power_yes_status","nullable":true,"type":"long"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"full_business_95","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518185014,"submitTime":1642518111160,"finishTime":1642518186140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"5498","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"87db1479-2b30-4384-a6e8-e0ae62401b4e"},{"version":"CommandV1","origId":2937788264272886,"guid":"e68c367e-3877-403f-a67b-5f903cd0fc71","subtype":"command","commandType":"auto","position":34.23442077636719,"command":"%md\n# * Run single profiles","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ddd0fe3e-d01d-4d19-9851-c81fe2fd5645"},{"version":"CommandV1","origId":2937788264272887,"guid":"c84030e7-2dcf-4e80-af0e-f77057a1d6b3","subtype":"command","commandType":"auto","position":34.48442077636719,"command":"#singles = full_business_95.sort(\"interval_tm_start\", ascending=True)\n#list_of_meters = [\"4894042\"]\n#display(singles.filter(col(\"meter_number\").isin(list_of_meters)))\n#singles \\\n#  .coalesce(1) \\\n#  .write.option(\"header\", True) \\\n#  .option(\"sep\", \",\") \\\n#  .mode(\"overwrite\") \\\n#  .csv(f\"{path}{name}_individuals\")\n#display(singles)","commandVersion":44,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518186172,"submitTime":1642518111187,"finishTime":1642518186196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c7abb8ad-3527-4a25-97d0-30b75f2eaa19"},{"version":"CommandV1","origId":2937788264272888,"guid":"5fe76bd4-1b64-43c0-af3d-59951f8d1738","subtype":"command","commandType":"auto","position":34.73442077636719,"command":"%md\n# E) Group up to summary level","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d56f5b9b-da98-40d7-8fa2-881a55450660"},{"version":"CommandV1","origId":2937788264272889,"guid":"64449277-4ab4-431f-b37e-2064e2f8148a","subtype":"command","commandType":"auto","position":35.73442077636719,"command":"%md\n#### Job setup\n1. Get min outage job start per meter\n2. min job start - interval (this rebases the interval for reporting)\n3. Filter out >= 0 on step 2 to focus only on our intervals","commandVersion":78,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"510f5c8e-502f-4947-9b23-72115c76c2d1"},{"version":"CommandV1","origId":2937788264272890,"guid":"c241ffe4-a425-490c-acdf-fa356354a6ae","subtype":"command","commandType":"auto","position":36.73442077636719,"command":"window = Window.partitionBy(col(\"meter_number\"))\n\njob_timeline = full_business_95 \\\n  .withColumn(\"min_job_out_tm\", min(col(\"out_dt_tm\")).over(window)) \\\n  .withColumn(\"interval_from_job_start\", unix_timestamp(col(\"interval_tm_start\")) - unix_timestamp(col(\"min_job_out_tm\"))) \\\n  .filter(col(\"interval_from_job_start\") >= 0)","commandVersion":236,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_timeline","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"min_job_out_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_from_job_start","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518186231,"submitTime":1642518111476,"finishTime":1642518186515,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3898","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"45e1c633-ccf3-46aa-9a70-9cedd482a63d"},{"version":"CommandV1","origId":2937788264272891,"guid":"96be2c58-0a54-40f7-8061-c2494d2caf1c","subtype":"command","commandType":"auto","position":37.73442077636719,"command":"%md\n#### Join intervals and group up\n1. Join interval\n2. Take max status per interval\n3. Group up by interval and status\n4. Count status\n5. Add percentages","commandVersion":43,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"21f1f483-01f2-49b1-ac2c-e7f79f2f5fee"},{"version":"CommandV1","origId":2937788264272892,"guid":"569ed12d-52b7-40bd-a270-b02c317cc068","subtype":"command","commandType":"auto","position":38.73442077636719,"command":"cond = (col(\"interval_from_job_start\") >= col(\"job_time_step\")) & \\\n       (col(\"interval_from_job_start\") < col(\"job_end_time_step\"))\n\njob_interval_window = Window.partitionBy(col(\"meter_number\"), col(\"job_time_step\")).orderBy(col(\"interval_from_job_start\").desc())\n\nsummary_by_job_interval = job_timeline \\\n  .join(job_interval_data, on=cond, how=\"left_outer\") \\\n  .withColumn(\"job_interval_row\", row_number().over(job_interval_window)) \\\n  .filter(col(\"job_interval_row\") == 1) \\\n  .groupBy(col(\"job_interval\"), col(\"job_time_step\"), col(\"final_power_status_95\")) \\\n  .agg(count(col(\"final_power_status_95\")).alias(\"counts\")) \\\n  .filter(col(\"final_power_status_95\").isNotNull())\n\n\nsummary_total_by_job_interval = summary_by_job_interval \\\n  .groupBy(col(\"job_interval\"), col(\"job_time_step\")) \\\n  .agg(sum(col(\"counts\")).alias(\"total_counts\"))\n\nsummary_df = summary_by_job_interval \\\n  .join(summary_total_by_job_interval, on=[\"job_interval\", \"job_time_step\"], how=\"inner\") \\\n  .withColumn(\"percentage_total\", col(\"counts\") / col(\"total_counts\")) \\\n  .withColumnRenamed(\"final_power_status_95\", \"final_power_status\")","commandVersion":327,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_by_job_interval","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"summary_total_by_job_interval","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"summary_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"},{"metadata":{},"name":"percentage_total","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518186536,"submitTime":1642518111602,"finishTime":1642518187668,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4261","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1493842a-68b6-489c-9d82-8d48988ba8f6"},{"version":"CommandV1","origId":2937788264272893,"guid":"0ba206ce-839e-4208-bacc-90ae6a3a5bf4","subtype":"command","commandType":"auto","position":39.73442077636719,"command":"%md\n# F) Write to folder location","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6b3ebcf9-27be-473c-9bcc-8c8eb659657f"},{"version":"CommandV1","origId":2937788264272894,"guid":"f675b54a-044b-44b6-9ffe-d42203b518cc","subtype":"command","commandType":"auto","position":40.73442077636719,"command":"summary_df \\\n  .coalesce(1) \\\n  .write.option(\"header\", True) \\\n  .option(\"sep\", \",\") \\\n  .mode(\"overwrite\") \\\n  .csv(f\"{path}{name}\")\n\ndisplay(summary_df)","commandVersion":72,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642518187689,"submitTime":1642518111679,"finishTime":1642520726931,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e5e2cb4c-ae16-4156-99b9-323a62d891a0"}],"dashboards":[],"guid":"0b42a9f9-77db-4af8-99e1-ff3479572928","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"stop_date":{"nuid":"173bd2aa-dccb-4abd-ae4d-55fcb020eb3c","currentValue":"2021-07-09 17:00:00","widgetInfo":{"widgetType":"text","name":"stop_date","defaultValue":"","label":"Stop Date","options":{"widgetType":"text","validationRegex":null}}},"start_date":{"nuid":"fb31e412-3ef1-4560-9db6-790a1e11f956","currentValue":"2021-07-06 17:00:00","widgetInfo":{"widgetType":"text","name":"start_date","defaultValue":"","label":"Start Date","options":{"widgetType":"text","validationRegex":null}}},"name":{"nuid":"c4280165-0dac-414d-8e3e-cfe338fa4912","currentValue":"default","widgetInfo":{"widgetType":"text","name":"name","defaultValue":"","label":"File Name","options":{"widgetType":"text","validationRegex":null}}},"path":{"nuid":"759f70c1-0793-4c9d-b7fc-fa9a24760a1c","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/Dummy_test/pps_outage/","widgetInfo":{"widgetType":"text","name":"path","defaultValue":"","label":"Folder Path","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}