{"version":"NotebookV1","origId":2937788264273012,"name":"PPS - Outage Status Extended","language":"python","commands":[{"version":"CommandV1","origId":2937788264273013,"guid":"93aada20-17e8-409f-a52b-c95ec6bae857","subtype":"command","commandType":"auto","position":1.0,"command":"\"/EDA/Analyst/Framework/Secrets-Databricks-Cache\"","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[3]: &#39;/EDA/Analyst/Framework/Secrets-Databricks-Cache&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323146,"submitTime":1646328319586,"finishTime":1646328323173,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",92]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3c39ca48-9633-4817-ae6e-7bac5dd851bc"},{"version":"CommandV1","origId":2937788264273014,"guid":"5669c27f-a3ce-482a-9798-9c324bcc39fa","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264273015,"guid":"9013c8a1-9f08-4c4c-a61e-892a12420215","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264273016,"guid":"2df85f68-44a8-472e-832f-572c1290e964","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264273017,"guid":"ab213ae5-cabb-41ce-99bd-de016169accf","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762204836,"submitTime":0,"finishTime":1639762204875,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264273018,"guid":"b50a2382-7ed7-4645-a83f-4b597d9efde8","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954307083,"submitTime":0,"finishTime":1639954307215,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264273019,"guid":"4173d601-07de-44ca-bf6c-4c8220ae162b","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["stop_date","start_date"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117985525,"submitTime":0,"finishTime":1642117985636,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264273020,"guid":"ac6c843f-1c1b-43c3-89f3-42c9ab956287","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762204912,"submitTime":0,"finishTime":1639762204964,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264273021,"guid":"d4d0845d-091d-4aca-80ae-807cbbaa8745","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954307422,"submitTime":0,"finishTime":1639954307487,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264273022,"guid":"9899df6e-5d95-48cc-9465-92022ca4b478","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117985789,"submitTime":0,"finishTime":1642117985843,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264273023,"guid":"092ff5ab-69b0-4ad9-8beb-831ecbbe4c03","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264273024,"guid":"88f90801-3830-443c-b49b-b62eb702264f","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264273025,"guid":"547527c7-2fab-4067-96d5-2270cdda2aed","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264273026,"guid":"fd48fb5c-37ee-4009-a246-d71ca7fdf980","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762204975,"submitTime":0,"finishTime":1639762205575,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264273027,"guid":"f8bedc5f-dade-43c7-9fab-846ef401a1d0","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954307513,"submitTime":0,"finishTime":1639954312065,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264273028,"guid":"19e09d85-721c-4184-ac57-a10b2e033e15","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117985895,"submitTime":0,"finishTime":1642117990804,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264273029,"guid":"f46b0256-bae9-43a2-abc3-02540daf499d","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":232,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762205719,"submitTime":0,"finishTime":1639762205796,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264273030,"guid":"b4203ee7-b625-4214-be4b-28d370686e25","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":232,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954312265,"submitTime":0,"finishTime":1639954312327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264273031,"guid":"d8229d6e-a41d-4dda-a150-05a12dd2319e","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":239,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117990957,"submitTime":0,"finishTime":1642117991027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264273032,"guid":"09f090c0-78db-4f09-8116-31503bd3bac1","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":126,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762205808,"submitTime":0,"finishTime":1639762216259,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264273033,"guid":"52a6211f-68b9-402e-b316-9d7d3d8fe927","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":126,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954312340,"submitTime":0,"finishTime":1639954322144,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264273034,"guid":"3c2982d6-bf33-45e3-a3a7-3bc3b6c99a41","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":127,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642117991082,"submitTime":0,"finishTime":1642118001140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264273035,"guid":"091af569-c8fd-4e3c-b357-415a82bd9a24","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":46,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762216270,"submitTime":0,"finishTime":1639762216853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264273036,"guid":"9c12a539-909f-42e0-ac38-230e4f897e69","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":46,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954322155,"submitTime":0,"finishTime":1639954323183,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264273037,"guid":"795e660a-8c43-48d4-ba8f-2a6c1505a3a1","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":47,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118001174,"submitTime":0,"finishTime":1642118002189,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264273038,"guid":"65d755a3-0e54-4454-9461-079208b428bb","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n# PPS Outage Analysis\n\n## Purpose\nTo create a timeline of outage status per meter and job by applying business rules that mirror the PPS outage system to analyze the number of meters in \"Don't Know\" status from job close\n\n## Deliverable\nWorkbook with widgets that can produce the analysis for a given date range.\n\n## How to run\n1. Enter a file name and ADLS folder path (with the last \"/\" on the folder path)\n2. Enter a start/stop date in the yyyy-mm-dd HH:MM:SS (keep leading 0s on single digit months, days, hours, minutes, seconds) Time is in EST\n3. Select or confirm  dte-cu-prod-premisepowerstatus-cluster-001 is the selected cluster and is running\n4. Run all and the file will be written to the specified location in ADLS\n5. For single meter numbers, go to the section \"* Run single profiles\" and uncomment and run the workbook up to that point\n6. To customize interval range, got to section \"Set reporting intervals\" and update teh \n\n## Steps\n1. Prepare data by pulling in needed tables and summarizing the voltage reads\n2. Create time intervals on the meters/outages in order to begin applying business rules\n3. Apply business rules for around if power status is \"Yes\", \"No\", \"Don't Know\"\n4. Apply the 95% power rule for impacted meters\n5. Group up into intervals to provide summarized data\n6. Write to file\n\n## Source Tables\n\n#### edw.location_outage_history\nInService jobs tied to premise. Must filter for date intervals (user input) and outage job TYCOD outage codes (provided by DTE)\n\n#### edw.cispersl2\nUsed here as the link table between premise and meter number\n\n#### edw.ami_voltage_intervals\nFive minute voltage reads for each meter. Currently using the eda_creation_date_localtime and taking the voltage from lastest 5 minute read prior to the eda_creation_date_localtime\n\n#### edw.nmnlvltg\nContains the nominal voltage for each meter\n\n#### edw.ami_elc_meter_events\nDifferent events, but for this analysis we only care about primary power up events\n\n#### edw.outcall\nOutage call table","commandVersion":478,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"aa2e6d1b-8090-477a-9077-46a93ce2aea1"},{"version":"CommandV1","origId":2937788264273039,"guid":"6d40081e-8bfd-4782-ae0d-24aeed003af7","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762216863,"submitTime":0,"finishTime":1639762220811,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264273040,"guid":"74d23c3a-6d29-4b3d-a62c-5f0d01ea3c9c","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954323193,"submitTime":0,"finishTime":1639954328457,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264273041,"guid":"e0ec0cfa-31ad-4097-b7bb-9a60cb5aad96","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118002223,"submitTime":0,"finishTime":1642118007435,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264273042,"guid":"d7346923-46b8-4599-b748-774a2b26e13c","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264273043,"guid":"da4c2370-664d-433d-b2d3-a7a816d7996f","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264273044,"guid":"5a4c9580-9a4f-445c-a1ee-fbb821db1fd9","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264273045,"guid":"815be1b5-6f0f-4bdd-abf4-d2c6c8169afb","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762220835,"submitTime":0,"finishTime":1639762221819,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264273046,"guid":"e831b38a-a546-4962-8682-dafb558ab49a","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclient1d","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954328476,"submitTime":0,"finishTime":1639954329643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264273047,"guid":"0f065e54-8640-4489-ae6e-8cb3c9f264e6","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118007478,"submitTime":0,"finishTime":1642118008550,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264273048,"guid":"013d1232-b804-443d-803a-0a0d57391d77","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264273049,"guid":"e4bc8f6d-ac93-4e69-83c5-28968fdd462b","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264273050,"guid":"12c77741-f0b9-4b00-8bda-d8dca7bd575c","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264273051,"guid":"0a797655-a2e2-4fda-bb52-8aab313ad718","subtype":"command","commandType":"auto","position":1.75,"command":"dbutils.widgets.text(\"start_date\", \"\", \"Start Date\")\ndbutils.widgets.text(\"stop_date\", \"\", \"Stop Date\")\ndbutils.widgets.text(\"path\", \"\", \"Folder Path\")\ndbutils.widgets.text(\"name\", \"\", \"File Name\")","commandVersion":43,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{"name":{"widgetType":"text","name":"name","defaultValue":"","label":"File Name","options":{"widgetType":"text","validationRegex":null}},"stop_date":{"widgetType":"text","name":"stop_date","defaultValue":"","label":"Stop Date","options":{"widgetType":"text","validationRegex":null}},"path":{"widgetType":"text","name":"path","defaultValue":"","label":"Folder Path","options":{"widgetType":"text","validationRegex":null}},"start_date":{"widgetType":"text","name":"start_date","defaultValue":"","label":"Start Date","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323191,"submitTime":1646328319651,"finishTime":1646328323222,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2c467533-bc77-4ab9-9dcf-235b41201a1c"},{"version":"CommandV1","origId":2937788264273052,"guid":"99c1a707-e24b-4328-8d1c-0808efacca22","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":177,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762221837,"submitTime":0,"finishTime":1639762230127,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264273053,"guid":"49c18d4e-4d79-4988-9b3e-4263f3e083b4","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":177,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954329655,"submitTime":0,"finishTime":1639954338546,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264273054,"guid":"5fcc4f39-a9fe-4caf-9fd5-991b213c3d12","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":185,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118008602,"submitTime":0,"finishTime":1642118016873,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264273055,"guid":"47096a42-80a4-4f0c-b2d4-639f243a748a","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264273056,"guid":"03326548-dd80-4543-a2d0-d5502d5e0781","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264273057,"guid":"cd99969a-4cbd-4422-84b1-9ce93569a3f3","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264273058,"guid":"c8e62900-185e-4299-ada6-7499b2b9b3c8","subtype":"command","commandType":"auto","position":1.875,"command":"start_date = dbutils.widgets.get(\"start_date\")\nstop_date = dbutils.widgets.get(\"stop_date\")\npath = dbutils.widgets.get(\"path\")\nname = dbutils.widgets.get(\"name\")","commandVersion":28,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{"name":"cat-job-close","stop_date":"2021-06-23 16:49:00","path":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/Dummy_test/pps_outage/","start_date":"2021-06-20 22:00:00"},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323245,"submitTime":1646328319665,"finishTime":1646328323281,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4bbb6e59-3bb9-40f9-90ec-56094095f4af"},{"version":"CommandV1","origId":2937788264273059,"guid":"5aa17e9a-0e60-41dc-9ab2-4952f2f82d99","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762230139,"submitTime":0,"finishTime":1639762230187,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264273060,"guid":"0900ccfd-5470-47ea-bdea-ab8d1547804c","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954338563,"submitTime":0,"finishTime":1639954338604,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264273061,"guid":"4d777622-3dad-492d-b7cf-5074bd97ff3b","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118016901,"submitTime":0,"finishTime":1642118016951,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264273062,"guid":"8a9d348a-2845-4079-adc1-2bf67ef60b50","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639762230204,"submitTime":0,"finishTime":1639762230586,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4855f577-7e10-4c80-94c6-6ec006e0d5a3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264273063,"guid":"188a848e-140f-4003-87e0-9afb86da5029","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1639954338629,"submitTime":0,"finishTime":1639954338943,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5dd54b42-4f3b-4ac9-98a5-f6bffb880dfd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264273064,"guid":"d9fb21fb-e9f5-479e-9351-3fb63f46eeb1","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1642118016984,"submitTime":0,"finishTime":1642118017343,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c2dae010-b758-430b-a504-340ca3b43787"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264273065,"guid":"1ba92a9c-f234-4e3a-bc35-5ad76f443a1c","subtype":"command","commandType":"auto","position":2.0,"command":"#start_date = \"2021-10-11 09:24:00\"\n#stop_date = \"2021-10-13 12:24:02\"","commandVersion":65,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323288,"submitTime":1646328319695,"finishTime":1646328323315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f144a517-ca11-44ba-8706-d5659624e4ab"},{"version":"CommandV1","origId":2937788264273066,"guid":"dc85126e-6b60-43be-a99a-8a8fb6b6cc0b","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n# A) Prep data","commandVersion":37,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"caa0e9ee-64c4-4c9f-9108-78ee4b69ba5e"},{"version":"CommandV1","origId":2937788264273067,"guid":"9106d663-bd7e-48cd-967c-d65db7f7571b","subtype":"command","commandType":"auto","position":3.25,"command":"%md\n#### Read in functions","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b6d80caf-609f-488f-a35e-057f4ce9c3d6"},{"version":"CommandV1","origId":2937788264273068,"guid":"95522a85-6967-450f-ad3a-9f5a0e2c71b5","subtype":"command","commandType":"auto","position":3.5,"command":"from datetime import datetime, timedelta\nimport itertools\nfrom pyspark.sql.functions import col, substring, row_number, when, lit, to_timestamp, length, lag, greatest, last, sum, expr, min, unix_timestamp, monotonically_increasing_id\nfrom pyspark.sql.window import Window\n\n#spark.conf.set(\"spark.databricks.io.cache.enabled\", True)","commandVersion":96,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323321,"submitTime":1646328319837,"finishTime":1646328323347,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"89c0e9dc-6d52-442b-a841-98e3cb1e4c4e"},{"version":"CommandV1","origId":2937788264273069,"guid":"740939c7-412a-4374-b5a3-bcde9ebdf71c","subtype":"command","commandType":"auto","position":4.0,"command":"date_fmt = \"%Y-%m-%d %H:%M:%S\"\nstart_dt = datetime.strptime(start_date, date_fmt) + timedelta(hours=-10)\nstop_dt = datetime.strptime(stop_date, date_fmt) + timedelta(hours=72)\n\nami_start_part_key = int(f\"{start_dt.year}{'{:02d}'.format(start_dt.month)}{'{:02d}'.format(start_dt.day)}\")\nami_stop_part_key = int(f\"{stop_dt.year}{'{:02d}'.format(stop_dt.month)}{'{:02d}'.format(stop_dt.day)}\")\n\ndate_range_key = list(map(lambda x: str(x), range(ami_start_part_key, ami_stop_part_key + 1)))\ndate_ym_key = list(set(map(lambda x: x[0:6], date_range_key)))\n\np_read_time_lt_query = \",\".join(date_range_key)\np_read_time_lt_ym_query = \",\".join(date_ym_key)","commandVersion":340,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323353,"submitTime":1646328319865,"finishTime":1646328323386,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad182cb4-e7b6-4bcb-8681-4994108ab24f"},{"version":"CommandV1","origId":2937788264273070,"guid":"a4a7ff5d-53d5-48a0-a6f6-97fa5dff9613","subtype":"command","commandType":"auto","position":4.5,"command":"%md\n#### List of outage TYCOD values","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5ee2d3f5-69ef-4801-8e88-9fc09bf59848"},{"version":"CommandV1","origId":2937788264273071,"guid":"66ccc4c2-9e44-4129-b4da-fae6a2d39a58","subtype":"command","commandType":"auto","position":4.75,"command":"outage_types = ['CP','FUSE','ISO','OHCKT','OHTRANS','RECLO','UGCKT','UGPSC','UGTRANS', 'CUTCOND','OHDS','OHSWC','UGDS','UGFUSE', 'SDXL','ONELEG','XCURR','TEMPOHDS','TEMPFUSE']","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323391,"submitTime":1646328319968,"finishTime":1646328323421,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"989c8186-2b4a-4ab0-9559-17ff2ca81de5"},{"version":"CommandV1","origId":2937788264273072,"guid":"1a3eef6f-5891-45ce-ad46-a5f897311be1","subtype":"command","commandType":"auto","position":4.8125,"command":"%md\n#### Build storm timeline intervals","commandVersion":18,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4bf40d2a-058e-4c6b-92ff-3f53996a0b7f"},{"version":"CommandV1","origId":2937788264273073,"guid":"bfb8e90e-3bfc-46bf-a62c-92c9a59f0b83","subtype":"command","commandType":"auto","position":4.828125,"command":"rng = itertools.count(0,1)\n  \ndate_rng = map(lambda x: {\"interval\": f\"+{x} hours\", \"time_step\": x, \"end_time_step\": x+1, \"interval_tm_start\": start_dt + timedelta(hours=x),\"interval_tm_stop\": start_dt + timedelta(hours=(x+1))}, rng)\ninterval_data = itertools.takewhile(lambda x: x[\"interval_tm_start\"] <= stop_dt, date_rng)\n\ninterval_df = spark.createDataFrame(interval_data)","commandVersion":288,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/spark/python/pyspark/sql/session.py:387: UserWarning: inferring schema from dict is deprecated,please use pyspark.sql.Row instead\n  warnings.warn(&#34;inferring schema from dict is deprecated,&#34;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323432,"submitTime":1646328320030,"finishTime":1646328323864,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"217e40d8-0883-412c-b209-3b2f50be38f3"},{"version":"CommandV1","origId":2937788264273074,"guid":"cbb24421-b0a0-46db-9f46-f4b211f36a61","subtype":"command","commandType":"auto","position":4.9140625,"command":"%md\n#### Build job timeline intervals","commandVersion":14,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f072b229-6a15-4f3a-96b4-6a6540b72871"},{"version":"CommandV1","origId":2937788264273075,"guid":"b8a96445-44c4-4436-8519-b99c3b3d728d","subtype":"command","commandType":"auto","position":4.916748046875,"command":"%md\n#### Set reporting intervals\n\n##### To update\n\nFill in the hour intervals below in \"hour_intervals\". The interval is the hour length of the interval [2, 3] means the first interval will be up to hour 2 and the second will be 2-5 (length 3). A catch all interval will be added (in the example case 5+)\n","commandVersion":82,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4044c64b-38cb-430d-9334-5d3df29bcd18"},{"version":"CommandV1","origId":2937788264273076,"guid":"00265096-9af8-402b-b6a7-7d9ab36e668c","subtype":"command","commandType":"auto","position":4.91943359375,"command":"hour_intervals = [2] * 48\n\n\nimport pyspark.sql.functions as F\nimport pyspark.sql.types as T\nfrom pyspark.sql.types import StringType\nfrom pyspark.sql.functions import udf\n\na = 2\nclass conversion():\n  #This is the UDF. \n  @staticmethod\n  def min_func(a):\n    return a*60\n  @staticmethod\n  def hour_func(y):\n    return y*60*60\n  #This is the function that registers the UDF, \n  def input(self, a, target):\n      interval_data =  [{'job_interval':  '0' + '-' +  str(a) +  ' min',  'job_time_step': 0, 'job_end_time_step': conversion.min_func(a)}, {'job_interval': str(a)+' min' + '-' + str(target[0]) + ' hour', 'job_time_step': conversion.min_func(a), 'job_end_time_step': conversion.hour_func(target[0])}] \n      for i in range(len(target)):\n          if (i != 0):\n              lst = []\n              for n in range(i):\n                  lst.append(target[n])\n              prev = 0\n              for j in lst:\n                   prev = j + prev\n              nst = []\n              for n in range(i+1):\n                  nst.append(target[n])\n              later = 0\n              for h in nst:\n                  later = h + later\n              interval_data = interval_data + [ {'job_interval': str(prev) + ' hour' + '-' +  str(later) + ' hour', 'job_time_step': conversion().hour_func(prev),  'job_end_time_step': conversion().hour_func(later)}]\n      interval_data = interval_data +  [{'job_interval': str(later)+ ' hours+', 'job_time_step' : conversion().hour_func(later), 'job_end_time_step': 999999}] \n      return interval_data","commandVersion":309,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323876,"submitTime":1646328320118,"finishTime":1646328323913,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d16e178d-34c3-44cc-b9a3-163d35502197"},{"version":"CommandV1","origId":2937788264273077,"guid":"4168810a-286d-447d-bdfa-82a2b08e557e","subtype":"command","commandType":"auto","position":4.922119140625,"command":"interval_data = conversion().input(a, hour_intervals)\njob_interval_data = spark.createDataFrame(interval_data)","commandVersion":7,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_interval_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328323919,"submitTime":1646328320143,"finishTime":1646328324009,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ee6a2ebd-b20d-483c-9180-3f2b969c3717"},{"version":"CommandV1","origId":2937788264273078,"guid":"feeb9acf-7ade-4419-b0d6-01e9043fddcc","subtype":"command","commandType":"auto","position":4.9288330078125,"command":"# last_interval = 96\n# hour_step = 2\n# rng = itertools.count(0, hour_step)\n\n# def create_job_interval(hour: int):\n#     return {\"job_interval\": f\"{hour} - {hour+hour_step} hours\", \n#             \"job_time_step\": hour * 3600,\n#             \"job_end_time_step\": (hour+hour_step) * 3600}\n\n# date_rng = map(create_job_interval, rng)\n\n# interval_data = [*itertools.takewhile(lambda x: x[\"job_end_time_step\"] <= last_interval * 3600, date_rng)]\n# final_interval = [{\"job_interval\": f\"{last_interval}+ hours\", \n#                   \"job_time_step\": last_interval * 3600,\n#                   \"job_end_time_step\": (last_interval * 100) * 3600}]\n\n# job_interval_data = spark.createDataFrame(interval_data + final_interval)","commandVersion":94,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328324015,"submitTime":1646328320171,"finishTime":1646328324044,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"459","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"621a52eb-a34e-4662-aa37-873c4381f09e"},{"version":"CommandV1","origId":2937788264273079,"guid":"c5efefeb-1dcb-4c74-a939-be9b2aca5044","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n#### Filter outage interval for time period and outage events and convert to list of events","commandVersion":45,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7fa5b965-f998-4707-b6bd-7b49793b5296"},{"version":"CommandV1","origId":2937788264273080,"guid":"4aee4da9-4bc6-4b39-b1b8-046ef557ece8","subtype":"command","commandType":"auto","position":7.0,"command":"import pyspark.sql.functions as f\ncol = f.col\n\n#filtered_outage_intervals_df = spark.sql(\"\"\"select event_number, premise, tycod, out_dt_tm, on_dt_tm \nfiltered_outage_intervals_df2 = spark.sql(\"\"\"select *\n                                            from edw.location_outage_history\"\"\") \\\n  .filter(col(\"tycod\").isin(outage_types) & \\\n          (col(\"OUT_DT_TM\") >= start_date) & \\\n          (col(\"ON_DT_TM\") <= stop_date) & \\\n          (col(\"EVENT_STATUS\") != 'C') )\n","commandVersion":425,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_outage_intervals_df2","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"PREMISE","nullable":true,"type":"long"},{"metadata":{},"name":"EVENT_NUMBER","nullable":true,"type":"string"},{"metadata":{},"name":"REV_NUM","nullable":true,"type":"long"},{"metadata":{},"name":"CIRCUIT_OPERATION_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CIRCUIT","nullable":true,"type":"string"},{"metadata":{},"name":"SECT_POINT","nullable":true,"type":"string"},{"metadata":{},"name":"TYCOD","nullable":true,"type":"string"},{"metadata":{},"name":"CAUSE_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"OUT_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"ON_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"RESOLVED_UNRESOLVED_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CREW_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_CALLED_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CALLBACK_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_REP","nullable":true,"type":"string"},{"metadata":{},"name":"DATE_ADDED_TO_HIS","nullable":true,"type":"timestamp"},{"metadata":{},"name":"STILL_IN_INSERVICE","nullable":true,"type":"string"},{"metadata":{},"name":"EVENT_STATUS","nullable":true,"type":"string"},{"metadata":{},"name":"AMI_CALLED_CODE","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328324060,"submitTime":1646328320233,"finishTime":1646328326503,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"49d811d5-ef34-4a50-82b1-b5974195764d"},{"version":"CommandV1","origId":2937788264273081,"guid":"df02922b-202d-4f42-b5b5-d24a8f174418","subtype":"command","commandType":"auto","position":7.625,"command":"from pyspark.sql.functions import *\n\nfiltered_outage_intervals_df3 = filtered_outage_intervals_df2.withColumn('from_timestamp', to_timestamp(col('OUT_DT_TM')))\\\n  .withColumn('end_timestamp', to_timestamp(col('ON_DT_TM')))\\\n  .withColumn('DiffInSeconds', col('end_timestamp').cast('long') - col('from_timestamp').cast('long')).drop('from_timestamp', 'end_timestamp').filter(col('DiffInSeconds') >= 300).drop('DiffInSeconds')\n\n#filtered_outage_intervals_df.select('OUT_DT_TM', 'ON_DT_TM').show()","commandVersion":239,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_outage_intervals_df3","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"PREMISE","nullable":true,"type":"long"},{"metadata":{},"name":"EVENT_NUMBER","nullable":true,"type":"string"},{"metadata":{},"name":"REV_NUM","nullable":true,"type":"long"},{"metadata":{},"name":"CIRCUIT_OPERATION_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CIRCUIT","nullable":true,"type":"string"},{"metadata":{},"name":"SECT_POINT","nullable":true,"type":"string"},{"metadata":{},"name":"TYCOD","nullable":true,"type":"string"},{"metadata":{},"name":"CAUSE_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"OUT_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"ON_DT_TM","nullable":true,"type":"timestamp"},{"metadata":{},"name":"RESOLVED_UNRESOLVED_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CREW_IND","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_CALLED_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CALLBACK_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"CUST_REP","nullable":true,"type":"string"},{"metadata":{},"name":"DATE_ADDED_TO_HIS","nullable":true,"type":"timestamp"},{"metadata":{},"name":"STILL_IN_INSERVICE","nullable":true,"type":"string"},{"metadata":{},"name":"EVENT_STATUS","nullable":true,"type":"string"},{"metadata":{},"name":"AMI_CALLED_CODE","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328326512,"submitTime":1646328320262,"finishTime":1646328326678,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4cc7cdd1-beff-4176-bd0c-b680aebd8a13"},{"version":"CommandV1","origId":2937788264273082,"guid":"335d2f3e-7f40-4453-86bd-2b17ca3881ac","subtype":"command","commandType":"auto","position":7.9375,"command":"filtered_outage_intervals_df = filtered_outage_intervals_df3.select('event_number', 'premise', 'tycod', 'out_dt_tm', 'on_dt_tm')","commandVersion":27,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_outage_intervals_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328326688,"submitTime":1646328320299,"finishTime":1646328326748,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e9e3d63b-0022-4f21-8544-05ee1c8cb6a5"},{"version":"CommandV1","origId":2937788264273083,"guid":"1c197a2f-9291-4ec9-a8fb-f6b7df6be67d","subtype":"command","commandType":"auto","position":8.25,"command":"%md\n#### Merge with cispersl2 to get premise ID","commandVersion":14,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0ddce117-8036-4370-83c6-24384b5a04ad"},{"version":"CommandV1","origId":2937788264273084,"guid":"b4008666-20bb-484e-b779-3f6df4980246","subtype":"command","commandType":"auto","position":8.5,"command":"outage_df = filtered_outage_intervals_df.join(spark.sql(\"\"\"select METER_NUM as meter_number, premise from edw.cispersl2\n                                                            where DISCON_FOR_NON_PAY='A' and AMI_ENABLED = 'T'\"\"\"),\\\n                                  \"premise\",\\\n                                  \"inner\") \\\n  .withColumnRenamed(\"out_dt_tm\", \"job_out_dt_tm\") \\\n  .withColumnRenamed(\"on_dt_tm\", \"job_on_dt_tm\") \\\n  .withColumnRenamed(\"meter_number\", \"job_meter_number\") \\\n  .withColumnRenamed(\"premise\", \"job_premise\") ","commandVersion":151,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outage_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_premise","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328326755,"submitTime":1646328320368,"finishTime":1646328336201,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a6a4b5b5-1e3b-47cb-80d0-59e01f5bb096"},{"version":"CommandV1","origId":2937788264273085,"guid":"336f1e08-3e62-4e7e-8a48-3c6c271104d7","subtype":"command","commandType":"auto","position":8.625,"command":"%md \n##### Create distinct list of meters impacted by outage events","commandVersion":13,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ffdacc2d-82db-4880-a41d-b1f78add0172"},{"version":"CommandV1","origId":2937788264273086,"guid":"2066c0c7-bea4-466b-a21f-968e93bd949a","subtype":"command","commandType":"auto","position":8.75,"command":"filtered_premise_meter_df = outage_df \\\n  .select(\"job_premise\", \"job_meter_number\") \\\n  .distinct() \\\n  .withColumnRenamed(\"job_premise\", \"premise\") \\\n  .withColumnRenamed(\"job_meter_number\", \"meter_number\")","commandVersion":9,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered_premise_meter_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328336210,"submitTime":1646328320423,"finishTime":1646328336290,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"83340a16-246b-4ae2-abce-a39075a204f4"},{"version":"CommandV1","origId":2937788264273087,"guid":"f17ebfe6-f50d-43f7-bef3-0ba997734af8","subtype":"command","commandType":"auto","position":8.875,"command":"%md\n#### Create counts by outage job to select largest outage jobs for tie break when jobs overlap\n\nLower rank indicates a larger job size","commandVersion":47,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6cc58b95-3d9d-4dbe-9147-85cb3a4d49df"},{"version":"CommandV1","origId":2937788264273088,"guid":"9a57a1bf-eb36-4ce3-8070-f48cd6d9cf6a","subtype":"command","commandType":"auto","position":8.9375,"command":"from pyspark.sql.functions import count\n\nwindow = Window.orderBy(col(\"meters_in_job\").desc())\n\njob_rank = outage_df \\\n  .groupBy(col(\"event_number\")) \\\n  .agg(count(col(\"job_meter_number\")).alias(\"meters_in_job\")) \\\n  .withColumn(\"job_rank\", row_number().over(window)) \\\n  .drop(\"meters_in_job\")","commandVersion":139,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_rank","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328336299,"submitTime":1646328320474,"finishTime":1646328336452,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"427","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"07866606-93b9-4151-849f-961b607bbe85"},{"version":"CommandV1","origId":2937788264273089,"guid":"96641365-ea96-4493-9bb5-bf78a15de062","subtype":"command","commandType":"auto","position":8.96875,"command":"outage_premise_df = outage_df \\\n  .join(job_rank, \"event_number\", \"inner\")","commandVersion":28,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outage_premise_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_premise","nullable":true,"type":"long"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328336459,"submitTime":1646328320497,"finishTime":1646328336566,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0678eb7f-508a-4828-86f3-d0d724e5ca93"},{"version":"CommandV1","origId":2937788264273090,"guid":"73839258-73e1-45be-b903-0611476afa0a","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n#### Pull in relevant AMI voltage reads\n1. Grab AMI reads filtered by local date partition key\n2. Inner join with filtered outage events by premise ID\n3. Keep: meter ID, premise ID, volatage read, read time, read_time local, eda ingestion time\n4. Group by meter, premise, eda ingestion time\n5. Order by max read time and max Vh(a)","commandVersion":281,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"63e18403-eb74-4613-9215-d96e41900712"},{"version":"CommandV1","origId":2937788264273091,"guid":"e8f96288-f4e4-4c72-bf7a-2fda41bbe2ed","subtype":"command","commandType":"auto","position":10.25,"command":"%md\n#### Select the meters impacted and cut down to leading two digits for partition query","commandVersion":23,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0269f3ec-efb3-45f5-9159-db85269886c4"},{"version":"CommandV1","origId":2937788264273092,"guid":"e3d2f5a2-84f2-4bfc-85f4-340dd3c0cf36","subtype":"command","commandType":"auto","position":10.5,"command":"meter_range = outage_premise_df \\\n  .select(col(\"job_meter_number\")).rdd \\\n  .distinct().flatMap(lambda x: x).collect()\n\nmeter_range_key = list(map(lambda x: x[-2:], filter(lambda x: x != None, meter_range)))\np_mpartkey_query = \"'\" + \"','\".join(meter_range_key) + \"'\"","commandVersion":244,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328336572,"submitTime":1646328320644,"finishTime":1646328363146,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ac9beb43-df67-48d1-b3e3-57bc9b75137b"},{"version":"CommandV1","origId":2937788264273093,"guid":"02fa0fd5-828f-4357-ac05-1d7a779ec1a7","subtype":"command","commandType":"auto","position":10.75,"command":"%md\n#### Create query on voltage intervals\nPer discussion we are filtering for Vh(a) and then multiplying by 12 to get an hourly read","commandVersion":34,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"089ffad0-c04a-423f-83f5-82151d75940f"},{"version":"CommandV1","origId":2937788264273094,"guid":"bac25263-2b11-47b4-867e-54db941a9aef","subtype":"command","commandType":"auto","position":11.0,"command":"intermediate_df = spark.sql(\"\"\"select * from edw.ami_voltage_intervals\n                                         where p_read_time_lt in ({0}) and\n                                              p_mpartkey in ({1}) and\n                                               meter_quantity = 'Vh(a)'\"\"\".format(p_read_time_lt_query, p_mpartkey_query))\n\ntrimmed_volt_reads_df = intermediate_df.join(outage_premise_df, intermediate_df.meter_number == outage_premise_df.job_meter_number, \"inner\") \\\n                            .select(col(\"meter_number\"), col(\"meter_quantity\"), col(\"read_time_localtime\"),\\\n                                    col(\"read_value\"), col(\"eda_creation_date_localtime\")) \\\n                            .withColumn(\"full_read_value\", col(\"read_value\") * 12)","commandVersion":457,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"intermediate_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"meter_quantity","nullable":true,"type":"string"},{"metadata":{},"name":"read_time","nullable":true,"type":"timestamp"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"read_value","nullable":true,"type":"decimal(22,6)"},{"metadata":{},"name":"interval_length","nullable":true,"type":"integer"},{"metadata":{},"name":"profile_status_list","nullable":true,"type":"string"},{"metadata":{},"name":"pulse_multiplier","nullable":true,"type":"decimal(15,6)"},{"metadata":{},"name":"meter_esn","nullable":true,"type":"string"},{"metadata":{},"name":"device_class","nullable":true,"type":"string"},{"metadata":{},"name":"scaling_type","nullable":true,"type":"string"},{"metadata":{},"name":"eda_creation_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"filename","nullable":true,"type":"string"},{"metadata":{},"name":"p_read_time_lt","nullable":true,"type":"integer"},{"metadata":{},"name":"p_read_time","nullable":true,"type":"integer"},{"metadata":{},"name":"p_mpartkey","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"trimmed_volt_reads_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"meter_quantity","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"read_value","nullable":true,"type":"decimal(22,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328363159,"submitTime":1646328320703,"finishTime":1646328371946,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"979","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a61a5fab-617f-479d-87c4-64e4f7c8624c"},{"version":"CommandV1","origId":2937788264273095,"guid":"223ba0f9-62cf-4b23-bedd-ea1f95c210db","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n#### Group by meter number, event number, eda creation date and select max read time prior to ingestion time and full read value (this last shouldn't matter) row","commandVersion":67,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9096c5bc-a25d-4c20-a69e-b8b29efd2e7a"},{"version":"CommandV1","origId":2937788264273096,"guid":"ff2c8dc5-3178-4837-8c04-1ad33f89b355","subtype":"command","commandType":"auto","position":13.0,"command":"window = Window.partitionBy(col(\"meter_number\"), \\\n                            col(\"eda_creation_date_localtime\")) \\\n  .orderBy(col(\"read_time_localtime\").desc())\n\nselected_volt_per_interval_df = trimmed_volt_reads_df \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .select(col(\"meter_number\"),  col(\"read_time_localtime\"), col(\"full_read_value\"), \\\n          col(\"eda_creation_date_localtime\"))","commandVersion":248,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"selected_volt_per_interval_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328371952,"submitTime":1646328320803,"finishTime":1646328372365,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e5b3c1a7-1fa4-4c65-a60e-b35b90907051"},{"version":"CommandV1","origId":2937788264273097,"guid":"a19dca0c-6c64-4bac-9a9f-c3290d9ffabd","subtype":"command","commandType":"auto","position":14.5,"command":"%md\n#### Attach nominal voltage and calculate nominal voltage percent","commandVersion":17,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3c57e696-554f-47fb-b6ad-37dd1033fd51"},{"version":"CommandV1","origId":2937788264273098,"guid":"37ff8bd3-c498-4409-9422-e26e9e3b0847","subtype":"command","commandType":"auto","position":16.0,"command":"nmnl_volt_df = spark.sql(\"\"\"select METER_NUMBER as meter_number, NMNL_VOLT_A as nmnl_volt from edw.nmnlvltg\"\"\")","commandVersion":53,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"nmnl_volt_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"nmnl_volt","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328372371,"submitTime":1646328320865,"finishTime":1646328373144,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1734","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b2468589-980b-47f7-af77-f299191bf95f"},{"version":"CommandV1","origId":2937788264273099,"guid":"31947e5f-db46-42db-bc11-53c9a21ee0c3","subtype":"command","commandType":"auto","position":17.0,"command":"volt_per_interval_nominal_df = selected_volt_per_interval_df \\\n  .join(nmnl_volt_df, \"meter_number\", \"inner\") \\\n  .withColumn(\"nmnl_volt_pct\", col(\"full_read_value\") / col(\"nmnl_volt\")) \\\n  .withColumnRenamed(\"meter_number\", \"meter_number_volt\") \\\n  .drop(col(\"nmnl_volt\"))","commandVersion":137,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"volt_per_interval_nominal_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number_volt","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328373151,"submitTime":1646328320897,"finishTime":1646328373733,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1840","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e04c137e-a645-4e7a-9c76-bfdf6ab00d95"},{"version":"CommandV1","origId":2937788264273100,"guid":"2ed41ad8-6f6a-4bd4-8452-baa7f8b797a8","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n# B) Create intervals, job status and initial power status","commandVersion":19,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"12342dd5-b691-4885-aae1-5209da529d08"},{"version":"CommandV1","origId":2937788264273101,"guid":"ec28b3ae-92dd-4631-a5da-bacaf74be1b6","subtype":"command","commandType":"auto","position":21.0,"command":"full_meter_intervals = filtered_premise_meter_df \\\n  .join(interval_df)","commandVersion":143,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"full_meter_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328373739,"submitTime":1646328320970,"finishTime":1646328373776,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"273","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a158c049-2ae3-4519-8573-1ae7b04ac57b"},{"version":"CommandV1","origId":2937788264273102,"guid":"ca12653e-bdd8-4283-8d70-56d9d97edb65","subtype":"command","commandType":"auto","position":21.5,"command":"%md\n#### Join on jobs and handle overlapping by taking the most populous job if two","commandVersion":34,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c87ec20a-c554-4be5-b0d4-823279ed5fe5"},{"version":"CommandV1","origId":2937788264273103,"guid":"2f12c7b9-0e0b-48c1-b4aa-107d73ba1b5c","subtype":"command","commandType":"auto","position":22.0,"command":"cond_jobs = (col(\"job_meter_number\") == col(\"meter_number\")) & \\\n             ((col(\"job_out_dt_tm\").between(col(\"interval_tm_start\"), col(\"interval_tm_stop\"))) | \\\n             (col(\"job_on_dt_tm\").between(col(\"interval_tm_start\"), col(\"interval_tm_stop\"))) | \\\n             ((col(\"job_out_dt_tm\") <= col(\"interval_tm_start\")) & (col(\"job_on_dt_tm\") >= col(\"interval_tm_stop\"))))\n              \nraw_outage_intervals = full_meter_intervals \\\n  .join(outage_premise_df.drop(\"job_premise\"), on=cond_jobs, how=\"left_outer\")\n\n\nwindow = Window.partitionBy(raw_outage_intervals.meter_number, col(\"interval\")) \\\n  .orderBy(col(\"job_rank\"))\n\nselected_outage_intervals = raw_outage_intervals \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"job_rank\")","commandVersion":374,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"raw_outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"job_out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328373782,"submitTime":1646328321051,"finishTime":1646328373930,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1997","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a2fa8fd3-fb80-4fa2-856e-c13acb4ff9c7"},{"version":"CommandV1","origId":2937788264273104,"guid":"dec92d66-5532-4105-988f-21bb213aa362","subtype":"command","commandType":"auto","position":22.25,"command":"outage_intervals = selected_outage_intervals \\\n  .drop(\"job_meter\") \\\n  .withColumnRenamed(\"job_out_dt_tm\", \"out_dt_tm\") \\\n  .withColumnRenamed(\"job_on_dt_tm\", \"on_dt_tm\") \\\n  .withColumn(\"job_status\", when(col(\"on_dt_tm\") > col(\"interval_tm_stop\"),  lit(\"Job Open\"))\n                           .when(col(\"on_dt_tm\") <= col(\"interval_tm_stop\"), lit(\"Job Closed\"))\n                           .otherwise(lit(\"Job Closed\"))) \\\n  .withColumn(\"job_start\", when(col(\"out_dt_tm\") >= col(\"interval_tm_start\"), lit(\"Yes\"))) \\\n  .withColumn(\"power_status\", lit(None))","commandVersion":254,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328373937,"submitTime":1646328321074,"finishTime":1646328374070,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5af76aeb-8b0d-42aa-8d90-e1b081aa9546"},{"version":"CommandV1","origId":2937788264273105,"guid":"99169cbf-da9f-408a-9932-5d73e2feb47f","subtype":"command","commandType":"auto","position":22.34375,"command":"%md\n#### Create small interval around job start\n\n1. job_start_intervals creates an interval 1 minute around the job inside the starting interval and puts it at 0.2 to keep it in order\n2. job_prior_intervals splits the original starting interval into an interval before the job starts\n3. On the interval right before a job, check that there isn't a prior job that just ended","commandVersion":74,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f0d5f545-03c4-4664-97ec-0db7b8d44bd5"},{"version":"CommandV1","origId":2937788264273106,"guid":"71800916-073b-47a3-8460-78162b903e49","subtype":"command","commandType":"auto","position":22.4375,"command":"check_not_middle_job_window = Window.partitionBy(col(\"meter_number\")).orderBy(col(\"time_step\"))\n\njob_start_intervals = outage_intervals.filter(col(\"job_start\") == \"Yes\") \\\n  .withColumn(\"job_status\", lit(\"Job Open\")) \\\n  .withColumn(\"interval_tm_start\", col(\"out_dt_tm\")) \\\n  .withColumn(\"interval_tm_stop\", col(\"out_dt_tm\") + expr('INTERVAL 1 minutes')) \\\n  .withColumn(\"time_step\", col(\"time_step\") + 0.2)\n\njob_prior_intervals = outage_intervals.filter(col(\"job_start\") == \"Yes\") \\\n  .withColumn(\"interval_tm_stop\", col(\"out_dt_tm\")) \\\n  .withColumn(\"in_between_jobs\", lag(col(\"event_number\"), 1).over(check_not_middle_job_window)) \\\n  .withColumn(\"job_start\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"job_start\"))) \\\n  .withColumn(\"job_status\", when(col(\"in_between_jobs\").isNull(), lit(\"Job Closed\")).otherwise(col(\"job_status\")) ) \\\n  .withColumn(\"out_dt_tm\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"out_dt_tm\"))) \\\n  .withColumn(\"on_dt_tm\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"on_dt_tm\"))) \\\n  .withColumn(\"event_number\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"event_number\"))) \\\n  .withColumn(\"tycod\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"tycod\"))) \\\n  .withColumn(\"job_meter_number\", when(col(\"in_between_jobs\").isNull(), lit(None)).otherwise(col(\"job_meter_number\"))) \\\n  .withColumn(\"time_step\", col(\"time_step\") + 0.1) \\\n  .drop(col(\"in_between_jobs\"))\n\njob_post_intervals = outage_intervals.filter(col(\"job_start\") == \"Yes\") \\\n  .withColumn(\"interval_tm_start\", col(\"out_dt_tm\") + expr('INTERVAL 1 minutes')) \\\n  .withColumn(\"job_start\", lit(None)) \\\n  .withColumn(\"time_step\", col(\"time_step\") + 0.3)\n\nwithout_job_intervals = outage_intervals.filter(col(\"job_start\").isNull())\n\nsplit_outage_intervals = without_job_intervals \\\n  .union(job_start_intervals) \\\n  .union(job_prior_intervals) \\\n  .union(job_post_intervals)","commandVersion":389,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_start_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"job_prior_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"job_post_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"null"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"without_job_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"long"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null},{"name":"split_outage_intervals","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328374076,"submitTime":1646328321127,"finishTime":1646328374657,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2303","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c9de62dc-848f-4d92-9b74-bf80b044b450"},{"version":"CommandV1","origId":2937788264273107,"guid":"f3d3df49-41a3-475f-9153-a338610cfcdd","subtype":"command","commandType":"auto","position":22.71875,"command":"job_start_intervals.columns","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[30]: [&#39;premise&#39;,\n &#39;meter_number&#39;,\n &#39;end_time_step&#39;,\n &#39;interval&#39;,\n &#39;interval_tm_start&#39;,\n &#39;interval_tm_stop&#39;,\n &#39;time_step&#39;,\n &#39;event_number&#39;,\n &#39;tycod&#39;,\n &#39;out_dt_tm&#39;,\n &#39;on_dt_tm&#39;,\n &#39;job_meter_number&#39;,\n &#39;job_status&#39;,\n &#39;job_start&#39;,\n &#39;power_status&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328374663,"submitTime":1646328321151,"finishTime":1646328374687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",393]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ac697fa9-4316-4b24-9166-0dcece05a43c"},{"version":"CommandV1","origId":2937788264273108,"guid":"e9baea36-96e2-411e-946c-bc5ed41e74a0","subtype":"command","commandType":"auto","position":22.859375,"command":"job_prior_intervals.columns","commandVersion":3,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[31]: [&#39;premise&#39;,\n &#39;meter_number&#39;,\n &#39;end_time_step&#39;,\n &#39;interval&#39;,\n &#39;interval_tm_start&#39;,\n &#39;interval_tm_stop&#39;,\n &#39;time_step&#39;,\n &#39;event_number&#39;,\n &#39;tycod&#39;,\n &#39;out_dt_tm&#39;,\n &#39;on_dt_tm&#39;,\n &#39;job_meter_number&#39;,\n &#39;job_status&#39;,\n &#39;job_start&#39;,\n &#39;power_status&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328374700,"submitTime":1646328321178,"finishTime":1646328374722,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",393]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4ef7932b-de6a-4f93-b08a-2711e55d7ec7"},{"version":"CommandV1","origId":2937788264273109,"guid":"7fbd7c19-8dea-4250-828e-2d712aaa8ca8","subtype":"command","commandType":"auto","position":23.0,"command":"%md\n### Join all indications/events\n1. Join the voltage reads\n2. Join on PPU up events\n3. Join on calls","commandVersion":35,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cc16a369-8cd4-45ef-9697-10eb9cc8b0fe"},{"version":"CommandV1","origId":2937788264273110,"guid":"e9004296-f1f4-488d-8162-d0c78a0e822b","subtype":"command","commandType":"auto","position":25.5,"command":"%md\n#### 1) Range join on voltage reads\n1. Join where meter number and interval match\n2. Make sure that we take latest eda date inside interval","commandVersion":42,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"df9e4d9b-1d36-4fd4-88cf-86fa543df3f6"},{"version":"CommandV1","origId":2937788264273111,"guid":"04b812b0-f9c6-4810-be59-abd210489c21","subtype":"command","commandType":"auto","position":26.0,"command":"cond_volt = (col(\"meter_number\") == col(\"meter_number_volt\")) & \\\n             (col(\"interval_tm_start\") <= col(\"eda_creation_date_localtime\")) & \\\n             (col(\"interval_tm_stop\") > col(\"eda_creation_date_localtime\"))\n\ninterval_volt_df = split_outage_intervals \\\n    .join(volt_per_interval_nominal_df, on=cond_volt, how=\"left_outer\")\n\nwindow_volt = Window.partitionBy(split_outage_intervals.meter_number, col(\"time_step\")) \\\n  .orderBy(col(\"eda_creation_date_localtime\").desc())\n\nselected_interval_volt_df = interval_volt_df \\\n  .withColumn(\"row\", row_number().over(window_volt)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"event_number_volt\", \"meter_number_volt\", \"read_time_localtime\")","commandVersion":212,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_volt_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"meter_number_volt","nullable":true,"type":"string"},{"metadata":{},"name":"read_time_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_interval_volt_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328374727,"submitTime":1646328321300,"finishTime":1646328375283,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1bc6fb19-d7d1-45d4-88eb-bf8a7e6b2f1d"},{"version":"CommandV1","origId":2937788264273112,"guid":"79e9283c-7a95-4792-838e-13fa6aab4870","subtype":"command","commandType":"auto","position":26.5,"command":"%md\n#### 2) Range join the PPU up events\n1. Join meter number and interval\n2. Make sure to take the latest","commandVersion":26,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2fa75436-fe1a-497a-922e-ad0d18237fea"},{"version":"CommandV1","origId":2937788264273113,"guid":"acdbf80a-254b-40c0-9d58-d6e23ea62e0c","subtype":"command","commandType":"auto","position":27.0,"command":"events_df = spark.sql(\"\"\"select meter_number as meter_number_ppu, event_name, eda_creation_date_localtime as ppu_eda_creation_date_localtime from edw.ami_elc_meter_events\n                         where p_event_time_lt_ym in ({0}) and\n                               p_mpartkey in ({1}) and\n                               event_name = 'Primary Power Up'\"\"\".format(p_read_time_lt_ym_query, p_mpartkey_query))","commandVersion":94,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"events_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number_ppu","nullable":true,"type":"string"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328375288,"submitTime":1646328321353,"finishTime":1646328381079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3891","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a1d54008-3009-4282-a5b0-9ae3362c379d"},{"version":"CommandV1","origId":2937788264273114,"guid":"517817a8-40ed-4998-9179-0cd50a4f25ec","subtype":"command","commandType":"auto","position":27.25,"command":"%md\n##### Take latest PPU inside time interval and join","commandVersion":15,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cb7e04c7-f054-4efe-adca-fc4774af778c"},{"version":"CommandV1","origId":2937788264273115,"guid":"f79c4d7e-f5aa-4672-ad90-c5f8650566af","subtype":"command","commandType":"auto","position":27.5,"command":"cond_event = (col(\"meter_number\") == col(\"meter_number_ppu\")) & \\\n             (col(\"interval_tm_start\") <= col(\"ppu_eda_creation_date_localtime\")) & \\\n             (col(\"interval_tm_stop\") > col(\"ppu_eda_creation_date_localtime\"))\n\ninterval_volt_ppu_df = selected_interval_volt_df \\\n    .join(events_df, on=cond_event, how=\"left_outer\")\n\nwindow = Window.partitionBy(col(\"meter_number\"), col(\"time_step\")) \\\n  .orderBy(col(\"ppu_eda_creation_date_localtime\").desc())\n\nselected_interval_volt_ppu_df = interval_volt_ppu_df \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"event_number_volt\", \"meter_number_ppu\")\n","commandVersion":141,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_volt_ppu_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"meter_number_ppu","nullable":true,"type":"string"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_interval_volt_ppu_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328381092,"submitTime":1646328321460,"finishTime":1646328381963,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3f1355de-cc3b-4d43-a8b9-b23201fa91a8"},{"version":"CommandV1","origId":2937788264273116,"guid":"4d6ba888-46b6-4838-89b6-6c7a7b061d68","subtype":"command","commandType":"auto","position":28.5,"command":"%md\n#### 3) Range join on outage call events","commandVersion":17,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fd099e2b-c3ce-4b25-8197-b80338e942ae"},{"version":"CommandV1","origId":2937788264273117,"guid":"1dbea4d7-4277-42b9-897c-021645db231e","subtype":"command","commandType":"auto","position":28.75,"command":"%md\n##### Create datetime for outage calls","commandVersion":18,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6ad516df-815c-4c5f-af36-0f8068d4d4a7"},{"version":"CommandV1","origId":2937788264273118,"guid":"3b817d25-0be6-4125-a018-d62661d3728f","subtype":"command","commandType":"auto","position":29.0,"command":"outcall_df = spark.sql(\"\"\"select METER_NUM as meter_number_call, EVNTNUM as event_number_call, CDTS, CALLTYPE from edw.outcall\"\"\") \\\n  .withColumn(\"CDTS_trim\", col(\"CDTS\").substr(lit(0), length(col('CDTS')) - 2)) \\\n  .withColumn(\"CDTS_datetime\", to_timestamp(col(\"CDTS_trim\"), \"yyyyMMddHHmmss\")) \\\n  .drop(\"CDTS_trim\", \"CDTS\")","commandVersion":77,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"outcall_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"meter_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"event_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328381970,"submitTime":1646328321541,"finishTime":1646328389280,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c7c976a9-656c-455a-8b27-8159a8b7152e"},{"version":"CommandV1","origId":2937788264273119,"guid":"c349c298-bfe6-42c7-a792-01c656b7fcb1","subtype":"command","commandType":"auto","position":30.0,"command":"%md\n##### Perform the join","commandVersion":6,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d43a9c26-bf07-4439-806b-e7af3f49b6cf"},{"version":"CommandV1","origId":2937788264273120,"guid":"e6e3eb69-0b0a-4de6-9c23-70fd4643fafe","subtype":"command","commandType":"auto","position":31.0,"command":"cond_call = (col(\"meter_number\") == col(\"meter_number_call\")) & \\\n             (col(\"interval_tm_start\") <= col(\"CDTS_datetime\")) & \\\n             (col(\"interval_tm_stop\") > col(\"CDTS_datetime\"))\n\ninterval_volt_ppu_call_df = selected_interval_volt_ppu_df \\\n    .join(outcall_df, on=cond_call, how=\"left_outer\")\n\nwindow = Window.partitionBy(col(\"meter_number\"), col(\"time_step\")) \\\n  .orderBy(col(\"CDTS_datetime\").desc())\n\nselected_interval_volt_ppu_call_df = interval_volt_ppu_call_df \\\n  .withColumn(\"row\", row_number().over(window)) \\\n  .filter(col(\"row\") == 1) \\\n  .drop(\"row\", \"event_number_call\", \"meter_number_call\")","commandVersion":93,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"interval_volt_ppu_call_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"meter_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"event_number_call","nullable":true,"type":"string"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"selected_interval_volt_ppu_call_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328389286,"submitTime":1646328321602,"finishTime":1646328390165,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"db11a464-cdc4-491b-b383-1ad9fa786ac0"},{"version":"CommandV1","origId":2937788264273121,"guid":"786b2792-abe8-4158-ac10-1deb8bed7a76","subtype":"command","commandType":"auto","position":31.5,"command":"%md\n# C) Apply business logic to each meter combo sequentially","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"136fcfdb-4be7-4e12-91f9-efe6064887b7"},{"version":"CommandV1","origId":2937788264273122,"guid":"5013edae-298a-4dc0-bdab-f85ed520b917","subtype":"command","commandType":"auto","position":32.720703125,"command":"%md\n####  Application of business rules","commandVersion":29,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"42942948-833a-463d-97fe-12cf9b119e1a"},{"version":"CommandV1","origId":2937788264273123,"guid":"c8e00d72-bc46-4ffc-a95e-a18f95672e8c","subtype":"command","commandType":"auto","position":32.7216796875,"command":"%md\n1. Update job_status, power_status names\n2. Find the maximum timestamp of events in each interval\n3. Determine which event (voltage read, outage call, PPU - primary power up)\n4. Adding a lag variable to be able to determine when job starts and ends\n5. Mark the discrete events that occur and the power status\n6. Fill in the gaps between jobs\n7. Repeat this process of marking and filling for the Job Open\n8. Calculate the 95% rule at job close \n9. Repeat the mark and fill process","commandVersion":109,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8acf6f44-6f18-47c5-8dfd-8b24f96ed827"},{"version":"CommandV1","origId":2937788264273124,"guid":"53b800b9-b598-4bb2-883b-0173aa781aa6","subtype":"command","commandType":"auto","position":32.72216796875,"command":"%md\n##### Update names, find max timestamp of event, determine which event and add lagging job status variable","commandVersion":32,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bc5a6e62-2387-4c42-9b18-8f647872a4c2"},{"version":"CommandV1","origId":2937788264273125,"guid":"c59c9837-ce55-46ce-97bc-2f7e764d7e76","subtype":"command","commandType":"auto","position":32.72265625,"command":"bus_logic_window = Window.partitionBy(\"meter_number\").orderBy(col(\"time_step\").asc())\n\nrename_voltage_df = selected_interval_volt_ppu_call_df \\\n  .withColumnRenamed('job_status', 'job_status_orig') \\\n  .withColumnRenamed('power_status', 'power_status_orig') \\\n  .withColumn('time_occurence', greatest(col(\"eda_creation_date_localtime\"), col(\"ppu_eda_creation_date_localtime\"), col(\"CDTS_datetime\"))) \\\n  .withColumn(\"max_event\", when(col(\"eda_creation_date_localtime\") == col(\"time_occurence\"), \"volt\") \\\n                          .when(col(\"ppu_eda_creation_date_localtime\") == col(\"time_occurence\"), \"ppu\") \\\n                          .when(col(\"CDTS_datetime\") == col(\"time_occurence\"), \"call\")) \\\n  .withColumn('job_status_over', lag(col(\"job_status_orig\"), 1).over(bus_logic_window)) \\\n  .withColumn('power_status_over', lag(col(\"power_status_orig\"), 1).over(bus_logic_window)) \\\n  .withColumn('event_over', lag(col(\"event_number\"), -1).over(bus_logic_window))\n","commandVersion":98,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"rename_voltage_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig","nullable":true,"type":"null"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_occurence","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_over","nullable":true,"type":"null"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328390172,"submitTime":1646328321784,"finishTime":1646328391698,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3506","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"20ac2fc1-e854-4079-9fe1-3ba8d8cbb1c9"},{"version":"CommandV1","origId":2937788264273126,"guid":"5be60387-423f-4464-a4f5-32ea12a4845f","subtype":"command","commandType":"auto","position":32.728519439697266,"command":"%md\n##### Mark discrete outage events\n\nKeep in mind we have to make sure the outage job is not null for calls to keep call \"No\" response only being updated inside the job window, the lookback will be handled in next step","commandVersion":46,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ba018bb0-99f2-44a2-b731-796ab8502a44"},{"version":"CommandV1","origId":2937788264273127,"guid":"99a1514d-fd4d-44b1-a1ef-63f46691955f","subtype":"command","commandType":"auto","position":32.73438262939453,"command":"\ndiscrete_bis_rules = rename_voltage_df.withColumn(\"power_status_orig\", \n            when((col(\"max_event\") == \"ppu\"), \"Yes\")\n            .when((col(\"max_event\") == \"call\") & (col(\"event_number\").isNotNull()), \"No\")\n            .when((col(\"max_event\") == \"volt\") & (col(\"full_read_value\") < 90), \"No\")\n            .when((col(\"max_event\") == \"volt\") & (col(\"nmnl_volt_pct\") >= 0.92), \"Yes\"))","commandVersion":238,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"discrete_bis_rules","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig","nullable":true,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_occurence","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_over","nullable":true,"type":"null"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328391704,"submitTime":1646328321842,"finishTime":1646328391977,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4329","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"48c5fe67-4e9e-4497-97a2-8a3eba280ad5"},{"version":"CommandV1","origId":2937788264273128,"guid":"20c563be-1b35-4d0e-9f00-5a7643d70c72","subtype":"command","commandType":"auto","position":32.7343864440918,"command":"%md\n##### Switch Yes status to Don't know on job open, mark and fill and get lagging call for first open\n\nWe have call information, we can go back at least two records before, taking the first non-null event we can find (that is between 1 and 2 hours prior to the outage job), then we check if it was a call and the job is opening and mark \"No\"","commandVersion":79,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9e4d35d3-3553-4668-93e2-d9a52589ed2c"},{"version":"CommandV1","origId":2937788264273129,"guid":"099bee06-a298-4741-8e87-8644d957c0cb","subtype":"command","commandType":"auto","position":32.73439025878906,"command":"full_business_no_95_rule = discrete_bis_rules \\\n  .withColumn('power_status_orig_compare', last('power_status_orig', ignorenulls=True).over(bus_logic_window.rowsBetween(Window.unboundedPreceding, 0))) \\\n  .withColumn('lag_max_event', last('max_event', ignorenulls=True).over(bus_logic_window.rowsBetween(-2, 0))) \\\n  .withColumn(\"power_status_orig_dk\",                 \n      when((col(\"power_status_orig_compare\") == \"Yes\") & (col(\"job_status_orig\") ==\"Job Open\") & (col(\"job_status_over\")==\"Job Closed\"), \"Don't Know\")\n     .when((col(\"lag_max_event\") == \"call\") & (col(\"job_status_orig\") ==\"Job Open\") & (col(\"job_status_over\")==\"Job Closed\"), \"No\")\n     .otherwise(col(\"power_status_orig\"))) \\\n  .withColumn('final_power_status', last('power_status_orig_dk', ignorenulls=True).over(bus_logic_window)) \\\n  .drop(col(\"lag_max_event\"))","commandVersion":270,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"full_business_no_95_rule","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"job_start","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig","nullable":true,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"event_name","nullable":true,"type":"string"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CALLTYPE","nullable":true,"type":"string"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_occurence","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"job_status_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_over","nullable":true,"type":"null"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig_compare","nullable":true,"type":"string"},{"metadata":{},"name":"power_status_orig_dk","nullable":true,"type":"string"},{"metadata":{},"name":"final_power_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328391982,"submitTime":1646328321898,"finishTime":1646328393108,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4691","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"706ae0ed-6d3f-4956-8222-214b8fd59abc"},{"version":"CommandV1","origId":2937788264273130,"guid":"7a3d3274-02e0-4646-bcb6-60660f82ff3a","subtype":"command","commandType":"auto","position":32.734405517578125,"command":"%md\n# D)  95% rule\n\n- If status is No and 95%+ of meters impacted by the outage job are Yes and no event happens, the meter power status becomes Don’t Know\n\n- If status is Don’t Know and <95% of meters impacted by the outage job are Yes and no event happens, the meter power status becomes No\n\n\n##### Calculate the power status at job close, then mark the locations where power status changes and fill","commandVersion":34,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"efaf9fa2-91c7-4446-9067-0a98551951af"},{"version":"CommandV1","origId":2937788264273131,"guid":"7cb03377-24bb-448a-a7f1-76c4e3602bb1","subtype":"command","commandType":"auto","position":32.73442077636719,"command":"job_interval_percentage = full_business_no_95_rule \\\n  .filter((col(\"job_status_orig\") == \"Job Closed\") & (col(\"job_status_over\") == \"Job Open\")) \\\n  .select(col(\"meter_number\"), col(\"event_number\"), col(\"final_power_status\"), col(\"job_status_orig\")) \\\n  .withColumn(\"power_yes_status\", when(col(\"final_power_status\") == \"Yes\", 1).otherwise(0)) \\\n  .groupBy(col(\"event_number\")) \\\n  .agg(count(col(\"meter_number\")).alias(\"meters_in_job\"), sum(col(\"power_yes_status\")).alias(\"power_yes_status\")) \\\n  .withColumn(\"percent_yes_meters\", col(\"power_yes_status\") / col(\"meters_in_job\"))\n\nfull_business_95 = full_business_no_95_rule \\\n  .join(job_interval_percentage, on=\"event_number\", how = \"left\") \\\n  .withColumn(\"power_status_orig_95\", when((col(\"job_status_orig\") == \"Job Closed\") & (col(\"job_status_over\") == \"Job Open\") & (col(\"max_event\").isNull()),\n                                       when((col(\"final_power_status\") == \"Don't Know\") & (col(\"percent_yes_meters\") < 0.95), \"No\") \\\n                                       .when((col(\"final_power_status\") == \"No\") & (col(\"percent_yes_meters\") >= 0.95), \"Yes\")) \\\n                                      .otherwise(col(\"power_status_orig_dk\"))) \\\n  .withColumn('final_power_status_95', last('power_status_orig_95', ignorenulls=True).over(bus_logic_window)) \\\n  .drop(\"job_meter_number\", \"job_start\", \"power_status_orig\", \"CALLTYPE\", \"event_name\", \"time_occurence\", \"job_status_over\",\n        \"power_status_over\", \"power_status_orig_compare\", \"final_power_status\", \"power_status_orig_dk\", \"meters_in_job\", \"power_status_orig_95\", \"power_yes_status\")\n","commandVersion":664,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_interval_percentage","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"meters_in_job","nullable":false,"type":"long"},{"metadata":{},"name":"power_yes_status","nullable":true,"type":"long"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"full_business_95","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328393114,"submitTime":1646328321979,"finishTime":1646328569750,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"5498","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"87db1479-2b30-4384-a6e8-e0ae62401b4e"},{"version":"CommandV1","origId":2937788264273132,"guid":"0961a8fb-3118-42c8-9b7f-9043712dee9d","subtype":"command","commandType":"auto","position":34.23442077636719,"command":"%md\n# * Run single profiles","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ddd0fe3e-d01d-4d19-9851-c81fe2fd5645"},{"version":"CommandV1","origId":2937788264273133,"guid":"2d50d710-8b69-456b-9178-8114a7c1a0b3","subtype":"command","commandType":"auto","position":34.48442077636719,"command":"#singles = full_business_95.sort(\"interval_tm_start\", ascending=True)\n#list_of_meters = [\"4894042\"]\n#display(singles.filter(col(\"meter_number\").isin(list_of_meters)))\n#singles \\\n#  .coalesce(1) \\\n#  .write.option(\"header\", True) \\\n#  .option(\"sep\", \",\") \\\n#  .mode(\"overwrite\") \\\n#  .csv(f\"{path}{name}_individuals\")\n#display(singles)","commandVersion":44,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328569755,"submitTime":1646328322036,"finishTime":1646328569783,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c7abb8ad-3527-4a25-97d0-30b75f2eaa19"},{"version":"CommandV1","origId":2937788264273134,"guid":"9bf7d707-19c0-4393-8ceb-5f2ce780bb23","subtype":"command","commandType":"auto","position":34.73442077636719,"command":"%md\n# E) Group up to summary level","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d56f5b9b-da98-40d7-8fa2-881a55450660"},{"version":"CommandV1","origId":2937788264273135,"guid":"83511814-1c3d-4dfc-a08c-0c9eef220489","subtype":"command","commandType":"auto","position":35.73442077636719,"command":"%md\n#### Job setup\n1. Get min outage job start per meter\n2. min job start - interval (this rebases the interval for reporting)\n3. Filter out >= 0 on step 2 to focus only on our intervals","commandVersion":78,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"510f5c8e-502f-4947-9b23-72115c76c2d1"},{"version":"CommandV1","origId":2937788264273136,"guid":"5c6e913f-d271-48b2-88a2-889131c3e040","subtype":"command","commandType":"auto","position":36.73442077636719,"command":"window = Window.partitionBy(col(\"meter_number\"))\n\n\njob_timeline = full_business_95 \\\n  .withColumn(\"min_job_out_tm\", min(col(\"out_dt_tm\")).over(window)) \\\n  .withColumn(\"interval_from_job_end\", unix_timestamp(col(\"interval_tm_stop\")) - unix_timestamp(col(\"min_job_out_tm\"))) \\\n  .filter(col(\"interval_from_job_end\") >= 0)\n\n","commandVersion":250,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_timeline","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"min_job_out_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_from_job_end","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328569789,"submitTime":1646328322149,"finishTime":1646328571017,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3898","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"45e1c633-ccf3-46aa-9a70-9cedd482a63d"},{"version":"CommandV1","origId":2937788264273137,"guid":"590ed4e7-97d5-4139-97df-40a0106be959","subtype":"command","commandType":"auto","position":36.98442077636719,"command":"%md\n#### Carry job event forward and recenter the intervals for each job\nFilter out the negative numbers and null event_index","commandVersion":102,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"af06874d-7520-4227-9597-456ba3df159c"},{"version":"CommandV1","origId":2937788264273138,"guid":"7da758b5-dfdc-4430-a436-49dc86320a0b","subtype":"command","commandType":"auto","position":37.56547546386719,"command":"meter_window = Window.partitionBy(col(\"meter_number\")).orderBy(col(\"time_step\").asc())\n\nfinal_with_fill = job_timeline \\\n  .withColumn(\"event_index_fill\", last('event_number', ignorenulls=True).over(meter_window.rowsBetween(Window.unboundedPreceding, 0))) \\\n  .withColumn(\"job_on_dt_tm_fill\", last('on_dt_tm', ignorenulls=True).over(meter_window.rowsBetween(Window.unboundedPreceding, 0))) \\\n  .withColumn(\"time_from_end_each_job\", unix_timestamp(col(\"interval_tm_stop\")) - unix_timestamp(col(\"job_on_dt_tm_fill\"))) \\\n  .filter(col(\"event_index_fill\").isNotNull()) \\\n  .filter(col(\"time_from_end_each_job\") >= 0)","commandVersion":118,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"final_with_fill","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"min_job_out_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_from_job_end","nullable":true,"type":"long"},{"metadata":{},"name":"event_index_fill","nullable":true,"type":"string"},{"metadata":{},"name":"job_on_dt_tm_fill","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_from_end_each_job","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328571022,"submitTime":1646328322242,"finishTime":1646328573053,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"59c25351-0fed-4847-a791-bff03b999903"},{"version":"CommandV1","origId":2937788264273139,"guid":"b56abcfc-3b65-4bb8-96c4-905700758c54","subtype":"command","commandType":"auto","position":38.35356140136719,"command":"\n%md\n#### Join intervals and group up\n1. Join interval\n2. Take max status per interval\n3. Group up by interval and status\n4. Count status\n5. Add percentages","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0996aeaf-3c4b-44b8-a2ba-0965d4fd9be4"},{"version":"CommandV1","origId":2937788264273140,"guid":"44d395e3-a115-4c0b-8931-c2409be760e0","subtype":"command","commandType":"auto","position":38.48442077636719,"command":"cond = (col(\"time_from_end_each_job\") >= col(\"job_time_step\")) & \\\n      (col(\"time_from_end_each_job\") < col(\"job_end_time_step\"))\n\n#cond =  (col(\"interval_from_job_end\") > col(\"job_time_step\"))","commandVersion":14,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328573058,"submitTime":1646328322340,"finishTime":1646328573095,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"428ea289-1e70-4eb5-8a52-3c3d9598ca6b"},{"version":"CommandV1","origId":2937788264273141,"guid":"eb943730-bbeb-4652-afcf-5a0ac1108c15","subtype":"command","commandType":"auto","position":38.60942077636719,"command":"job_interval_window = Window.partitionBy(col(\"meter_number\"), col(\"row_reset\")).orderBy(col(\"interval_from_job_end\").desc())\njob_interval_window = Window.partitionBy(col(\"meter_number\"), col(\"event_index_fill\"), col(\"job_time_step\")).orderBy(col(\"time_step\").desc())","commandVersion":35,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328573099,"submitTime":1646328322363,"finishTime":1646328573178,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6c59343-6038-4ff1-9cff-081215b16d9d"},{"version":"CommandV1","origId":2937788264273142,"guid":"2f033a25-38af-4649-ab7a-5a694792ba39","subtype":"command","commandType":"auto","position":38.65629577636719,"command":"job_interval_attached = final_with_fill \\\n  .join(job_interval_data, on=cond, how=\"left_outer\")","commandVersion":7,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"job_interval_attached","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_number","nullable":true,"type":"string"},{"metadata":{},"name":"premise","nullable":true,"type":"long"},{"metadata":{},"name":"meter_number","nullable":true,"type":"string"},{"metadata":{},"name":"end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"interval","nullable":true,"type":"string"},{"metadata":{},"name":"interval_tm_start","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_tm_stop","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_step","nullable":true,"type":"double"},{"metadata":{},"name":"tycod","nullable":true,"type":"string"},{"metadata":{},"name":"out_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"on_dt_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"job_status_orig","nullable":false,"type":"string"},{"metadata":{},"name":"full_read_value","nullable":true,"type":"decimal(25,6)"},{"metadata":{},"name":"eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"nmnl_volt_pct","nullable":true,"type":"decimal(36,17)"},{"metadata":{},"name":"ppu_eda_creation_date_localtime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"CDTS_datetime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"max_event","nullable":true,"type":"string"},{"metadata":{},"name":"event_over","nullable":true,"type":"string"},{"metadata":{},"name":"percent_yes_meters","nullable":true,"type":"double"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"min_job_out_tm","nullable":true,"type":"timestamp"},{"metadata":{},"name":"interval_from_job_end","nullable":true,"type":"long"},{"metadata":{},"name":"event_index_fill","nullable":true,"type":"string"},{"metadata":{},"name":"job_on_dt_tm_fill","nullable":true,"type":"timestamp"},{"metadata":{},"name":"time_from_end_each_job","nullable":true,"type":"long"},{"metadata":{},"name":"job_end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328573183,"submitTime":1646328322388,"finishTime":1646328573571,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4281dc90-4168-4af4-adbf-521ce940cbb6"},{"version":"CommandV1","origId":2937788264273143,"guid":"a98d53f5-3efc-4fe1-b5e5-08fda7eab575","subtype":"command","commandType":"auto","position":38.67973327636719,"command":"%md\n#### Get summary statistics across all jobs","commandVersion":11,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1515f036-b02f-4e3b-b833-64ac0c5aaf97"},{"version":"CommandV1","origId":2937788264273144,"guid":"facf75ff-390c-4258-9369-5442f5ca45fc","subtype":"command","commandType":"auto","position":38.69145202636719,"command":"summary_by_job_interval_inservice_job = job_interval_attached \\\n  .withColumn(\"job_interval_row\", row_number().over(job_interval_window)) \\\n  .filter(col(\"job_interval_row\") == 1) \\\n  .groupBy(col(\"event_index_fill\"), col(\"job_interval\"), col(\"job_time_step\"), col(\"job_end_time_step\"), col(\"final_power_status_95\")).agg(count(col(\"final_power_status_95\")).alias(\"counts\"))","commandVersion":24,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_by_job_interval_inservice_job","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_index_fill","nullable":true,"type":"string"},{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"job_end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328573576,"submitTime":1646328322443,"finishTime":1646328575000,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b1315048-b0f2-4f59-8eb3-5ad8b2ee75c3"},{"version":"CommandV1","origId":2937788264273145,"guid":"f0d71cb5-7420-40a5-992c-f95e9ac29271","subtype":"command","commandType":"auto","position":38.69438171386719,"command":"summary_total_by_job_interval_inservice_job = summary_by_job_interval_inservice_job \\\n  .groupBy(col(\"event_index_fill\"), col(\"job_interval\")) \\\n  .agg(sum(col(\"counts\")).alias(\"total_counts\"))","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_total_by_job_interval_inservice_job","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"event_index_fill","nullable":true,"type":"string"},{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328575005,"submitTime":1646328322504,"finishTime":1646328575428,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4bfdda36-5a66-42ed-a6ae-fa959a226127"},{"version":"CommandV1","origId":2937788264273146,"guid":"58d1cd17-e92f-4e56-b4d7-f43c2915ed48","subtype":"command","commandType":"auto","position":38.69584655761719,"command":"summary_df_job = summary_by_job_interval_inservice_job \\\n  .join(summary_total_by_job_interval_inservice_job, on=[\"job_interval\", \"event_index_fill\"] , how=\"inner\") \\\n  .withColumn(\"percentage_total\", col(\"counts\") / col(\"total_counts\")) \\\n  .withColumnRenamed(\"final_power_status_95\", \"final_power_status\") \\\n  .filter(col(\"final_power_status\").isNotNull())","commandVersion":12,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_df_job","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"event_index_fill","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"job_end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"},{"metadata":{},"name":"percentage_total","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328575432,"submitTime":1646328322528,"finishTime":1646328579369,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fcadf7ce-62f4-4910-b752-de6f9f7a96a2"},{"version":"CommandV1","origId":2937788264273147,"guid":"fbef315d-99d3-4c72-8d98-483347d44b0c","subtype":"command","commandType":"auto","position":38.69621276855469,"command":"event_job_window = Window.partitionBy(col(\"event_index_fill\")).orderBy(col(\"job_time_step\").asc())\n\nnum_events = summary_df_job.select(\"event_index_fill\").distinct().count()\n\nfiltered_interval_job = summary_df_job \\\n  .filter((col(\"percentage_total\") >= 0.95) & (col(\"final_power_status_95\") == \"Yes\")) \\\n  .withColumn(\"row_num\", row_number().over(event_job_window)) \\\n  .filter(col(\"row_num\") == 1) \\\n  .withColumn(\"mid_point_time_step\", ((col(\"job_time_step\") + col(\"job_end_time_step\")) / 2) / 3600) \\\n  .withColumn(\"num_events\", lit(num_events)) \\\n  .orderBy(col(\"mid_point_time_step\").asc()) \\\n  .withColumn(\"median_percent\", monotonically_increasing_id() / col(\"num_events\"))\n\nmedian_df = filtered_interval_job \\\n  .filter(col(\"median_percent\") >= 0.5) \\\n  .orderBy(col(\"median_percent\").asc()) \\\n  .first()\n\nsummary_stat_df = filtered_interval_job \\\n  .agg(mean(col(\"mid_point_time_step\")).alias(\"average_time_to_95\"),\n       min(col(\"mid_point_time_step\")).alias(\"min_time_to_95\"),\n       max(col(\"mid_point_time_step\")).alias(\"max_time_to_95\")) \\\n  .withColumn(\"median_time_to_95\", lit(median_df.mid_point_time_step))\n\ndisplay(summary_stat_df)","commandVersion":337,"state":"finished","results":{"type":"table","data":[[4.184786721068244,0.016666666666666666,186.88875,1.0166666666666666]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"average_time_to_95","type":"\"double\"","metadata":"{}"},{"name":"min_time_to_95","type":"\"double\"","metadata":"{}"},{"name":"max_time_to_95","type":"\"double\"","metadata":"{}"},{"name":"median_time_to_95","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"filtered_interval_job","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"event_index_fill","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"job_end_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"},{"metadata":{},"name":"percentage_total","nullable":true,"type":"double"},{"metadata":{},"name":"row_num","nullable":true,"type":"integer"},{"metadata":{},"name":"mid_point_time_step","nullable":true,"type":"double"},{"metadata":{},"name":"num_events","nullable":false,"type":"integer"},{"metadata":{},"name":"median_percent","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null},{"name":"summary_stat_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"average_time_to_95","nullable":true,"type":"double"},{"metadata":{},"name":"min_time_to_95","nullable":true,"type":"double"},{"metadata":{},"name":"max_time_to_95","nullable":true,"type":"double"},{"metadata":{},"name":"median_time_to_95","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646328579375,"submitTime":1646328322598,"finishTime":1646333356768,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1696","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"73c3feca-07ab-4213-8420-ed987816eeed"},{"version":"CommandV1","origId":2937788264273148,"guid":"87542c39-120f-4977-8791-a2e349957425","subtype":"command","commandType":"auto","position":38.69731140136719,"command":"%md\n#### Get the summary of total timeline","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cb78a6fd-6c21-440b-8ad9-90ba287ea434"},{"version":"CommandV1","origId":2937788264273149,"guid":"375c8dd5-069a-4ff1-9be6-3c57740b85c7","subtype":"command","commandType":"auto","position":38.70317077636719,"command":"summary_by_job_interval = job_interval_attached \\\n  .withColumn(\"job_interval_row\", row_number().over(job_interval_window)) \\\n  .filter(col(\"job_interval_row\") == 1) \\\n  .groupBy(col(\"job_interval\"), col(\"job_time_step\"), col(\"final_power_status_95\")).agg(count(col(\"final_power_status_95\")).alias(\"counts\"))","commandVersion":49,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_by_job_interval","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status_95","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646333356779,"submitTime":1646328322694,"finishTime":1646333358119,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"174aab89-19d1-474b-b513-77684673183f"},{"version":"CommandV1","origId":2937788264273150,"guid":"600ac356-bb49-40a8-b0a6-6ce87c5665f2","subtype":"command","commandType":"auto","position":38.71879577636719,"command":"summary_total_by_job_interval = summary_by_job_interval \\\n  .groupBy(col(\"job_interval\")) \\\n  .agg(sum(col(\"counts\")).alias(\"total_counts\"))","commandVersion":14,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_total_by_job_interval","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646333358129,"submitTime":1646328322718,"finishTime":1646333358531,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0c7bd4fd-2694-491f-b9a0-437eb314ab70"},{"version":"CommandV1","origId":2937788264273151,"guid":"c2806ddb-4c74-48c6-aea1-18d82e44add6","subtype":"command","commandType":"auto","position":38.73442077636719,"command":"summary_df = summary_by_job_interval \\\n  .join(summary_total_by_job_interval, on=[\"job_interval\"] , how=\"inner\") \\\n  .withColumn(\"percentage_total\", col(\"counts\") / col(\"total_counts\")) \\\n  .withColumnRenamed(\"final_power_status_95\", \"final_power_status\") \\\n  .filter(col(\"final_power_status\").isNotNull())","commandVersion":446,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"summary_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"job_interval","nullable":true,"type":"string"},{"metadata":{},"name":"job_time_step","nullable":true,"type":"long"},{"metadata":{},"name":"final_power_status","nullable":true,"type":"string"},{"metadata":{},"name":"counts","nullable":false,"type":"long"},{"metadata":{},"name":"total_counts","nullable":true,"type":"long"},{"metadata":{},"name":"percentage_total","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646333358535,"submitTime":1646328322781,"finishTime":1646333362383,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4261","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1493842a-68b6-489c-9d82-8d48988ba8f6"},{"version":"CommandV1","origId":2937788264273152,"guid":"18de05a2-e226-4dbb-9331-8b2365d9e2ea","subtype":"command","commandType":"auto","position":39.73442077636719,"command":"%md\n# F) Write to folder location","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6b3ebcf9-27be-473c-9bcc-8c8eb659657f"},{"version":"CommandV1","origId":2937788264273153,"guid":"f57bf258-a8bb-4fa6-b769-077c5daf8cf5","subtype":"command","commandType":"auto","position":40.23442077636719,"command":"display(summary_df)","commandVersion":1,"state":"finished","results":{"type":"table","data":[["2 min-2 hour",120,"Don't Know",141,130379,0.0010814625054648371],["2 min-2 hour",120,"No",64754,130379,0.4966597381480146],["2 min-2 hour",120,"Yes",65484,130379,0.5022587993465205],["62 hour-64 hour",223200,"Don't Know",2,118497,1.6878064423571905E-5],["62 hour-64 hour",223200,"Yes",118259,118497,0.9979915103335949],["62 hour-64 hour",223200,"No",236,118497,0.001991611601981485],["22 hour-24 hour",79200,"Don't Know",6,118926,5.045154129458655E-5],["22 hour-24 hour",79200,"No",827,118926,0.00695390410843718],["22 hour-24 hour",79200,"Yes",118093,118926,0.9929956443502682],["84 hour-86 hour",302400,"Don't Know",2,114277,1.7501334476753854E-5],["84 hour-86 hour",302400,"Yes",114069,114277,0.9981798612144176],["84 hour-86 hour",302400,"No",206,114277,0.0018026374511056467],["76 hour-78 hour",273600,"Don't Know",2,115910,1.725476662928134E-5],["76 hour-78 hour",273600,"No",148,115910,0.001276852730566819],["76 hour-78 hour",273600,"Yes",115760,115910,0.998705892502804],["10 hour-12 hour",36000,"Yes",116074,119664,0.9699993314614254],["10 hour-12 hour",36000,"Don't Know",13,119664,1.0863751838481081E-4],["10 hour-12 hour",36000,"No",3577,119664,0.029892031020189867],["44 hour-46 hour",158400,"Don't Know",2,118471,1.6881768534071628E-5],["44 hour-46 hour",158400,"Yes",118155,118471,0.9973326805716167],["44 hour-46 hour",158400,"No",314,118471,0.002650437659849246],["60 hour-62 hour",216000,"Don't Know",2,118495,1.687834929743871E-5],["60 hour-62 hour",216000,"Yes",118248,118495,0.9979155238617663],["60 hour-62 hour",216000,"No",245,118495,0.002067597788936242],["96 hours+",345600,"Don't Know",1,110426,9.055838298951334E-6],["96 hours+",345600,"No",795,110426,0.007199391447666311],["96 hours+",345600,"Yes",109630,110426,0.9927915527140347],["24 hour-26 hour",86400,"Don't Know",6,118520,5.062436719541006E-5],["24 hour-26 hour",86400,"Yes",117847,118520,0.9943216334795815],["24 hour-26 hour",86400,"No",667,118520,0.005627742153223085],["80 hour-82 hour",288000,"Don't Know",2,114553,1.7459167372308016E-5],["80 hour-82 hour",288000,"Yes",114421,114553,0.9988476949534276],["80 hour-82 hour",288000,"No",130,114553,0.001134845879200021],["56 hour-58 hour",201600,"No",295,118486,0.0024897456239555728],["56 hour-58 hour",201600,"Yes",118189,118486,0.9974933747446956],["56 hour-58 hour",201600,"Don't Know",2,118486,1.687963134885134E-5],["2 hour-4 hour",7200,"No",40725,120918,0.33679849153972113],["2 hour-4 hour",7200,"Don't Know",66,120918,5.458244430109661E-4],["2 hour-4 hour",7200,"Yes",80127,120918,0.6626556840172679],["74 hour-76 hour",266400,"Don't Know",2,117407,1.7034759426609997E-5],["74 hour-76 hour",266400,"Yes",117236,117407,0.9985435280690248],["74 hour-76 hour",266400,"No",169,117407,0.001439437171548545],["0-2 min",0,"Yes",10437,20579,0.5071675008503814],["0-2 min",0,"Don't Know",29,20579,0.001409203557024151],["0-2 min",0,"No",10113,20579,0.4914232955925944],["14 hour-16 hour",50400,"Don't Know",9,119545,7.528545735915346E-5],["14 hour-16 hour",50400,"Yes",117383,119545,0.9819147601321678],["14 hour-16 hour",50400,"No",2153,119545,0.018009954410473043],["82 hour-84 hour",295200,"Don't Know",2,114285,1.7500109375683598E-5],["82 hour-84 hour",295200,"Yes",113988,114285,0.997401233757711],["82 hour-84 hour",295200,"No",295,114285,0.0025812661329133305],["12 hour-14 hour",43200,"Don't Know",11,119488,9.205945366898768E-5],["12 hour-14 hour",43200,"No",2628,119488,0.02199384038564542],["12 hour-14 hour",43200,"Yes",116849,119488,0.9779141001606856],["54 hour-56 hour",194400,"Don't Know",2,118486,1.687963134885134E-5],["54 hour-56 hour",194400,"No",283,118486,0.0023884678358624648],["54 hour-56 hour",194400,"Yes",118201,118486,0.9975946525327887],["30 hour-32 hour",108000,"Don't Know",5,118507,4.219160049617322E-5],["30 hour-32 hour",108000,"No",545,118507,0.004598884454082881],["30 hour-32 hour",108000,"Yes",117957,118507,0.9953589239454209],["38 hour-40 hour",136800,"Don't Know",2,118525,1.6874077198903186E-5],["38 hour-40 hour",136800,"Yes",118170,118525,0.9970048512971947],["38 hour-40 hour",136800,"No",353,118525,0.002978274625606412],["58 hour-60 hour",208800,"Don't Know",2,118494,1.6878491737978295E-5],["58 hour-60 hour",208800,"Yes",118216,118494,0.997653889648421],["58 hour-60 hour",208800,"No",276,118494,0.0023292318598410046],["26 hour-28 hour",93600,"No",604,118499,0.005097089426914995],["26 hour-28 hour",93600,"Don't Know",6,118499,5.063333867796353E-5],["26 hour-28 hour",93600,"Yes",117889,118499,0.9948522772344071],["8 hour-10 hour",28800,"Don't Know",20,119859,1.6686273037485713E-4],["8 hour-10 hour",28800,"No",6453,119859,0.05383825995544765],["8 hour-10 hour",28800,"Yes",113386,119859,0.9459948773141775],["94 hour-96 hour",338400,"Don't Know",2,112047,1.7849652378019937E-5],["94 hour-96 hour",338400,"No",259,112047,0.002311529982953582],["94 hour-96 hour",338400,"Yes",111786,112047,0.9976706203646684],["16 hour-18 hour",57600,"Don't Know",9,119492,7.531884979747599E-5],["16 hour-18 hour",57600,"No",1692,119492,0.014159943761925484],["16 hour-18 hour",57600,"Yes",117791,119492,0.9857647373882771],["66 hour-68 hour",237600,"Don't Know",2,118500,1.6877637130801688E-5],["66 hour-68 hour",237600,"Yes",118265,118500,0.9980168776371308],["66 hour-68 hour",237600,"No",233,118500,0.0019662447257383967],["42 hour-44 hour",151200,"Don't Know",2,118525,1.6874077198903186E-5],["42 hour-44 hour",151200,"Yes",118200,118525,0.9972579624551783],["42 hour-44 hour",151200,"No",323,118525,0.0027251634676228645],["28 hour-30 hour",100800,"Don't Know",6,118497,5.063419327071571E-5],["28 hour-30 hour",100800,"No",571,118497,0.0048186873929297784],["28 hour-30 hour",100800,"Yes",117920,118497,0.9951306784137995],["34 hour-36 hour",122400,"Don't Know",5,118522,4.2186260778589626E-5],["34 hour-36 hour",122400,"Yes",118040,118522,0.995933244460944],["34 hour-36 hour",122400,"No",477,118522,0.004024569278277451],["92 hour-94 hour",331200,"No",193,113605,0.0016988688878130365],["92 hour-94 hour",331200,"Don't Know",2,113605,1.7604858941067736E-5],["92 hour-94 hour",331200,"Yes",113410,113605,0.9982835262532459],["72 hour-74 hour",259200,"Don't Know",2,118504,1.6877067440761493E-5],["72 hour-74 hour",259200,"Yes",118263,118504,0.9979663133733883],["72 hour-74 hour",259200,"No",239,118504,0.0020168095591709986],["20 hour-22 hour",72000,"Don't Know",6,119222,5.032628206203553E-5],["20 hour-22 hour",72000,"No",988,119222,0.008287061112881852],["20 hour-22 hour",72000,"Yes",118228,119222,0.9916626126050561],["48 hour-50 hour",172800,"Don't Know",2,118476,1.6881056078868294E-5],["48 hour-50 hour",172800,"No",299,118476,0.00252371788379081],["48 hour-50 hour",172800,"Yes",118175,118476,0.9974594010601303],["70 hour-72 hour",252000,"Don't Know",2,118503,1.6877209859666E-5],["70 hour-72 hour",252000,"Yes",118247,118503,0.9978397171379627],["70 hour-72 hour",252000,"No",254,118503,0.002143405652177582],["4 hour-6 hour",14400,"Yes",92930,120527,0.7710305574684511],["4 hour-6 hour",14400,"Don't Know",32,120527,2.655006761970347E-4],["4 hour-6 hour",14400,"No",27565,120527,0.22870394185535192],["52 hour-54 hour",187200,"Don't Know",2,118485,1.6879773811030933E-5],["52 hour-54 hour",187200,"No",284,118485,0.0023969278811663925],["52 hour-54 hour",187200,"Yes",118199,118485,0.9975861923450225],["40 hour-42 hour",144000,"Don't Know",2,118525,1.6874077198903186E-5],["40 hour-42 hour",144000,"No",337,118525,0.0028432820080151865],["40 hour-42 hour",144000,"Yes",118186,118525,0.9971398439147859],["36 hour-38 hour",129600,"Don't Know",3,118524,2.5311329351017516E-5],["36 hour-38 hour",129600,"Yes",118107,118524,0.9964817252202086],["36 hour-38 hour",129600,"No",414,118524,0.003492963450440417],["6 hour-8 hour",21600,"Don't Know",23,120169,1.9139711572868211E-4],["6 hour-8 hour",21600,"No",15018,120169,0.12497399495710208],["6 hour-8 hour",21600,"Yes",105128,120169,0.8748346079271693],["90 hour-92 hour",324000,"Don't Know",2,113801,1.757453800933208E-5],["90 hour-92 hour",324000,"Yes",113662,113801,0.9987785696083514],["90 hour-92 hour",324000,"No",137,113801,0.0012038558536392474],["46 hour-48 hour",165600,"Don't Know",2,118473,1.6881483544773913E-5],["46 hour-48 hour",165600,"Yes",118163,118473,0.99738337005056],["46 hour-48 hour",165600,"No",308,118473,0.002599748465895183],["78 hour-80 hour",280800,"Don't Know",2,115178,1.7364427234367674E-5],["78 hour-80 hour",280800,"No",221,115178,0.001918769209397628],["78 hour-80 hour",280800,"Yes",114955,115178,0.998063866363368],["86 hour-88 hour",309600,"Don't Know",2,114222,1.750976169214337E-5],["86 hour-88 hour",309600,"No",125,114222,0.0010943601057589606],["86 hour-88 hour",309600,"Yes",114095,114222,0.9988881301325488],["18 hour-20 hour",64800,"Don't Know",7,119493,5.8580837371226766E-5],["18 hour-20 hour",64800,"No",1295,119493,0.010837454913676952],["18 hour-20 hour",64800,"Yes",118191,119493,0.9891039642489519],["88 hour-90 hour",316800,"Don't Know",2,114113,1.7526486903332663E-5],["88 hour-90 hour",316800,"No",257,114113,0.002252153567078247],["88 hour-90 hour",316800,"Yes",113854,114113,0.9977303199460185],["68 hour-70 hour",244800,"Don't Know",2,118500,1.6877637130801688E-5],["68 hour-70 hour",244800,"No",295,118500,0.002489451476793249],["68 hour-70 hour",244800,"Yes",118203,118500,0.997493670886076],["32 hour-34 hour",115200,"Don't Know",5,118514,4.2189108459760025E-5],["32 hour-34 hour",115200,"Yes",117972,118514,0.995426700642962],["32 hour-34 hour",115200,"No",537,118514,0.004531110248578227],["50 hour-52 hour",180000,"No",286,118482,0.0024138687733157777],["50 hour-52 hour",180000,"Yes",118194,118482,0.9975692510254722],["50 hour-52 hour",180000,"Don't Know",2,118482,1.6880201211998446E-5],["64 hour-66 hour",230400,"Don't Know",2,118500,1.6877637130801688E-5],["64 hour-66 hour",230400,"Yes",118263,118500,0.998],["64 hour-66 hour",230400,"No",235,118500,0.001983122362869198]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"job_interval","type":"\"string\"","metadata":"{}"},{"name":"job_time_step","type":"\"long\"","metadata":"{}"},{"name":"final_power_status","type":"\"string\"","metadata":"{}"},{"name":"counts","type":"\"long\"","metadata":"{}"},{"name":"total_counts","type":"\"long\"","metadata":"{}"},{"name":"percentage_total","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646333362388,"submitTime":1646328322860,"finishTime":1646333416210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"998","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",150]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d6659f86-6461-4516-aa52-7979d8555a0f"},{"version":"CommandV1","origId":2937788264273154,"guid":"48d657e9-119b-41f2-8163-8acfb0514e52","subtype":"command","commandType":"auto","position":40.73442077636719,"command":"summary_df \\\n .coalesce(1) \\\n .write.option(\"header\", True) \\\n .option(\"sep\", \",\") \\\n .mode(\"overwrite\") \\\n .csv(f\"{path}{name}\")","commandVersion":85,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646333416229,"submitTime":1646328322887,"finishTime":1646333472514,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"873","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e5e2cb4c-ae16-4156-99b9-323a62d891a0"},{"version":"CommandV1","origId":2937788264273155,"guid":"6b7218e5-2097-4e81-a830-b13d4b6dbaff","subtype":"command","commandType":"auto","position":41.73442077636719,"command":"summary_stat_df \\\n .coalesce(1) \\\n .write.option(\"header\", True) \\\n .option(\"sep\", \",\") \\\n .mode(\"overwrite\") \\\n .csv(f\"{path}{name}-summary-stats\")\n","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1646333472519,"submitTime":1646328322911,"finishTime":1646333538442,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2a373622-7c8a-4c46-96d6-d82ae244a169"}],"dashboards":[],"guid":"34b71691-1951-4317-a7d3-8a6d1672f3b7","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"stop_date":{"nuid":"173bd2aa-dccb-4abd-ae4d-55fcb020eb3c","currentValue":"2021-06-23 16:49:00","widgetInfo":{"widgetType":"text","name":"stop_date","defaultValue":"","label":"Stop Date","options":{"widgetType":"text","validationRegex":null}}},"start_date":{"nuid":"fb31e412-3ef1-4560-9db6-790a1e11f956","currentValue":"2021-06-20 22:00:00","widgetInfo":{"widgetType":"text","name":"start_date","defaultValue":"","label":"Start Date","options":{"widgetType":"text","validationRegex":null}}},"name":{"nuid":"c4280165-0dac-414d-8e3e-cfe338fa4912","currentValue":"cat-job-close","widgetInfo":{"widgetType":"text","name":"name","defaultValue":"","label":"File Name","options":{"widgetType":"text","validationRegex":null}}},"path":{"nuid":"759f70c1-0793-4c9d-b7fc-fa9a24760a1c","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/Dummy_test/pps_outage/","widgetInfo":{"widgetType":"text","name":"path","defaultValue":"","label":"Folder Path","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}