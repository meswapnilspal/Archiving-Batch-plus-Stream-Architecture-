{"version":"NotebookV1","origId":2937788264272998,"name":"OLD Dynamic Table Creation Using MetaTable","language":"python","commands":[{"version":"CommandV1","origId":2937788264272999,"guid":"54a6e552-7b9e-4214-85ad-e487e4017afb","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.functions import *","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915122,"submitTime":1653470914882,"finishTime":1653470915151,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0686f104-9025-4c31-9496-9b8cc667be61"},{"version":"CommandV1","origId":2937788264273000,"guid":"6ad5756b-b3b4-4ba6-a220-38616a08bd8e","subtype":"command","commandType":"auto","position":2.25,"command":"dbutils.widgets.text(\"table_name\", \"\", \"table name\")\ntable_name = dbutils.widgets.get(\"table_name\")\n\ndbutils.widgets.text(\"db_name\", \"\", \"db name\")\ndb_name = dbutils.widgets.get(\"db_name\")\n\ndbutils.widgets.text(\"curated_location\", \"\", \"curated location\")\ncurated_location = \"'\" + dbutils.widgets.get(\"curated_location\") + \"/\" + table_name + \"/'\"\n\n# Curated location for Error Table\ndbutils.widgets.text(\"curated_location_err\", \"\", \"curated location for error table\")\ncurated_location_err = \"'\" + dbutils.widgets.get(\"curated_location_err\") + \"/\" + table_name + \"/'\"","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f7c1e984-6215-4d9d-a0a1-04b2c260d1e4"},{"version":"CommandV1","origId":2937788264273001,"guid":"96f72767-33ac-4b68-8672-597f86356ee3","subtype":"command","commandType":"auto","position":3.0,"command":"%run \"./Load_Metadata\"","commandVersion":5,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470914909,"submitTime":1653470914909,"finishTime":1653470915682,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ec4cd5bb-f9ef-42a6-9b7d-a16897866e13"},{"version":"CommandV1","origId":2937788264273002,"guid":"a6fa8c5b-b665-4d1c-bed4-23db4b768725","subtype":"script","commandType":"auto","position":3.25,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915192,"submitTime":0,"finishTime":1653470915206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f72767-33ac-4b68-8672-597f86356ee3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c72dfa99-5a5d-4e02-9824-1b5323724f9e"},{"version":"CommandV1","origId":2937788264273003,"guid":"8ef8d315-132e-48ef-ab6f-922b6abf73fa","subtype":"script","commandType":"auto","position":3.5,"command":"","commandVersion":36,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915209,"submitTime":0,"finishTime":1653470915228,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f72767-33ac-4b68-8672-597f86356ee3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b79b8f9b-d062-4fd3-b310-8342a785c7a0"},{"version":"CommandV1","origId":2937788264273004,"guid":"b98c3eab-3b8c-4807-ba5b-86958ed413d9","subtype":"script","commandType":"auto","position":3.75,"command":"","commandVersion":104,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Your Metadata dataframe is loaded\nUse following syntax to grab it\n &lt;new dataframe&gt; = load_metadata_df(&lt;path of metadata csv&gt;) \n\n\nNOTE : csv path parameter is optional as Functions uses default path\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915230,"submitTime":0,"finishTime":1653470915245,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f72767-33ac-4b68-8672-597f86356ee3"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",237]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1beb3524-a0fc-41a8-b8e2-72722bf751f1"},{"version":"CommandV1","origId":2937788264273005,"guid":"e7460e37-1af9-401d-ba52-ca9af4743814","subtype":"command","commandType":"auto","position":5.0,"command":"metadf = load_metadata_df()\n#metadf = load_metadata_df(\"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_test/ISU2_metadata_Copy.csv\")","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"metadf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"CDS","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915247,"submitTime":1653470914930,"finishTime":1653470915727,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2935","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"27ca1aaf-9e2b-4273-a23f-01f9dd7f1d75"},{"version":"CommandV1","origId":2937788264273006,"guid":"aecdec95-a85d-48a1-b46d-2567136cd0c1","subtype":"command","commandType":"auto","position":6.0,"command":"#with_reqd_col_DF = metadf.select(col(\"TABLE\"),col(\"TECH FIELD NAME\"),col(\"delta_types\"),col(\"DESCRIPTION\"),col(\"Partition Logic Encoding\")).where(col(\"TABLE\") == table_name )\n\nwith_reqd_col_DF = metadf.select(\"*\").where(col(\"Table_Name\") == table_name )","commandVersion":13,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"with_reqd_col_DF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Source","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Table_Position","nullable":true,"type":"string"},{"metadata":{},"name":"Field_Name","nullable":true,"type":"string"},{"metadata":{},"name":"Data_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Key_Field","nullable":true,"type":"string"},{"metadata":{},"name":"Description","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key","nullable":true,"type":"string"},{"metadata":{},"name":"Partition_Key_Encoding","nullable":true,"type":"string"},{"metadata":{},"name":"CDS","nullable":true,"type":"string"},{"metadata":{},"name":"delta_types","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915730,"submitTime":1653470914940,"finishTime":1653470915764,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad16cb73-1638-4415-a6f6-976083c2638a"},{"version":"CommandV1","origId":2937788264273007,"guid":"bd5910de-ca12-4278-a54d-9a72ef42d9f3","subtype":"command","commandType":"auto","position":7.0,"command":"# def generate_schema(column_name,types_name,comment):\n#   columns_list = with_reqd_col_DF.select(column_name).rdd.map(lambda x : x[0]).collect()\n#   types_list = with_reqd_col_DF.select(types_name).rdd.map(lambda x : x[0]).collect()\n#   comments_list = with_reqd_col_DF.select(comment).rdd.map(lambda x : x[0]).collect()\n#   col1 ='('\n#   col2 =''\n#   for i,j,k in zip(columns_list[:-1],types_list[:-1],comments_list[:-1]):\n#      col1 = col1 + ' ' + i + ' ' + j + ' ' + 'COMMENT' + ' ' + '\"' + ' ' + k + ' ' + '\"' + ' ' + \", \"\n#   col2 = columns_list[-1] + ' ' + types_list[-1] + ' ' + 'COMMENT' + ' ' + '\"' + ' ' + comments_list[-1] + ' ' + '\"'\n#   col = col1 + ' ' + col2 + ' )'\n#   return col","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915768,"submitTime":1653470914952,"finishTime":1653470915782,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fabff420-34b7-40b7-b675-b57868beaa08"},{"version":"CommandV1","origId":2937788264273008,"guid":"f89bbf6e-3015-4233-ae41-455c10c6b6bf","subtype":"command","commandType":"auto","position":7.5,"command":"def generate_schema(column_name,types_name,comment,M_DF):\n  columns_list = M_DF.select(column_name).rdd.map(lambda x : x[0]).collect()\n  types_list = M_DF.select(types_name).rdd.map(lambda x : x[0]).collect()\n  comments_list = M_DF.select(comment).rdd.map(lambda x : x[0]).collect()\n  col1 =\"(\"\n  col2 =\"\"\n  for i,j,k in zip(columns_list,types_list,comments_list):\n    col1 = col1 + \" \" + i + \" \" + j + \" \" + \"COMMENT\" + \" \" + \"'\" + \" \" + k + \" \" + \"'\" + \" \" + ', '\n  \n  return col1 + \"partitioncol STRING, EDA_Creation_date TIMESTAMP ) \"","commandVersion":30,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915785,"submitTime":1653470914960,"finishTime":1653470915800,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e246b698-c10a-4424-98d4-2e397adf36eb"},{"version":"CommandV1","origId":2937788264273009,"guid":"19449bea-79e0-4a0a-b78c-ab81d9564bff","subtype":"command","commandType":"auto","position":8.0,"command":"getschema = generate_schema(\"Field_Name\",\"delta_types\",\"Description\",with_reqd_col_DF)\nprint(getschema)","commandVersion":16,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">( MANDT STRING COMMENT &#39; Client &#39; ,  BELNR STRING COMMENT &#39; Number_of_a_billing_document &#39; ,  BELZEILE int COMMENT &#39; Billing_line_item_for_billing_documents &#39; ,  CSNO int COMMENT &#39; Sequence_number_of_schema_step_during_billing &#39; ,  BELZART STRING COMMENT &#39; Line_Item_Type &#39; ,  ABSLKZ STRING COMMENT &#39; Billing_Line_Item_for_Budget_Billing_Amount_Determination &#39; ,  DIFFKZ STRING COMMENT &#39; Indicator_difference_line_item_for_discount_statistics &#39; ,  BUCHREL STRING COMMENT &#39; Billing_Line_Item_Relevant_to_Posting &#39; ,  MENGESTREL STRING COMMENT &#39; Quantity_billed_value_is_statistically_relevant &#39; ,  BETRSTREL STRING COMMENT &#39; Amount_of_billing_line_item_is_statistically_relevant &#39; ,  STGRQNT STRING COMMENT &#39; Quantity_statistics_group &#39; ,  STGRAMT STRING COMMENT &#39; Amount_statistics_group &#39; ,  PRINTREL STRING COMMENT &#39; Billing_Line_Is_Print_Relevant &#39; ,  AKLASSE STRING COMMENT &#39; Billing_class &#39; ,  BRANCHE STRING COMMENT &#39; Industry &#39; ,  TVORG STRING COMMENT &#39; Subtransaction_for_Document_Item &#39; ,  GEGEN_TVORG STRING COMMENT &#39; Offsetting_trans_for_sub_transaction_of_billing_line_item &#39; ,  TAX_TVORG STRING COMMENT &#39; Subtransaction_for_tax_determination_for_BB_line_items &#39; ,  LINESORT STRING COMMENT &#39; Presorting_of_billing_line_items_in_billing_schema &#39; ,  AB STRING COMMENT &#39; Date_from_which_time_slice_is_valid &#39; ,  BIS STRING COMMENT &#39; Date_at_Which_a_Time_Slice_Expires &#39; ,  TIMTYPZA STRING COMMENT &#39; Time_category_days_or_months_for_billing_line_item &#39; ,  SCHEMANR STRING COMMENT &#39; Number_of_the_billing_schema &#39; ,  SNO int COMMENT &#39; Sequence_number_of_schema_step_in_billing_schema &#39; ,  PROGRAMM STRING COMMENT &#39; Variant_program &#39; ,  MASSBILL STRING COMMENT &#39; Unit_of_measurement_for_billing &#39; ,  SAISON STRING COMMENT &#39; Season &#39; ,  TIMBASIS STRING COMMENT &#39; Time_Basis &#39; ,  TIMTYP STRING COMMENT &#39; Time_category_days_or_months &#39; ,  FRAN_TYPE STRING COMMENT &#39; Franchise_Fee_Category &#39; ,  KONZIGR STRING COMMENT &#39; Franchise_fee_group &#39; ,  TARIFTYP STRING COMMENT &#39; Rate_category &#39; ,  TARIFNR STRING COMMENT &#39; Rate_key &#39; ,  KONDIGR STRING COMMENT &#39; Rate_fact_group &#39; ,  STTARIF STRING COMMENT &#39; Statistical_rate &#39; ,  GEWKEY STRING COMMENT &#39; Weighting_key &#39; ,  WDHFAKT double COMMENT &#39; Repetition_factor_for_reference_values &#39; ,  TEMP_AREA STRING COMMENT &#39; Temperature_area &#39; ,  DRCKSTUF STRING COMMENT &#39; Gas_pressure_level &#39; ,  ABGGRND1 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND2 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND3 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND4 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND5 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND6 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND7 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND8 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND9 STRING COMMENT &#39; Reason_for_proration &#39; ,  ABGGRND10 STRING COMMENT &#39; Reason_for_proration &#39; ,  EIN01 STRING COMMENT &#39; Input_operand &#39; ,  EIN02 STRING COMMENT &#39; Input_operand &#39; ,  EIN03 STRING COMMENT &#39; Input_operand &#39; ,  EIN04 STRING COMMENT &#39; Input_operand &#39; ,  AUS01 STRING COMMENT &#39; Output_operand &#39; ,  AUS02 STRING COMMENT &#39; Output_operand &#39; ,  MASS1 STRING COMMENT &#39; Unit_of_Measurement &#39; ,  MASS2 STRING COMMENT &#39; Unit_of_Measurement &#39; ,  MASS3 STRING COMMENT &#39; Unit_of_Measurement &#39; ,  MASS4 STRING COMMENT &#39; Unit_of_Measurement &#39; ,  DATUM1 STRING COMMENT &#39; Date &#39; ,  DATUM2 STRING COMMENT &#39; Date &#39; ,  RABZUS STRING COMMENT &#39; Discount_key &#39; ,  BACKCANC01 STRING COMMENT &#39; Indicator_reverse_backbilling &#39; ,  BACKCANC02 STRING COMMENT &#39; Indicator_reverse_backbilling &#39; ,  BACKCANC03 STRING COMMENT &#39; Indicator_reverse_backbilling &#39; ,  BACKCANC04 STRING COMMENT &#39; Indicator_reverse_backbilling &#39; ,  BACKCANC05 STRING COMMENT &#39; Indicator_reverse_backbilling &#39; ,  BACKCANC STRING COMMENT &#39; Indicator_Reverse_Backbilling &#39; ,  BACKEXEC STRING COMMENT &#39; Indicator_allocate_backbilling &#39; ,  BACKDOCNO STRING COMMENT &#39; Number_of_a_billing_document &#39; ,  BACKDOCLINE int COMMENT &#39; Billing_line_item_for_billing_documents &#39; ,  DYNCANC01 STRING COMMENT &#39; Schema_steps_for_reversal_in_dynamic_period_control_1 &#39; ,  DYNCANC02 STRING COMMENT &#39; Reversal_indicator_dynamic_period_control_2 &#39; ,  DYNCANC03 STRING COMMENT &#39; Reversal_indicator_dynamic_period_control_3 &#39; ,  DYNCANC04 STRING COMMENT &#39; Reversal_Indicator_Dynamic_Period_Control_4 &#39; ,  DYNCANC05 STRING COMMENT &#39; Reversal_indicator_dynamic_period_control_5 &#39; ,  DYNCANC STRING COMMENT &#39; Indicator_Reverse_Backbilling &#39; ,  DYNEXEC STRING COMMENT &#39; Indicator_Allocate_Backbilling &#39; ,  LRATESTEP int COMMENT &#39; Logical_Number_of_Rate_Step &#39; ,  PEB STRING COMMENT &#39; Indicator_billing_line_item_relates_to_period_end_billing &#39; ,  OPLFDNR int COMMENT &#39; Consecutive_number_of_an_operand &#39; ,  STAFO STRING COMMENT &#39; Update_group_for_statistics_update &#39; ,  ARTMENGE STRING COMMENT &#39; Classification_of_billed_quantity_for_statistics &#39; ,  STATTART STRING COMMENT &#39; Rate_type_for_statistical_analysis &#39; ,  TIMECONTRL STRING COMMENT &#39; Period_control &#39; ,  TCNUMTOR double COMMENT &#39; Numerator_of_the_time_portion_in_a_time_slice &#39; ,  TCDENOMTOR double COMMENT &#39; Denominator_of_the_time_portion_in_a_time_slice &#39; ,  TIMTYPQUOT STRING COMMENT &#39; Time_category_of_meter_for_time_portion_of_a_time_slice &#39; ,  AKTIV STRING COMMENT &#39; Meter_reading_active &#39; ,  KONZVER STRING COMMENT &#39; Franchise_contract &#39; ,  PERTYP STRING COMMENT &#39; Category_of_the_internal_billing_period &#39; ,  ERCHV_ANCHOR STRING COMMENT &#39; Anchor_Line_for_DBERCHV_Entry &#39; ,  OUCONTRACT STRING COMMENT &#39; Master_Agreement_for_Individual_Contract &#39; ,  V_ABRMENGE double COMMENT &#39; Places_before_decimal_point_in_billing_quantity &#39; ,  N_ABRMENGE double COMMENT &#39; Places_after_decimal_point_in_billing_quantity &#39; ,  V_ZAHL1 double COMMENT &#39; Pre_decimal_places_in_a_number &#39; ,  N_ZAHL1 double COMMENT &#39; Decimal_places_in_a_number &#39; ,  V_ZAHL2 double COMMENT &#39; Pre_decimal_places_in_a_number &#39; ,  N_ZAHL2 double COMMENT &#39; Decimal_places_in_a_number &#39; ,  V_ZAHL3 double COMMENT &#39; Pre_decimal_places_in_a_number &#39; ,  N_ZAHL3 double COMMENT &#39; Decimal_places_in_a_number &#39; ,  V_ZAHL4 double COMMENT &#39; Pre_decimal_places_in_a_number &#39; ,  N_ZAHL4 double COMMENT &#39; Decimal_places_in_a_number &#39; ,  V_ZEITANT double COMMENT &#39; Predecimal_place_of_a_time_portion &#39; ,  N_ZEITANT double COMMENT &#39; Decimal_places_of_a_time_portion &#39; , partitioncol STRING, EDA_Creation_date TIMESTAMP ) \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470915803,"submitTime":1653470914968,"finishTime":1653470917419,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",7187]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"649ccdb8-53bb-47ed-bef3-a06f956d0ad1"},{"version":"CommandV1","origId":2937788264273010,"guid":"d4af237b-d4c4-4923-8188-63b00e93f736","subtype":"command","commandType":"auto","position":9.0,"command":"main_table = 'ISU_' + table_name + '_archive'\nerroneous_table = 'ISU_' + table_name + '_arc_err'\n\n# print(main_table)\n# print(erroneous_table)\nspark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{main_table} {getschema} USING DELTA PARTITIONED BY (partitioncol) LOCATION {curated_location} \"\"\")\nspark.sql(f\"\"\" CREATE TABLE IF NOT EXISTS {db_name}.{erroneous_table} {getschema} USING DELTA PARTITIONED BY (partitioncol) LOCATION {curated_location_err} \"\"\")","commandVersion":70,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Out[26]: DataFrame[]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470917423,"submitTime":1653470914977,"finishTime":1653470921555,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",47]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f13aa9ff-a734-48e3-9371-d9a6c38e922e"},{"version":"CommandV1","origId":2937788264273011,"guid":"eedbdbe5-ad79-45ec-b9ae-99a342f432f7","subtype":"command","commandType":"auto","position":10.0,"command":"# %sql\n# drop table edw.DBERCHZ1;","commandVersion":8,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653470921584,"submitTime":1653470914994,"finishTime":1653470921598,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"da807435-80bb-4ec4-b1c2-1a272e406919"}],"dashboards":[],"guid":"50d5e36b-80af-4899-a6ec-947c3a51d6f0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"table_name":{"nuid":"e25492cf-89b4-474f-9fa6-022e33f8bc08","currentValue":"DBERCHZ1","widgetInfo":{"widgetType":"text","name":"table_name","defaultValue":"","label":"table name","options":{"widgetType":"text","validationRegex":null}}},"db_name":{"nuid":"ac7faf33-3c29-49f7-a7a9-eb83b69089a1","currentValue":"edw","widgetInfo":{"widgetType":"text","name":"db_name","defaultValue":"","label":"db name","options":{"widgetType":"text","validationRegex":null}}},"metadata_path":{"nuid":"2108d8a6-f219-4a33-b111-aa5bd9694401","currentValue":"","widgetInfo":{"widgetType":"text","name":"metadata_path","defaultValue":"","label":"metadata path","options":{"widgetType":"text","validationRegex":null}}},"dest_location":{"nuid":"0e9e6ee8-06c5-4137-b7d5-61ca0003c4f6","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_test/test_location/dest","widgetInfo":{"widgetType":"text","name":"dest_location","defaultValue":"","label":"destination location","options":{"widgetType":"text","validationRegex":null}}},"source_location":{"nuid":"bfb272e6-fa0a-466b-93c6-42a6796103e4","currentValue":"abfss://dev@dtecuprodedaadl02.dfs.core.windows.net/ISU_test/test_location/source","widgetInfo":{"widgetType":"text","name":"source_location","defaultValue":"","label":"source location","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2,"widgetLayout":[]},"reposExportFormat":"SOURCE"}