{"version":"NotebookV1","origId":2937788264272971,"name":"NB_ALA_SFI","language":"scala","commands":[{"version":"CommandV1","origId":2937788264272972,"guid":"8efe5561-3c66-4584-aa3b-d519b76824c8","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"/EDA/Data Engineer/Framework/Secrets-Databricks-Cache\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183854684,"submitTime":1640183854684,"finishTime":1640183864571,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c8761ec1-453d-4644-b1c9-9f3e99ccbe99"},{"version":"CommandV1","origId":2937788264272973,"guid":"cef32703-9d97-4041-a51d-a1edab33c960","subtype":"script","commandType":"auto","position":1.0588235294117647,"command":"","commandVersion":69,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4d7a3fd4-a22e-4861-8ad2-362ed41e42bf"},{"version":"CommandV1","origId":2937788264272974,"guid":"4d1b4dcb-e902-44d7-9708-3a1c88c9f659","subtype":"script","commandType":"auto","position":1.1176470588235294,"command":"","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":["env"],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183854854,"submitTime":0,"finishTime":1640183854875,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"745bfdf5-dda1-4d24-895f-9d4f3a72468a"},{"version":"CommandV1","origId":2937788264272975,"guid":"b94edf7a-ce79-498e-8e2b-b051351514e0","subtype":"script","commandType":"auto","position":1.1764705882352942,"command":"","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183854888,"submitTime":0,"finishTime":1640183854913,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e6807ddf-96fe-4c05-a320-f7666923fec5"},{"version":"CommandV1","origId":2937788264272976,"guid":"ed4e8072-7a3f-40c5-8d4c-76fa127646ef","subtype":"script","commandType":"auto","position":1.2352941176470589,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"94cca6b7-cf5c-44fa-9949-8f1e8f4786bc"},{"version":"CommandV1","origId":2937788264272977,"guid":"7a4ec42a-6775-47d2-a342-899a659023c0","subtype":"script","commandType":"auto","position":1.2941176470588236,"command":"","commandVersion":2,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183854929,"submitTime":0,"finishTime":1640183855074,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1f7c0e4-8b09-40c0-99e4-88c692e00d5f"},{"version":"CommandV1","origId":2937788264272978,"guid":"fb1c5e8d-1523-433f-9475-45d2dd92c932","subtype":"script","commandType":"auto","position":1.3529411764705883,"command":"","commandVersion":239,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183855083,"submitTime":0,"finishTime":1640183855113,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0357e463-0f81-4c98-8be5-273222be84b4"},{"version":"CommandV1","origId":2937788264272979,"guid":"88f8cebf-f143-489e-ab88-5bbb02eae74e","subtype":"script","commandType":"auto","position":1.4117647058823528,"command":"","commandVersion":127,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183855123,"submitTime":0,"finishTime":1640183862275,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34535ec0-8e6e-4cdd-812b-aef07a4c0a2a"},{"version":"CommandV1","origId":2937788264272980,"guid":"ae10bc29-0baf-4544-a0cb-ccb59c03e990","subtype":"script","commandType":"auto","position":1.4705882352941178,"command":"","commandVersion":47,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183862291,"submitTime":0,"finishTime":1640183862631,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e8a77e5f-81a5-4805-a396-67f01aaaa1c3"},{"version":"CommandV1","origId":2937788264272981,"guid":"81871668-ff67-42ac-aa93-49d8e01105cd","subtype":"command","commandType":"auto","position":1.5,"command":"import spark.implicits._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import spark.implicits._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183864484,"submitTime":1640183854953,"finishTime":1640183865424,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0f0252c5-c52e-403a-856b-bc6d765bdc2b"},{"version":"CommandV1","origId":2937788264272982,"guid":"2e69beca-44bc-4024-ae31-3247671ba4bd","subtype":"script","commandType":"auto","position":1.5294117647058822,"command":"","commandVersion":6,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183862651,"submitTime":0,"finishTime":1640183862974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d3ed08ba-1e5e-4991-885b-c889320818b4"},{"version":"CommandV1","origId":2937788264272983,"guid":"0e65a62e-132c-4376-810e-0fda29600fa1","subtype":"script","commandType":"auto","position":1.5882352941176472,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720ed2ae-acbd-4844-9736-0713dd0d26a9"},{"version":"CommandV1","origId":2937788264272984,"guid":"f42dc395-9e91-4f8d-957f-6fab995df822","subtype":"script","commandType":"auto","position":1.6470588235294117,"command":"","commandVersion":26,"state":"finished","results":{"type":"table","data":[["edadataengineer","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"secretscope","type":"\"string\"","metadata":"{}"},{"name":"dbserver","type":"\"string\"","metadata":"{}"},{"name":"dbname","type":"\"string\"","metadata":"{}"},{"name":"username","type":"\"string\"","metadata":"{}"},{"name":"pwd","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen1","type":"\"string\"","metadata":"{}"},{"name":"adlsbasepathgen2","type":"\"string\"","metadata":"{}"},{"name":"adlsgen1storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsgen2storageaccountname","type":"\"string\"","metadata":"{}"},{"name":"adlsclientid","type":"\"string\"","metadata":"{}"},{"name":"adlscredential","type":"\"string\"","metadata":"{}"},{"name":"adlstenantid","type":"\"string\"","metadata":"{}"},{"name":"adlsclientidwrite","type":"\"string\"","metadata":"{}"},{"name":"adlscredentialwrite","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqlprodkey","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestendpoint","type":"\"string\"","metadata":"{}"},{"name":"cosmossqltestkey","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminsconnection","type":"\"string\"","metadata":"{}"},{"name":"dtecotestaminssharedaccesskey","type":"\"string\"","metadata":"{}"},{"name":"dtecudevcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecudevdofsmnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuprodcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecuproddoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcustomervirtualassistantnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestcorpappsfleettelematicsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoadmsnslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdoaminslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecutestdofsmnsslisten","type":"\"string\"","metadata":"{}"},{"name":"dtecofsmefosourceaccesskey","type":"\"string\"","metadata":"{}"},{"name":"imagestoragekey","type":"\"string\"","metadata":"{}"},{"name":"imagesservicebusconnectionstring","type":"\"string\"","metadata":"{}"},{"name":"qlikadlsclientid","type":"\"string\"","metadata":"{}"},{"name":"qlikadlscredential","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183862984,"submitTime":0,"finishTime":1640183863583,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"6825","height":"155","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"beae291f-001c-40fd-9f0e-f7cd3fbd741c"},{"version":"CommandV1","origId":2937788264272985,"guid":"675e6d40-01b3-4abd-9244-637c242c1e34","subtype":"script","commandType":"auto","position":1.7058823529411766,"command":"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5cf2da2e-101d-4b5b-b469-04cb697697b7"},{"version":"CommandV1","origId":2937788264272986,"guid":"83e0815b-728a-4a12-aab4-2398d92636e3","subtype":"script","commandType":"auto","position":1.7647058823529411,"command":"","commandVersion":185,"state":"finished","results":{"type":"table","data":[["[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","https://[REDACTED].azuredatalakestore.net/","https://[REDACTED].dfs.core.windows.net/","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]","[REDACTED]"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_0","type":"\"string\"","metadata":"{}"},{"name":"col_1","type":"\"string\"","metadata":"{}"},{"name":"col_2","type":"\"string\"","metadata":"{}"},{"name":"col_3","type":"\"string\"","metadata":"{}"},{"name":"col_4","type":"\"string\"","metadata":"{}"},{"name":"col_5","type":"\"string\"","metadata":"{}"},{"name":"col_6","type":"\"string\"","metadata":"{}"},{"name":"col_7","type":"\"string\"","metadata":"{}"},{"name":"col_8","type":"\"string\"","metadata":"{}"},{"name":"col_9","type":"\"string\"","metadata":"{}"},{"name":"col_10","type":"\"string\"","metadata":"{}"},{"name":"col_11","type":"\"string\"","metadata":"{}"},{"name":"col_12","type":"\"string\"","metadata":"{}"},{"name":"col_13","type":"\"string\"","metadata":"{}"},{"name":"col_14","type":"\"string\"","metadata":"{}"},{"name":"col_15","type":"\"string\"","metadata":"{}"},{"name":"col_16","type":"\"string\"","metadata":"{}"},{"name":"col_17","type":"\"string\"","metadata":"{}"},{"name":"col_18","type":"\"string\"","metadata":"{}"},{"name":"col_19","type":"\"string\"","metadata":"{}"},{"name":"col_20","type":"\"string\"","metadata":"{}"},{"name":"col_21","type":"\"string\"","metadata":"{}"},{"name":"col_22","type":"\"string\"","metadata":"{}"},{"name":"col_23","type":"\"string\"","metadata":"{}"},{"name":"col_24","type":"\"string\"","metadata":"{}"},{"name":"col_25","type":"\"string\"","metadata":"{}"},{"name":"col_26","type":"\"string\"","metadata":"{}"},{"name":"col_27","type":"\"string\"","metadata":"{}"},{"name":"col_28","type":"\"string\"","metadata":"{}"},{"name":"col_29","type":"\"string\"","metadata":"{}"},{"name":"col_30","type":"\"string\"","metadata":"{}"},{"name":"col_31","type":"\"string\"","metadata":"{}"},{"name":"col_32","type":"\"string\"","metadata":"{}"},{"name":"col_33","type":"\"string\"","metadata":"{}"},{"name":"col_34","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183863611,"submitTime":0,"finishTime":1640183864172,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4094","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"648e74c5-060a-4e77-8b49-98a0bb2728ff"},{"version":"CommandV1","origId":2937788264272987,"guid":"c7ebe22a-b493-44ad-aaa7-6977350baf8a","subtype":"script","commandType":"auto","position":1.8235294117647058,"command":"","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f6f4dbae-430d-4b10-bdba-0d79af6d290e"},{"version":"CommandV1","origId":2937788264272988,"guid":"fad771b6-d715-4a33-b3ac-d4173a74a037","subtype":"script","commandType":"auto","position":1.8823529411764706,"command":"","commandVersion":31,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183864182,"submitTime":0,"finishTime":1640183864204,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8522c4d4-48b0-4a57-84ac-e9320e9e4396"},{"version":"CommandV1","origId":2937788264272989,"guid":"156a341c-a468-4148-b639-8f4bff3913fa","subtype":"script","commandType":"auto","position":1.9411764705882353,"command":"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183864221,"submitTime":0,"finishTime":1640183864459,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["8efe5561-3c66-4584-aa3b-d519b76824c8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a324baba-2930-40ee-af1f-b1a02e171872"},{"version":"CommandV1","origId":2937788264272990,"guid":"4383e0b4-13d4-46e3-9d54-5b9836379f4f","subtype":"command","commandType":"auto","position":2.0,"command":"dbutils.widgets.text(\"env\", \"\", \"Environment\")\nval env = dbutils.widgets.get(\"env\")","commandVersion":3,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">env: String = dev\n</div>","arguments":{"env":"dev"},"addedWidgets":{"env":{"widgetType":"text","name":"env","defaultValue":"","label":"Environment","options":{"widgetType":"text","validationRegex":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183865457,"submitTime":1640183855078,"finishTime":1640183865693,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"48efd950-49a4-484f-91cb-e908d23b9e4c"},{"version":"CommandV1","origId":2937788264272991,"guid":"92b73b97-7a5f-4aa6-9048-4306d936d23b","subtype":"command","commandType":"auto","position":3.0,"command":"//  raw_path = \"abfss://\"+env+\"@\"+adlsgen2storageaccountname+\".dfs.core.windows.net/Dummy_test/ala_test/raw/dopi/landing/\"\nval raw_path = \"/mnt/dev/raw/piba/test/\"\nval circuit_pt = raw_path + \"scada\"\nval sfi_pt = raw_path + \"sfi\"\nval transformer_pt = raw_path + \"transformer\"\nval processedFolder = \"abfss://\"+env+\"@\"+adlsgen2storageaccountname+\".dfs.core.windows.net/raw/dopi/landing_adls/\"\nval curated_path = \"abfss://\"+env+\"@\"+adlsgen2storageaccountname+\".dfs.core.windows.net/curated/do/ala/\"","commandVersion":39,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">raw_path: String = /mnt/dev/raw/piba/test/\ncircuit_pt: String = /mnt/dev/raw/piba/test/circuit\nsfi_pt: String = /mnt/dev/raw/piba/test/sfi\ntransformer_pt: String = /mnt/dev/raw/piba/test/transformer\nprocessedFolder: String = abfss://dev@[REDACTED].dfs.core.windows.net/raw/dopi/landing_adls/\ncurated_path: String = abfss://dev@[REDACTED].dfs.core.windows.net/curated/do/ala/\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183865714,"submitTime":1640183855247,"finishTime":1640183865973,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2205c89a-c294-4e0e-9795-55e8db042833"},{"version":"CommandV1","origId":2937788264272992,"guid":"083651a6-6fc5-4222-8439-654727407df7","subtype":"command","commandType":"auto","position":4.0,"command":"val circuit_schema = StructType(Array(\n    StructField(\"circuit\",StringType,true),\n    StructField(\"read_time\",StringType,true),\n    StructField(\"current_x\", StringType, true),\n    StructField(\"current_y\", StringType, true),\n    StructField(\"current_z\", StringType, true)\n    ))\nval substation_schema = StructType(Array(\n    StructField(\"circuit\",StringType,true),\n    StructField(\"read_time\",StringType,true),\n    StructField(\"current_x\", StringType, true),\n    StructField(\"current_y\", StringType, true),\n    StructField(\"current_z\", StringType, true)\n    ))\nval sfi_schema = StructType(Array(\n    StructField(\"sfi\",StringType,true),\n    StructField(\"read_time\",StringType,true),\n    StructField(\"current_x\", StringType, true),\n    StructField(\"current_y\", StringType, true),\n    StructField(\"current_z\", StringType, true)\n    ))","commandVersion":82,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">circuit_schema: org.apache.spark.sql.types.StructType = StructType(StructField(circuit,StringType,true), StructField(read_time,StringType,true), StructField(current_x,StringType,true), StructField(current_y,StringType,true), StructField(current_z,StringType,true))\nsubstation_schema: org.apache.spark.sql.types.StructType = StructType(StructField(circuit,StringType,true), StructField(read_time,StringType,true), StructField(current_x,StringType,true), StructField(current_y,StringType,true), StructField(current_z,StringType,true))\nsfi_schema: org.apache.spark.sql.types.StructType = StructType(StructField(sfi,StringType,true), StructField(read_time,StringType,true), StructField(current_x,StringType,true), StructField(current_y,StringType,true), StructField(current_z,StringType,true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640183866014,"submitTime":1640183855382,"finishTime":1640183866348,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8b952624-cc19-455b-8cfe-7677f67eb6c5"},{"version":"CommandV1","origId":2937788264272993,"guid":"198344fd-4d70-4d62-9217-b24582c8c45d","subtype":"command","commandType":"auto","position":4.296875,"command":"import org.apache.hadoop.fs._\ndef filecopy (sourcepath : String, targetpath : String)  = {\n  val p1 = new Path(sourcepath) //processing_folder)\n   val fs = p1.getFileSystem(spark.sessionState.newHadoopConf)\n   val ls1 = fs.listStatus(p1).sortBy(_.getModificationTime).filter(_.isFile)\n   ls1.foreach( x => {\n         val f = x.getPath.toString\n         val filenm = x.getPath.getName.toString\n         //println(f)\n         //println(filenm)\n         dbutils.fs.mv(f, targetpath +filenm)\n       } )\n}","commandVersion":29,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">filecopy: (sourcepath: String, targetpath: String)Unit\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640184265407,"submitTime":1640184265346,"finishTime":1640184266210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bf419710-31db-49cc-9c9a-5fc0645c032c"},{"version":"CommandV1","origId":2937788264272994,"guid":"5b44a5bd-6778-4ed0-85b0-3c4517fe75be","subtype":"command","commandType":"auto","position":4.3671875,"command":"// filecopy(circuit_pt, processedFolder+ \"/circuit/\")","commandVersion":12,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640160131081,"submitTime":1640160109581,"finishTime":1640160132131,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"00db88ba-7c28-4fee-b685-bdd7aa39379b"},{"version":"CommandV1","origId":2937788264272995,"guid":"63def699-85ce-4237-943d-cda30908d9e8","subtype":"command","commandType":"auto","position":4.46875,"command":"val df_circuit = spark.read.format(\"csv\").option(\"sep\", \"\\t\").option(\"header\", \"true\").schema(circuit_schema).load(circuit_pt).dropDuplicates()\nval dfct = df_circuit.withColumn(\"yy\", year(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" ))).withColumn(\"mm\", month(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" ))).withColumn(\"dd\", dayofmonth(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" )))\ndfct.createOrReplaceTempView(\"tgt_circuit\")\nval circuit_count = dfct.count()\n//    dfct.write.partitionBy(\"yy\", \"mm\", \"dd\").format(\"delta\").mode(\"append\").save(curated_path + \"circuit/\")\n\nval df_sfi = spark.read.format(\"csv\").option(\"sep\", \"\\t\").option(\"header\", \"true\").schema(sfi_schema).load(sfi_pt).dropDuplicates()\nval dfsf = df_sfi.withColumn(\"yy\", year(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" ))).withColumn(\"mm\", month(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" ))).withColumn(\"dd\", dayofmonth(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" )))\ndfsf.createOrReplaceTempView(\"tgt_sfi\")\nval sfi_count = dfsf.count()\n//    dfsf.write.partitionBy(\"yy\", \"mm\", \"dd\").format(\"delta\").mode(\"append\").save(curated_path + \"sfi/\")\n\nval df_transf = spark.read.format(\"csv\").option(\"sep\", \"\\t\").option(\"header\", \"true\").schema(substation_schema).load(transformer_pt).dropDuplicates()\nval dftr = df_transf.withColumn(\"yy\", year(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" ))).withColumn(\"mm\", month(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" ))).withColumn(\"dd\", dayofmonth(to_date($\"read_time\",\"M/d/yyyy h:mm:ss a\" )))\ndftr.createOrReplaceTempView(\"tgt_transf\")\nval transf_count = dftr.count()\n//    dftr.write.partitionBy(\"yy\", \"mm\", \"dd\").format(\"delta\").mode(\"append\").save(curated_path + \"transformer/\")","commandVersion":105,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df_circuit: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [circuit: string, read_time: string ... 3 more fields]\ndfct: org.apache.spark.sql.DataFrame = [circuit: string, read_time: string ... 6 more fields]\ncircuit_count: Long = 200000\ndf_sfi: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [sfi: string, read_time: string ... 3 more fields]\ndfsf: org.apache.spark.sql.DataFrame = [sfi: string, read_time: string ... 6 more fields]\nsfi_count: Long = 200000\ndf_transf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [circuit: string, read_time: string ... 3 more fields]\ndftr: org.apache.spark.sql.DataFrame = [circuit: string, read_time: string ... 6 more fields]\ntransf_count: Long = 200000\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_circuit","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"circuit","type":"string","nullable":true,"metadata":{}},{"name":"read_time","type":"string","nullable":true,"metadata":{}},{"name":"current_x","type":"string","nullable":true,"metadata":{}},{"name":"current_y","type":"string","nullable":true,"metadata":{}},{"name":"current_z","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"dfct","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"circuit","type":"string","nullable":true,"metadata":{}},{"name":"read_time","type":"string","nullable":true,"metadata":{}},{"name":"current_x","type":"string","nullable":true,"metadata":{}},{"name":"current_y","type":"string","nullable":true,"metadata":{}},{"name":"current_z","type":"string","nullable":true,"metadata":{}},{"name":"yy","type":"integer","nullable":true,"metadata":{}},{"name":"mm","type":"integer","nullable":true,"metadata":{}},{"name":"dd","type":"integer","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"df_sfi","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"sfi","type":"string","nullable":true,"metadata":{}},{"name":"read_time","type":"string","nullable":true,"metadata":{}},{"name":"current_x","type":"string","nullable":true,"metadata":{}},{"name":"current_y","type":"string","nullable":true,"metadata":{}},{"name":"current_z","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"dfsf","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"sfi","type":"string","nullable":true,"metadata":{}},{"name":"read_time","type":"string","nullable":true,"metadata":{}},{"name":"current_x","type":"string","nullable":true,"metadata":{}},{"name":"current_y","type":"string","nullable":true,"metadata":{}},{"name":"current_z","type":"string","nullable":true,"metadata":{}},{"name":"yy","type":"integer","nullable":true,"metadata":{}},{"name":"mm","type":"integer","nullable":true,"metadata":{}},{"name":"dd","type":"integer","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"df_transf","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"circuit","type":"string","nullable":true,"metadata":{}},{"name":"read_time","type":"string","nullable":true,"metadata":{}},{"name":"current_x","type":"string","nullable":true,"metadata":{}},{"name":"current_y","type":"string","nullable":true,"metadata":{}},{"name":"current_z","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"dftr","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"circuit","type":"string","nullable":true,"metadata":{}},{"name":"read_time","type":"string","nullable":true,"metadata":{}},{"name":"current_x","type":"string","nullable":true,"metadata":{}},{"name":"current_y","type":"string","nullable":true,"metadata":{}},{"name":"current_z","type":"string","nullable":true,"metadata":{}},{"name":"yy","type":"integer","nullable":true,"metadata":{}},{"name":"mm","type":"integer","nullable":true,"metadata":{}},{"name":"dd","type":"integer","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640160132156,"submitTime":1640160109821,"finishTime":1640160141142,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"749a5f37-6640-4e36-b685-c63dbd907bcf"},{"version":"CommandV1","origId":2937788264272996,"guid":"e1110f2c-9116-426f-9d9a-494f142121da","subtype":"command","commandType":"auto","position":4.666015625,"command":"if (circuit_count > 0) {\n  print (\"Circuit has \" +circuit_count+ \" records\")\n   spark.sql(\"\"\"\n      merge into common.circuit t using tgt_circuit s on\n      s.circuit    = t.circuit \n      and  s.read_time   =  t.read_time   \n      when not matched then insert\n      (circuit  \n      ,read_time   \n      ,current_x\n      ,current_y\n      ,current_z\n      ,yy\n      ,mm\n      ,dd\n      )\n      values (\n      s.circuit\n      ,s.read_time\n      ,s.current_x \n      ,s.current_y \n      ,s.current_z \n      ,s.yy\n      ,s.mm\n      ,s.dd\n      )\n      \"\"\")\nfilecopy(circuit_pt, processedFolder+ \"/scada/\")  \n} \nelse\n{\n  print ( \"\\n No new Circuit file found\")\n}\n\nif (sfi_count > 0) {\n  print (\"\\n SFI file has \" +sfi_count+ \" records\")\n  spark.sql(\"\"\"\n      merge into common.sfi t using tgt_sfi s on\n      s.sfi    = t.sfi \n      and  s.read_time   =  t.read_time   \n      when not matched then insert\n      (sfi  \n      ,read_time   \n      ,current_x\n      ,current_y\n      ,current_z\n      ,yy\n      ,mm\n      ,dd\n      )\n      values (\n      s.sfi\n      ,s.read_time\n      ,s.current_x \n      ,s.current_y \n      ,s.current_z \n      ,s.yy\n      ,s.mm\n      ,s.dd\n      )\n      \"\"\")\n  filecopy(sfi_pt, processedFolder+ \"/sfi/\")  \n}  \nelse\n{\n  print ( \"\\n No new SFI file found\")\n}\n\nif (transf_count > 0) {\n  print (\"\\n transformer has \" +transf_count+ \" records\")\n  spark.sql(\"\"\"\n      merge into common.transformer t using tgt_transf s on\n      s.circuit    = t.circuit \n      and  s.read_time   =  t.read_time   \n      when not matched then insert\n      (circuit  \n      ,read_time   \n      ,current_x\n      ,current_y\n      ,current_z\n      ,yy\n      ,mm\n      ,dd\n      )\n      values (\n      s.circuit\n      ,s.read_time\n      ,s.current_x \n      ,s.current_y \n      ,s.current_z \n      ,s.yy\n      ,s.mm\n      ,s.dd\n      )\n      \"\"\")\n  filecopy(transformer_pt, processedFolder+ \"/transformer/\")\n}\nelse\n{\n  print ( \"\\n No new Transformer file found\")\n}","commandVersion":350,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Circuit has 200000 records\n SFI file has 200000 records\n transformer has 200000 records</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640160397164,"submitTime":1640160396987,"finishTime":1640160421120,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1c2b72c0-ce50-4bc6-81f1-a93874ae5844"},{"version":"CommandV1","origId":2937788264272997,"guid":"053fed08-33a8-4716-b699-d668c4980918","subtype":"command","commandType":"auto","position":5.666015625,"command":"// spark.sql(\"\"\" refresh table common.circuit \"\"\")\n// spark.sql(\"\"\" refresh table common.sfi \"\"\")\n// spark.sql(\"\"\" refresh table common.transformer \"\"\") ","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1640099719491,"submitTime":1640099681290,"finishTime":1640099720445,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"96679467-c2de-43a9-8734-7d1cdfb51d23"}],"dashboards":[],"guid":"3216d7cc-37cf-4118-b5bf-e45b46209231","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"env":{"nuid":"a0bb3313-e442-47de-8688-d56d230851c7","currentValue":"dev","widgetInfo":{"widgetType":"text","name":"env","defaultValue":"","label":"Environment","options":{"widgetType":"text","validationRegex":null}}}},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}